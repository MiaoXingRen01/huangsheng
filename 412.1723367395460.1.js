"use strict";(self["webpackChunkweb_admin"]=self["webpackChunkweb_admin"]||[]).push([[412],{92412:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});n(25276),n(62062),n(62010);var a=n(35280),i=["id"],r=(0,a.Lk)("i",{class:"ri-add-line"},null,-1),o=(0,a.Lk)("span",null,"添加菜单",-1),u={key:0,class:"icon-cell"},l=["onClick"],c=["onClick"];function s(e,t,n,s,d,p){var f=(0,a.g2)("a-button"),h=(0,a.g2)("a-space"),k=(0,a.g2)("a-row"),m=(0,a.g2)("a-tree"),b=(0,a.g2)("a-card"),v=(0,a.g2)("a-col"),y=(0,a.g2)("a-input"),g=(0,a.g2)("a-form-item"),w=(0,a.g2)("a-form"),A=(0,a.g2)("a-divider"),C=(0,a.g2)("a-table"),E=(0,a.g2)("a-select"),_=(0,a.g2)("a-tree-select"),F=(0,a.g2)("a-input-number"),I=(0,a.g2)("a-modal");return(0,a.uX)(),(0,a.CE)("div",{id:e.$route.name},[(0,a.bF)(b,null,{title:(0,a.k6)((function(){return[(0,a.bF)(k,{justify:"space-between",align:"top"},{default:(0,a.k6)((function(){return[(0,a.bF)(h,null,{default:(0,a.k6)((function(){return[(0,a.bF)(f,{type:"primary",onClick:t[0]||(t[0]=(0,a.D$)((function(e){return p.onItemEditClick()}),["prevent"]))},{default:(0,a.k6)((function(){return[r,o]})),_:1})]})),_:1})]})),_:1})]})),default:(0,a.k6)((function(){return[(0,a.bF)(k,{type:"flex",gutter:16},{default:(0,a.k6)((function(){return[(0,a.bF)(v,{flex:"0 0 256px",style:{overflow:"hidden"}},{default:(0,a.k6)((function(){return[(0,a.bF)(b,null,{default:(0,a.k6)((function(){return[d.menuList.length>0?((0,a.uX)(),(0,a.Wv)(m,{key:0,defaultExpandAll:!0,checkStrictly:!0,"tree-data":d.menuList,"show-line":"",onSelect:p.onTreeSelectClick,fieldNames:{key:"id",title:"title",value:"id"}},null,8,["tree-data","onSelect"])):(0,a.Q3)("",!0)]})),_:1})]})),_:1}),(0,a.bF)(v,{flex:"1",style:{overflow:"hidden"}},{default:(0,a.k6)((function(){return[(0,a.bF)(w,{class:"page-form",layout:"inline"},{default:(0,a.k6)((function(){return[(0,a.bF)(g,null,{default:(0,a.k6)((function(){return[(0,a.bF)(y,{placeholder:"名称",value:d.nameLike,"onUpdate:value":t[1]||(t[1]=function(e){return d.nameLike=e}),style:{width:"180px"},allowClear:""},null,8,["value"])]})),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((function(){return[(0,a.bF)(f,{type:"primary",onClick:(0,a.D$)(p.onSearchClick,["prevent"])},{default:(0,a.k6)((function(){return[(0,a.eW)("查询")]})),_:1},8,["onClick"]),(0,a.bF)(f,{type:"link",onClick:(0,a.D$)(p.onResetClick,["prevent"])},{default:(0,a.k6)((function(){return[(0,a.eW)("重置")]})),_:1},8,["onClick"])]})),_:1})]})),_:1}),(0,a.bF)(C,{columns:d.defaultColumns,onChange:p.handleTableChange,"data-source":d.pagination.data,pagination:d.pagination,rowKey:function(e){return e.id},scroll:{x:1e3},bordered:""},{bodyCell:(0,a.k6)((function(e){var t=e.column,n=e.record;return["icon"==t.key?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("i",{class:(0,a.C4)(n.icon)},null,2),(0,a.eW)("  "+(0,a.v_)(n.icon),1)])):(0,a.Q3)("",!0),"action"==t.key?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.Lk)("a",{href:"javascript:;",onClick:(0,a.D$)((function(e){return p.onItemEditClick(n)}),["prevent"])},"编辑",8,l),(0,a.bF)(A,{type:"vertical"}),(0,a.Lk)("a",{href:"javascript:;",onClick:(0,a.D$)((function(e){return p.onItemDeleteClick(n)}),["prevent"])},"删除",8,c)],64)):(0,a.Q3)("",!0)]})),_:1},8,["columns","onChange","data-source","pagination","rowKey"])]})),_:1})]})),_:1})]})),_:1}),(0,a.bF)(I,{visible:d.showAddMenuModal,"onUpdate:visible":t[8]||(t[8]=function(e){return d.showAddMenuModal=e}),title:"菜单信息",width:"600px",centered:"",destroyOnClose:!0,onCancel:t[9]||(t[9]=function(e){return d.editEntity={}}),onOk:p.onSubmitEditEntityClick},{default:(0,a.k6)((function(){return[(0,a.bF)(w,{labelCol:{span:7},wrapperCol:{span:13}},{default:(0,a.k6)((function(){return[(0,a.bF)(g,{label:"菜单名称",required:""},{default:(0,a.k6)((function(){return[(0,a.bF)(y,{placeholder:"请输入",value:d.editEntity.title,"onUpdate:value":t[2]||(t[2]=function(e){return d.editEntity.title=e})},null,8,["value"])]})),_:1}),(0,a.bF)(g,{label:"菜单别名",required:""},{default:(0,a.k6)((function(){return[(0,a.bF)(y,{placeholder:"请输入",value:d.editEntity.name,"onUpdate:value":t[3]||(t[3]=function(e){return d.editEntity.name=e})},null,8,["value"])]})),_:1}),(0,a.bF)(g,{label:"菜单图标"},{default:(0,a.k6)((function(){return[(0,a.bF)(E,{filterOption:function(e,t){return t.value.indexOf(e)>-1},allowClear:"","dropdown-class-name":"select-icon",value:d.editEntity.icon,"onUpdate:value":t[4]||(t[4]=function(e){return d.editEntity.icon=e}),options:d.menuIcons.map((function(e){return{value:e}})),"show-search":"",placeholder:"请输入","option-label-prop":"label"},{option:(0,a.k6)((function(e){var t=e.value;return[(0,a.Lk)("i",{class:(0,a.C4)(t)},null,2),(0,a.eW)("  "+(0,a.v_)(t),1)]})),_:1},8,["filterOption","value","options"])]})),_:1}),(0,a.bF)(g,{label:"上级菜单",required:""},{default:(0,a.k6)((function(){return[(0,a.bF)(_,{placeholder:"请输入",value:d.editEntity.parentId,"onUpdate:value":t[5]||(t[5]=function(e){return d.editEntity.parentId=e}),"tree-data":d.menuList,fieldNames:{key:"id",label:"name",value:"id"}},null,8,["value","tree-data"])]})),_:1}),(0,a.bF)(g,{label:"路径"},{default:(0,a.k6)((function(){return[(0,a.bF)(y,{placeholder:"请输入",value:d.editEntity.path,"onUpdate:value":t[6]||(t[6]=function(e){return d.editEntity.path=e})},null,8,["value"])]})),_:1}),(0,a.bF)(g,{label:"排序",help:"数字越小，排名越靠前",required:""},{default:(0,a.k6)((function(){return[(0,a.bF)(F,{value:d.editEntity.sortno,"onUpdate:value":t[7]||(t[7]=function(e){return d.editEntity.sortno=e})},null,8,["value"])]})),_:1})]})),_:1})]})),_:1},8,["visible","onOk"])],8,i)}var d=n(41034),p=n(14048),f=n(30388),h=(n(52811),n(58940),n(27495),n(90906),n(42762),n(83496)),k=n(76136),m=n(25818),b=n(49823);const v={data:function(){var e=this;return{sortField:"",sortOrder:"",editEntity:{},showAddMenuModal:!1,menuIcons:Object.freeze(b),menuList:[],nameLike:"",parentId:"",defaultColumns:[{title:"名称",dataIndex:"title"},{title:"别名",dataIndex:"name"},{title:"图标",key:"icon"},{title:"路径",dataIndex:"path"},{title:"排序",dataIndex:"sortno",sorter:!0,align:"center"},{title:"操作",key:"action",width:140}],pagination:{current:1,pageSize:parseInt(m.qN.PAGE_SIZE_OPTIONS[0]),showQuickJumper:!0,showSizeChanger:!0,data:[],total:0,pageSizeOptions:m.qN.PAGE_SIZE_OPTIONS,showTotal:function(){return"共 ".concat(e.pagination.total," 条")}}}},mounted:function(){var e=this;return(0,f.A)((0,p.A)().mark((function t(){return(0,p.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.onSearchClick();case 1:case"end":return t.stop()}}),t)})))()},methods:{onTreeSelectClick:function(e){this.parentId=e[0]||"",this.onSearchClick()},handleTableChange:function(e,t,n){this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.sortField=n.field,this.sortOrder=n.order,this.requestData(!0)},onSubmitEditEntityClick:function(){var e=this;return(0,f.A)((0,p.A)().mark((function t(){var n,a,i;return(0,p.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.editEntity,!k.A.isEmpty(n.title)){t.next=4;break}return h.A.showToast("请输入菜单名称"),t.abrupt("return");case 4:if(n.title=(n.title+"").trim(),!k.A.isEmpty(n.name)){t.next=8;break}return h.A.showToast("请输入菜单别名"),t.abrupt("return");case 8:if(n.name=(n.name+"").trim(),/^\d+$/.test(n.sortno)){t.next=12;break}return h.A.showToast("请输入排序序号"),t.abrupt("return");case 12:if(!h.A.utils.isEmpty(n.parentId)){t.next=15;break}return h.A.showToast("请选择上级菜单"),t.abrupt("return");case 15:if(n.parentId!=n.id){t.next=18;break}return h.A.showToast("上级菜单不能选择".concat(n.name)),t.abrupt("return");case 18:return h.A.showLoading(),a={name:n.name,title:n.title,icon:n.icon,parentId:n.parentId,path:n.path,sortno:n.sortno},k.A.isEmpty(n.id)||(a.id=n.id),t.next=23,h.A.postAsync(m.tl.MENU_SAVE,a);case 23:i=t.sent,h.A.hideLoading(),0==i.status&&(h.A.showToast(i.message),e.showAddMenuModal=!1,e.editEntity={},e.onSearchClick());case 26:case"end":return t.stop()}}),t)})))()},onItemEditClick:function(e){this.showAddMenuModal=!0,this.editEntity=(0,d.A)({},e)},onItemDeleteClick:function(e){var t=this;this.$confirm({title:"提示",content:"确定要删除该菜单吗？",onOk:function(){var n=(0,f.A)((0,p.A)().mark((function n(){var a;return(0,p.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return h.A.showLoading(),n.next=3,h.A.postAsync(m.tl.MENU_DEL,{menuId:e.id});case 3:a=n.sent,h.A.hideLoading(),0==a.status&&(h.A.showToast(a.message),t.onSearchClick());case 6:case"end":return n.stop()}}),n)})));function a(){return n.apply(this,arguments)}return a}()})},onSearchClick:function(){var e=this.pagination;e.current=1,this.requestData(!0)},onResetClick:function(){this.nameLike="",this.onSearchClick()},requestData:function(){var e=arguments,t=this;return(0,f.A)((0,p.A)().mark((function n(){var a,i,r,o,u,l,c,s,d,f;return(0,p.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]&&e[0],i=t.nameLike,r=t.parentId,o=void 0===r?"":r,u=t.sortField,l=t.sortOrder,c=t.pagination,a&&h.A.showLoading(),s={page:c.current,limit:c.pageSize,parentId:o},k.A.isEmpty(i)||(s.menu=i),k.A.isEmpty(u)||(s.orderField=u,s.orderType="ascend"==l?"asc":"descend"==l?"desc":""),n.next=9,h.A.postAsync(m.tl.MENU_LIST,s);case 9:return d=n.sent,0==d.status&&(f=d.data,c.current=f.page,c.total=f.count,c.data=f.data,t.pagination=c),n.next=13,h.A.postAsync(m.tl.MENU_TREE_LIST,{showRoot:"y"});case 13:d=n.sent,0==d.status&&(t.menuList=d.data),a&&h.A.hideLoading();case 16:case"end":return n.stop()}}),n)})))()}}};var y=n(71241);const g=(0,y.A)(v,[["render",s]]),w=g}}]);