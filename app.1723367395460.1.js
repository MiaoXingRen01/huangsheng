(()=>{var __webpack_modules__={83496:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14048),G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(30388),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(26099),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(27495),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(25440),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(76031),core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_5__),_config_config_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(25818),_config_prop_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(20715),_config_state_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(26443),_config_utils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(76136),axios__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(50788),axios__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_10__),qs__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(19122),qs__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(qs__WEBPACK_IMPORTED_MODULE_16__),_router_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(79342),ant_design_vue__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(59804),ant_design_vue__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(35757),ant_design_vue__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(17694),vue__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(35280),messageDuration=2,loadingModal=[],app={URLS:_config_config_js__WEBPACK_IMPORTED_MODULE_6__.tl,KEYS:_config_config_js__WEBPACK_IMPORTED_MODULE_6__.Rk,DEFAULT:_config_config_js__WEBPACK_IMPORTED_MODULE_6__.qN,utils:_config_utils_js__WEBPACK_IMPORTED_MODULE_9__.A,pageParams:{},token:(0,_config_prop_js__WEBPACK_IMPORTED_MODULE_7__.m)(_config_config_js__WEBPACK_IMPORTED_MODULE_6__.Rk.TOKEN,_config_prop_js__WEBPACK_IMPORTED_MODULE_7__.Z.LOCAL_STORAGE),userInfo:(0,_config_prop_js__WEBPACK_IMPORTED_MODULE_7__.m)(_config_config_js__WEBPACK_IMPORTED_MODULE_6__.Rk.USER_INFO,_config_prop_js__WEBPACK_IMPORTED_MODULE_7__.Z.LOCAL_STORAGE),userMenuList:(0,_config_prop_js__WEBPACK_IMPORTED_MODULE_7__.m)(_config_config_js__WEBPACK_IMPORTED_MODULE_6__.Rk.MENU_LIST,_config_prop_js__WEBPACK_IMPORTED_MODULE_7__.Z.SESSION_STORAGE),onLaunch:function onLaunch(){var _this=this;axios__WEBPACK_IMPORTED_MODULE_10___default().interceptors.response.use((function(response){if(window.console.log(response.config.url,decodeURIComponent(response.config.data),response.headers,response.data),200===response.status&&response.data){var res="string"==typeof response.data?eval("("+response.data+")"):response.data;return 0==_this.checkRequestResult(res)?Promise.resolve(res):Promise.reject(res)}return Promise.reject(response)}),(function(e){return Promise.reject(e)})),axios__WEBPACK_IMPORTED_MODULE_10___default().defaults.headers.post["Content-Type"]="application/json"},showLoading:function(){loadingModal[loadingModal.length]=ant_design_vue__WEBPACK_IMPORTED_MODULE_13__.A.info({icon:function(){return(0,vue__WEBPACK_IMPORTED_MODULE_12__.bF)(ant_design_vue__WEBPACK_IMPORTED_MODULE_14__.A,{tip:"加载中"})},mask:!0,maskClosable:!1,centered:!0,keyboard:!1,class:"loading-modal"})},hideLoading:function(){loadingModal.length>0&&(loadingModal[loadingModal.length-1].destroy(),loadingModal.length=loadingModal.length-1)},showToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=function(){ant_design_vue__WEBPACK_IMPORTED_MODULE_15__.Ay.open({content:e,duration:messageDuration})};0==t?r():setTimeout(r,t)},getToken:function(){return this.token.get()},setToken:function(e){this.token.set(e)},toLogin:function(){this.userInfo.del(),this.token.del(),this.userMenuList.del(),_router_js__WEBPACK_IMPORTED_MODULE_11__.A.replace({path:"/login"})["catch"]((function(){}))},getMenuList:function(){var e=this;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.A)((0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().mark((function t(){var r;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=r||[],e.userMenuList.set(r),t.abrupt("return",e.userMenuList.get());case 3:case"end":return t.stop()}}),t)})))()},uploadBase:function(e,t){var r=new FormData;if(r.append("file",e),t.params)for(var o in t.params)r.append(o,t.params[o]);return t.params=r,t.method="POST",this.requestBase(t)},upload:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;this.uploadBase(t,{url:e,success:o,params:r,complete:n})},uploadAsync:function(e,t){var r=arguments,o=this;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.A)((0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().mark((function n(){var a;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=r.length>2&&void 0!==r[2]?r[2]:{},n.abrupt("return",new Promise((function(r,n){a.resolve=r,a.reject=function(e){r(e||{})},a.url=e,o.uploadBase(t,a)})));case 2:case"end":return n.stop()}}),n)})))()},checkRequestResult:function(e){if("status"in e){if(901==e.status||903==e.status||904==e.status||906==e.status)return 906==e.status&&this.showToast(e.message,200),this.toLogin(),1;if(0!=e.status)return this.showToast(e.message,200),2}return 0},getHeaders:function(){return{token:this.getToken(),"product-version":_config_config_js__WEBPACK_IMPORTED_MODULE_6__.qN.VERSION_NAME}},requestAsync:function(e){var t=this;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.A)((0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().mark((function r(){return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){e.resolve=r,e.reject=function(e){r(e||{})},t.requestBase(e)})));case 1:case"end":return r.stop()}}),r)})))()},post:function(e,t,r,o){this.requestBase({url:e,params:t,success:r,complete:o,method:"POST"})},get:function(e,t,r,o){this.requestBase({url:e,params:t,success:r,complete:o,method:"GET"})},postAsync:function(e){var t=arguments,r=this;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.A)((0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().mark((function o(){var n;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:{},o.abrupt("return",r.requestAsync({url:e,params:n,method:"POST"}));case 2:case"end":return o.stop()}}),o)})))()},getAsync:function(e){var t=arguments,r=this;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.A)((0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().mark((function o(){var n;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:{},o.abrupt("return",r.requestAsync({url:e,params:n,method:"GET"}));case 2:case"end":return o.stop()}}),o)})))()},deleteAsync:function(e){var t=arguments,r=this;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.A)((0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().mark((function o(){var n;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:{},o.abrupt("return",r.requestAsync({url:e,params:n,method:"DELETE"}));case 2:case"end":return o.stop()}}),o)})))()},putAsync:function(e){var t=arguments,r=this;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.A)((0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().mark((function o(){var n;return(0,G_rxx_workspace_vue_bill_print_bill_print_platform_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:{},o.abrupt("return",r.requestAsync({url:e,params:n,method:"PUT"}));case 2:case"end":return o.stop()}}),o)})))()},requestBase:function(e){var t=this.getHeaders(),r=e.url;if(e.headers)for(var o in e.headers)t[o]=e.headers[o];var n="",a=_config_config_js__WEBPACK_IMPORTED_MODULE_6__.qN.CONTENT_TYPE;r instanceof _config_config_js__WEBPACK_IMPORTED_MODULE_6__.Xj?(n=r.url,_config_utils_js__WEBPACK_IMPORTED_MODULE_9__.A.isEmpty(r.contentType)||(a=r.contentType)):"string"==typeof r&&(n=r),"POST"==e.method&&("multipart/form-data"!=a||e.params instanceof FormData||(e.params=qs__WEBPACK_IMPORTED_MODULE_16___default().stringify(e.params))),t["Content-Type"]=a;var i=null;"POST"==e.method?i=axios__WEBPACK_IMPORTED_MODULE_10___default().post(n,e.params,{headers:t}):"GET"==e.method?i=axios__WEBPACK_IMPORTED_MODULE_10___default().get(n,{params:e.params,headers:t}):"DELETE"==e.method?i=axios__WEBPACK_IMPORTED_MODULE_10___default()["delete"](n,{params:e.params,headers:t}):"PUT"==e.method&&(i=axios__WEBPACK_IMPORTED_MODULE_10___default().put(n,{params:e.params,headers:t})),i&&i.then((function(t){e.success&&e.success(t),e.resolve&&e.resolve(t),e.complete&&e.complete(!0)}))["catch"]((function(t){e.resolve&&e.resolve({status:-100,message:"Network Error"}),e.complete&&e.complete(!1,t)}))}};const __WEBPACK_DEFAULT_EXPORT__=app},25818:(e,t,r)=>{"use strict";r.d(t,{Rk:()=>s,Xj:()=>c,qN:()=>u,tl:()=>d});var o=r(25026),n=r(69492),a="production",i="";"production"==a?i="https://abc":"local"==a&&(i="http://192.168.1.209:52001/print");var l=i+"/static",s={TOKEN:"print-token",USER_INFO:"userInfo",MENU_LIST:"menuList",SELECT_MENU_LIST:"selectMenuList"},u={LOGIN_TYPE:"web",LIMIT:15,MAX_LIMIT:99999999,PAGE_SIZE_OPTIONS:["15","20","25","30"],VERSION_NAME:"1.0.0",MAP_CENTER:{lng:117.997796,lat:36.826897},CONTENT_TYPE:"application/json"},c=function(){function e(t,r){(0,o.A)(this,e),this.url=t,this.contentType=r}return(0,n.A)(e,[{key:"toString",value:function(){return this.url}}])}(),d={ROOT:"".concat(i,"/"),ROOT_IMAGE:"".concat(l,"/"),ADMIN_DEPARTMENT_DEL:new c("".concat(i,"/system/admin/department/delete")),ADMIN_DEPARTMENT_LIST:new c("".concat(i,"/system/admin/department/list")),ADMIN_DEPARTMENT_SAVE:new c("".concat(i,"/system/admin/department/save")),ADMIN_DEPARTMENT_TREE_LIST:new c("".concat(i,"/system/admin/department/tree")),ADMIN_USER_DEL:new c("".concat(i,"/system/admin/user/delete")),ADMIN_USER_ENABLE:new c("".concat(i,"/system/admin/user/setEnable")),ADMIN_USER_LIST:new c("".concat(i,"/system/admin/user/list")),ADMIN_USER_RESETPWD:new c("".concat(i,"/system/admin/user/resetPwd")),ADMIN_USER_SAVE:new c("".concat(i,"/system/admin/user/save")),FILE_UPLOAD:new c("".concat(i,"/common/file/upload"),"multipart/form-data"),FORCE_USER_LOGOUT:new c("".concat(i,"/system/user/force-logout")),LOGIN:new c("".concat(i,"/authc/login")),LOGIN_LOG_LIST:new c("".concat(i,"/system/logs/login/list")),LOGOUT:new c("".concat(i,"/authc/logout")),MENU_DEL:new c("".concat(i,"/system/menu/delete")),MENU_LIST:new c("".concat(i,"/system/menu/list")),MENU_SAVE:new c("".concat(i,"/system/menu/save")),MENU_TREE_LIST:new c("".concat(i,"/system/menu/tree")),PARAM_DEL:new c("".concat(i,"/system/param/delete")),PARAM_DETAIL:new c("".concat(i,"/common/getParamByCode")),PARAM_LIST:new c("".concat(i,"/system/param/list")),PARAM_SAVE:new c("".concat(i,"/system/param/save")),PARAMS_DESC_DEL:new c("".concat(i,"/system/param/desc/delete")),PARAMS_DESC_LIST:new c("".concat(i,"/system/param/desc/list")),PARAMS_DESC_SAVE:new c("".concat(i,"/system/param/desc/save")),SUPER_DEPARTMENT_DEL:new c("".concat(i,"/system/department/delete")),SUPER_DEPARTMENT_LIST:new c("".concat(i,"/system/department/list")),SUPER_DEPARTMENT_SAVE:new c("".concat(i,"/system/department/save")),SUPER_DEPARTMENT_TREE_LIST:new c("".concat(i,"/system/department/tree")),SUPER_ROLE_DEL:new c("".concat(i,"/system/role/delete")),SUPER_ROLE_LIST:new c("".concat(i,"/system/role/list")),SUPER_ROLE_MENU_LIST:new c("".concat(i,"/system/role/menu/list")),SUPER_ROLE_MENU_SAVE:new c("".concat(i,"/system/role/menu/set")),SUPER_ROLE_SAVE:new c("".concat(i,"/system/role/save")),SUPER_USER_DEL:new c("".concat(i,"/system/user/delete")),SUPER_USER_ENABLE:new c("".concat(i,"/system/user/setEnable")),SUPER_USER_LIST:new c("".concat(i,"/system/user/list")),SUPER_USER_RESETPWD:new c("".concat(i,"/system/user/resetPwd")),SUPER_USER_SAVE:new c("".concat(i,"/system/user/save")),USER_DEPARTMENT_TREE_LIST:new c("".concat(i,"/rights/user-depts")),USER_MENU_LIST:new c("".concat(i,"/authc/menus")),USER_PASSWORD_UPD:new c("".concat(i,"/authc/updPassword")),VERIFY_CODE:new c("".concat(i,"/verifyCode"),"multipart/form-data"),VERIFY_CODE_TOKEN:new c("".concat(i,"/verifyCodeToken"))}},6731:(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var _typeof=__webpack_require__(47045)["default"];__webpack_require__(16280),__webpack_require__(76918),__webpack_require__(28706),__webpack_require__(88431),__webpack_require__(33771),__webpack_require__(2008),__webpack_require__(51629),__webpack_require__(25276),__webpack_require__(48598),__webpack_require__(62062),__webpack_require__(44114),__webpack_require__(34782),__webpack_require__(15086),__webpack_require__(26910),__webpack_require__(54554),__webpack_require__(13609),__webpack_require__(60739),__webpack_require__(23288),__webpack_require__(62010),__webpack_require__(33110),__webpack_require__(2892),__webpack_require__(9868),__webpack_require__(84185),__webpack_require__(79432),__webpack_require__(63548),__webpack_require__(26099),__webpack_require__(78459),__webpack_require__(58940),__webpack_require__(27495),__webpack_require__(90906),__webpack_require__(38781),__webpack_require__(25440),__webpack_require__(90744),__webpack_require__(50375),__webpack_require__(42762),__webpack_require__(23500),__webpack_require__(62953),__webpack_require__(13611);var gr={},DEBUG=0;!function(){"use strict";gr.const_={VERSION:"6.8.23.0315",ID_REPORT_STYLE:"_gridcss",ID_DETAILGRID:"_griddg",ATTR_CONTENT_RECNO:"_grRecNo",ATTR_GROUPH_INDEX:"_grGHIndex",ATTR_GROUPF_INDEX:"_grGFIndex",ATTR_GROUP_RECNO:"_grGRecNo",ATTR_FIELD:"_grfld",CSS_DG:"_grdg",CSS_SH:"_grcsssh",CSS_CB:"_grcsscb",BIG_AMT_NUMBER:"零壹贰叁肆伍陆柒捌玖",HZ_NUMBER:"一二三四五六七八九十零",HZ_NEGATIVE:"负",HZ_ZERO_YUAN:"零元整",HZ_AMT_STEP:"元拾佰仟万拾佰仟亿拾佰仟",HZ_AMT_UNIT:"整角分",HZ_DATETIME_UNIT:"周日星期天",MILLISECONDS_DAY:864e5,TIMEZONE_OFFSET:6e4*(new Date).getTimezoneOffset()},gr.enum_={PenStyle:{Solid:0,Dash:1,Dot:2,DashDot:3,DashDotDot:4},BorderStyle:{DrawLeft:1,DrawTop:2,DrawRight:4,DrawBottom:8},BackStyle:{Normal:1,Transparent:2},TextAlign:{TopLeft:17,TopCenter:18,TopRight:20,TopJustiy:144,BottomLeft:65,BottomCenter:66,BottomRight:68,BottomJustiy:192,MiddleLeft:33,MiddleCenter:34,MiddleRight:36,MiddleJustiy:160},TextOrientation:{Default:0,U2DL2R0:5,D2UL2R1:22,U2DR2L0:9,U2DR2L1:25,Invert:58,L2RD2U0:38,L2RD2U1:54},ParameterDataType:{String:1,Integer:2,Float:3,Boolean:5,DateTime:6},FieldType:{String:1,Integer:2,Float:3,Currency:4,Boolean:5,DateTime:6,Binary:7},ControlType:{StaticBox:1,ShapeBox:2,SystemVarBox:3,FieldBox:4,SummaryBox:5,RichTextBox:6,PictureBox:7,MemoBox:8,SubReport:9,Line:10,Chart:11,Barcode:12,FreeGrid:13},SummaryFun:{Sum:1,Avg:2,Count:3,Min:4,Max:5,Var:6,VarP:7,StdDev:8,StdDevP:9,AveDev:10,DevSq:11,CountBlank:12,CountA:13,Distinct:14,AvgA:15,MinN:16,MaxN:17,StrMin:18,StrMax:19,VarA:20,VarPA:21,StdDevA:22,StdDevPA:23,AveDevA:24,DevSqA:25,SumAbs:26,SumAcc:27,GroupSumAcc:28},MathFun:{round45:1,round465:2,abs:5,acos:6,asin:7,atan:8,atan2:9,ceil:15,cos:16,exp:17,floor:18,log:19,maxArray:20,minArray:21,pow:22,round:23,sin:24,sqrt:25,tan:26},SystemVarType:{CurrentDateTime:1,RecordNo:4,RowNo:8,RecordCount:19,GroupNo:20,GroupCount:21,GroupRowNo:22,GroupRowCount:23},AnchorStyle:{Left:1,Top:2,Right:4,Bottom:8},AlignColumnSideStyle:{Left:1,Right:2,Both:3},DockStyle:{None:0,Left:1,Top:2,Right:3,Bottom:4,Fill:5},CenterStyle:{None:0,Horizontal:1,Vertical:2,Both:3},ShiftMode:{Never:0,Always:1,WhenOverLapped:2},Unit:{Cm:1,Inch:2},ShapeBoxType:{Circle:1,Ellipse:2,Rectangle:3,RoundRect:4,RoundSquare:5,Square:6,Line:7},PictureAlignment:{TopLeft:1,TopRight:2,Center:3,BottomLeft:4,BottomRight:5},PictureSizeMode:{Clip:1,Stretch:2,Zoom:3,EnsureFullView:4,Tile:5},PictureTransparentMode:{None:0,Overlying:1,Background:2},PictureRotateMode:{None:0,Left:1,Right:2,Flip:3,Mirror:4},ChartType:{BarChart:1,PieChart:2,LineChart:3,StackedBarChart:4,XYScatterChart:5,XYLineChart:6,CurveLineChart:7,XYCurveLineChart:8,Bubble:9,StackedBar100Chart:10,ColumnChart:11,StackedColumnChart:12,StackedColumn100Chart:13},ChartVarType:{XVal:1,YVal:2,ZVal:3,YVal100ByGroup:4,YVal100BySeries:5,YValTotalByGroup:6,YValTotalBySeries:7,SeriesLabel:8,GroupLabel:9},PointMarkerStyle:{None:-1,Square:0,SquareCheck:1,SquareCross:2,Circle:3,CirclePoint:4,CircleCross:5,Dimond:6,Triangle:7,Cross:8,Cross4:9,Star4:10,Star5:11,Star6:12,Star10:13},BarcodeType:{Code25Intlv:1,Code25Ind:2,Code25Matrix:3,Code39:4,Code39X:5,Code128A:6,Code128B:7,Code128C:8,Code93:9,Code93X:10,CodeMSI:11,CodePostNet:12,CodeCodabar:13,CodeEAN8:14,CodeEAN13:15,CodeUPC_A:16,CodeUPC_E0:17,CodeUPC_E1:18,CodeUPC_Supp2:19,CodeUPC_Supp5:20,CodeEAN128A:21,CodeEAN128B:22,CodeEAN128C:23,Code128Auto:24,PDF417:50,QRCode:51,DataMatrix:52,GS1DataMatrix:53,GS1QRCode:54},BarcodeCaptionPosition:{None:1,Above:2,Below:3},BarcodeDirection:{LeftToRight:1,RightToLeft:2,TopToBottom:3,BottomToTop:4},DtmxEncoding:{Auto:2,Ascii:3,C40:4,Text:5,X12:6,Edifact:7,Base256:8},DtmxMatrixSize:{Auto:2,"10x10":4,"12x12":5,"14x14":6,"16x16":7,"18x18":8,"20x20":9,"22x22":10,"24x24":11,"26x26":12,"32x32":13,"36x36":14,"40x40":15,"44x44":16,"48x48":17,"52x52":18,"64x64":19,"72x72":20,"80x80":21,"88x88":22,"96x96":23,"104x104":24,"120x120":25,"132x132":26,"144x144":27,"8x18":28,"8x32":29,"12x26":30,"12x36":31,"16x36":32,"16x48":33},StringAlignment:{Near:1,Center:2,Far:3},PeriodType:{None:0,Day:1,Week:2,ThirdMonth:3,HalfMonth:4,Month:5,Quarter:6,HalfYear:7,Year:8,Calendar:9},OCGroupHeaderVAlign:{Top:1,Bottom:2,Middle:3},controlLayout:{auto:0,table:1,absolute:2},detailgridResize:{asDesign:0,fitWidth:1,onlyGrow:2}},gr.locale={supportIntl:!!window.Intl,decimalSep:".",thousandSep:",",dateSep:"-",timeSep:":",textAM:"上午",textPM:"下午",currencySymbol:"￥"},gr.script={calcExp:function calcExp(expText){var result=NaN;expText="result="+expText;try{eval(expText)}catch(e){result=NaN}return result},execEvent:function execEvent(scriptText,scriptName,Sender,Report){var globalScript=Report.GlobalScript;try{globalScript&&(scriptText+="\n"+globalScript),eval(scriptText)}catch(e){Sender.report.root._scriptFailed||(alert("执行报表脚本 '"+scriptName+"' 失败"+(Sender.Name?"\n对象名称: "+Sender.Name:"")+"\n错误信息: "+e.toString()+"\n脚本代码:\n"+scriptText),Sender.report.root._scriptFailed=1)}}}}(),function(e){"use strict";var t=gr.enum_,r=gr.const_,o=gr.helper={},n=gr.common={},a=r.MILLISECONDS_DAY,i=r.TIMEZONE_OFFSET,l=o.assignJSONMembers=function(t,r,o){var n,a,i;for(a in o===e&&(o=t.report.isWR),o&&(i=gr.wr.wrPropNameDecode),r)n=r[a],"object"!=_typeof(n)&&(o&&(a=i(a)),t.hasOwnProperty(a)&&(t[a]=n))},s=o.enumMemberValid=function(e,t,r){"number"!=typeof e[t]&&(e[t]=v(r,e[t]))},u=o.enumBitMemberValid=function(e,t,r){"number"!=typeof e[t]&&(e[t]=x(r,e[t]))},c=o.colorMemberValid=function(e,t,r){"number"!=typeof e[t]&&(e[t]=parseInt("0x"+e[t],16)|Math.max(0,Math.min(Math.round(255*r),255))<<24)},d=o.penStyleText=function(e){var r={Solid:"solid",Dash:"dashed",Dot:"dotted",DashDot:"dashed",DashDotDot:"dotted"};return g(e.Width)+" "+r[T(t.PenStyle,e.Style)]+" "+S(e.Color)},p=o.fontHeight=function(e){return 4*e.Size/3e4},h=(o.fontString=function(e,t,r){return t+" "+g(e)+" "+r},o.fontCSSText=function(e){var t="",r=[];return e.Italic&&r.push("italic"),e.Bold&&r.push("bold"),r.push(g(p(e)),e.Name),r.forEach((function(e){t&&(t+=" "),t+=e})),t}),f=(o.intFixed=function(e,t){var r,o=e+"";if(t>0)if(r=t-o.length,0>r)o=o.substr(-r);else for(;r-- >0;)o="0"+o;return o},function(e){var t=e.toFixed(2),r=t.length-1;return"0"===t.charAt(r)&&("0"===t.charAt(r-1)&&(r-=2),t=t.substr(0,r)),t}),g=o.pixelsToHtml=function(e){return f(e)+"px"},m=(o.percentToHtml=function(e){return f(e)+"%"},o.cloneDate=function(e){return new Date(e)}),_=o.confirmDateValue=function(t){function o(){function o(){var e=t.indexOf(":"),o=e>0&&8>e,n=t.split(/[\:\-\/ ]/g),a=n.length,i=a>0?+n[0]:0,l=a>1?+n[1]:0,s=a>2?+n[2]:0,u=a>3?+n[3]:0,c=a>4?+n[4]:0,d=a>5?+n[5]:0;return isNaN(l)&&(e=n[1],l=r.HZ_NUMBER.indexOf(e.charAt(0))+1,e.length>=3&&(l+=r.HZ_NUMBER.indexOf(e.charAt(1))+1)),o&&(e=i,i=u,u=e,e=l,l=c,c=e,e=s,s=d,d=e),s>31&&(e=i,i=s,s=e,e=l,l=s,s=e),l>12&&(e=l,l=s,s=e),new Date(i,--l,s,u,c,d)}var n;return"string"==typeof t?(n=Date.parse(t),t=t?isNaN(n)?o():new Date(n):e):(n=new M,n.AsFloat=+t,t=n.value),t}return Date.prototype.isPrototypeOf(t)?t:o()},C=(o.confirmCloneDateValue=function(e){return Date.prototype.isPrototypeOf(e)?m(e):_(e)},o.strimDate=function(e){var t=e.getTime();e.setTime(t-(t-6e4*e.getTimezoneOffset())%a)},o.incDate=function(e){e.setTime(e.getTime()+a)},o.incDate2=function(e,t){e.setTime(e.getTime()+t*a)}),v=(o.periodRangeBy=function(e,t){function r(){11>s?++s:(++u,s=0)}var o,n=e.getDate(),a=e.getMonth(),i=e.getFullYear(),l=n,s=a,u=i;if(2>=t)o={begin:m(e),end:m(e)},C(o.end,1===t?1:7);else{switch(t){case 3:10>=n?(n=1,l=11):20>=n?(n=11,l=21):(n=21,r(),l=1);break;case 4:15>=n?(n=1,l=16):(n=16,r(),l=1);break;case 5:n=l=1,r();break;case 6:n=l=1,a-=a%3,s=a,r(),r(),r();break;case 7:n=l=1,a=6>a?0:6,s=6>a?6:0,s||u++;break;case 8:n=l=1,a=s=0,u++}o={begin:new Date(i,a,n),end:new Date(u,s,l)}}return o},o.periodRangeNext=function(e,t){function r(){11>s?++s:(++u,s=0)}var o,n=e.begin.getDate(),a=e.begin.getMonth(),i=e.begin.getFullYear(),l=n,s=a,u=i;if(2>=t)o={begin:m(e.end),end:m(e.end)},C(o.end,1===t?1:7);else{switch(t){case 3:10>=n?(n=11,l=21):20>=n?(n=21,l=1,r()):(n=1,l=11,r(),i=u,a=s);break;case 4:15>=n?(n=16,l=1,r()):(n=1,l=16,r(),i=u,a=s);break;case 5:r(),i=u,a=s,r();break;case 6:r(),r(),r(),i=u,a=s,n=l,r(),r(),r();break;case 7:a?(a=0,i++,s=6):(a=6,s=0),u++;break;case 8:i++,u++,u++}o={begin:new Date(i,a,n),end:new Date(u,s,l)}}return o},o.confirmBooleanValue=function(e){if(e.constructor===Boolean.prototype.constructor)return e;if("string"==typeof e){if(e.toLowerCase(),"TRUE"===e||"true"===e)return!0;e=parseInt(e)}return!!e},o.ensureNameText=function(e){return/^[A-Za-z_\u0100-\uffff][\w\u0100-\uffff]*$/.test(e)||(e="["+e+"]"),e},o.enumName2Value=function(t,r){var o=t[r];if(o===e){for(var n in r=r.toUpperCase(),t)if(n.toUpperCase()===r)return t[n];o=-1}return o}),T=o.enumValue2Name=function(e,t){for(var r in e)if(e[r]===t)return r;return""},x=function(e,t){var r,o,n,a=0;for(t=t.substring(1,t.length-1),r=t.split("|"),n=r.length,o=0;n>o;o++)a+=e[r[o]]||0;return a},b=o.rgba2color=function(e,t,r,o){return w(e|t<<8|r<<16,o)},w=o.colorAlpha=function(e,t){return e|Math.max(0,Math.min(Math.round(255*t)))<<24},y=o.color2rgba=function(e){return{r:255&e,g:e>>8&255,b:e>>16&255,a:4278190080&e?(e>>24&255)/255:1}},S=o.colorValue2Html=function(e){function t(e){return(16>e?"0":"")+e.toString(16)}var r=y(e);return 1===r.a?"#"+t(r.r)+t(r.g)+t(r.b):"rgba("+r.r+","+r.g+","+r.b+","+f(r.a)+")"},D=o.colorIsBlack=function(e){return 16777215&e},F=(o.decodeTextColor=function(e){var t,r,o,n,a,i=4;return"rgb("===e.substr(0,4)&&(t=e.indexOf(")",i),-1!==t&&(e=e.substring(4,t),r=e.split(","),3===r.length&&(o=parseInt(r[0]),n=parseInt(r[1]),a=parseInt(r[2]),o>=0&&255>=o&&n>=0&&255>=n&&a>=0&&255>=a)))&&{color:rgb(o,n,a),index:t+1}},o.colorGradientLight=function(e){var t=y(e),r=120/255;return t.r+=(255-t.r)*r,t.g+=(255-t.g)*r,t.b+=(255-t.b)*r,t.r>255&&(t.r=255),t.g>255&&(t.g=255),t.b>255&&(t.b=255),b(t.r,t.g,t.b,t.a)},o.colorGradientDark=function(e){var t=y(e),r=30/255;return t.r-=t.r*r,t.g-=t.g*r,t.b-=t.b*r,t.r<0&&(t.r=0),t.g<0&&(t.g=0),t.b<0&&(t.b=0),b(t.r,t.g,t.b,t.a)},o.prototypeLinkExtend=function(e,t){function r(){}var o,n=e.prototype;for(var a in r.prototype=t.prototype,o=new r,n)o[a]=n[a];e.prototype=o,e.prototype.constructor=e},o.prototypeCopyExtend=function(e,t){var r=t.prototype,o=e.prototype;for(var n in r)o.hasOwnProperty(n)||(o[n]=r[n]);o.constructor=e},o.createArray=function(e,t){for(var r=[],o=0;o++<e;)r.push(t);return r},o.assignObjectEx=function(e,t,r){var o,n;for(var a in t)t.hasOwnProperty(a)&&(o=t[a],n=_typeof(o),r&&"object"===n?(e[a]||(e[a]={}),P(e[a],o)):e[a]=o);return e}),P=o.assignObject=function(e,t){F(e,t,1)},E=(o.assignObjectAtom=function(e,t){var r;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],"object"!=_typeof(r)&&(e[o]=r));return e},o.compareObject=function(e,t){var r;if(e===t)return 1;if(!e||!t)return 0;for(var o in e)if(r=_typeof(e[o]),"object"===r){if(!E(e[o],t[o]))return 0}else if("function"!==r&&e[o]!==t[o])return 0;return 1}),A=(o.parseXML=function(t){function r(){for(var e,r=0,o=t.indexOf("<",r),n=[];o>=0;)o>r&&(e=t.substring(r,o),/\S/g.test(e)&&n.push(e)),r=o,o=t.indexOf(">",r+1),n.push(t.substring(r,++o)),r=o,o=t.indexOf("<",r);return n}var o;/\s/g.test(t)&&(t=r().join(""));try{o=(new DOMParser).parseFromString(t,"text/xml")}catch(n){o=e}return o},o.xmlToReportDataJSON=function(e){var t,r,o,n,a="",i={};for(o=e.childNodes[0].firstChild;o;){for(o.nodeName!==a&&(a=o.nodeName,r=[],i[o.nodeName]=r),t={},n=o.firstChild;n;)t[n.nodeName]=n.hasOwnProperty("text")?n.text:n.textContent,n=n.nextSibling;r.push(t),o=o.nextSibling}return i},o.getRelativePosition=function(e){var t,r,o=e.originalEvent||e,n=e.currentTarget||e.srcElement,a=n.getBoundingClientRect();return o.touches?(t=o.touches[0].clientX-a.left,r=o.touches[0].clientY-a.top):(t=o.clientX-a.left,r=o.clientY-a.top),{x:t,y:r}},o.addEvent=function(e,t,r){e.addEventListener?e.addEventListener(t,r):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}),R=o.removeEvent=function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent?e.detachEvent("on"+t,r):e["on"+t]=noop},B=(o.bindEvents=function(e,t,r){e.events||(e.events={}),t.forEach((function(t){e.events[t]=function(){r.apply(e,arguments)},A(e.canvas,t,e.events[t])}))},o.unbindEvents=function(e,t){t.forEach((function(t,r){R(e.canvas,r,t)}))},o.toRadians=function(e){return e*Math.PI/180}),M=(o.toDegree=function(e){return 180*e/Math.PI},n.DateTime=function(){this.value=new Date});n.DateTime.prototype={get Year(){return this.value.getFullYear()},get Month(){return this.value.getMonth()+1},get Day(){return this.value.getDate()},get Hour(){return this.value.getHours()},get Minute(){return this.value.getMinutes()},get Second(){return this.value.getSeconds()},get DayOfWeek(){return this.value.getDay()},get DayOfYear(){var e=this.value,t=e.getFullYear();return(new Date(t,e.getMonth(),e.getDate()).getTime()-new Date(t,0,1).getTime())/a+1},get AsFloat(){return(this.value.getTime()+new Date(1970,0,1).getTime()-new Date(1899,11,30).getTime()-i)/a},set AsFloat(e){this.value.setTime(e*a+new Date(1899,11,30).getTime()-new Date(1970,0,1).getTime()+i)},ValueFromDate:function(e,t,r){this.value=new Date(e,t-1,r)},ValueFromDateTime:function(e,t,r,o,n,a){this.value=new Date(e,t-1,r,o,n,a)},Format:function(e){return new gr.format.DateTimeFormatter(e).format(this.value)}};var k=n.Rect=function(e,t,r,o){var n=this;n.left=e,n.top=t,n.right=r,n.bottom=o};n.Rect.prototype={clone:function(){var e=this;return new n.Rect(e.left,e.top,e.right,e.bottom)},IsRectEmpty:function(){var e=this;return e.left>=e.right||e.top>=e.bottom},PtInRect:function(e,t){var r=this;return r.left<=e&&e<r.right&&r.top<=t&&t<r.bottom},Width:function(){var e=this;return e.right-e.left},Height:function(){var e=this;return e.bottom-e.top},SetRect:function(e,t,r,o){var n=this;n.left=e,n.top=t,n.right=r,n.bottom=o},InflateRect:function(e,t){var r=this;r.left-=e,r.top-=t,r.right+=e,r.bottom+=t},OffsetRect:function(e,t){var r=this;r.left+=e,r.top+=t,r.right+=e,r.bottom+=t},IntersectRect:function(e){var t=this;t.left=Math.max(t.left,e.left),t.top=Math.max(t.top,e.top),t.right=Math.min(t.right,e.right),t.bottom=Math.min(t.bottom,e.bottom)}};var N=n.Pen=function(t,r,o){var n=this;t===e&&(t=1),r===e&&(r=0),o===e&&(o=0),n.Width=t,n.Color=w(r,1),n.Style=o};N.prototype={clone:function(){var e=this,t=new N;return t.Width=e.Width,t.Style=e.Style,t.Color=e.Color,t},loadFromJSON:function(e,r,o){e&&(l(this,e,o),s(this,"Style",t.PenStyle),c(this,"Color",r))},getDashStyle:function(){var e;switch(this.Style){case 1:e=[2,2];break;case 2:e=[1,1];break;case 3:e=[2,1,1,1];break;case 4:e=[2,1,1,1,1,1];break;default:e=[]}return e}};var L=n.Border=function(e){var t=this;t.Styles=e,t.Shadow=!1,t.ShadowWidth=4,t.ShadowColor=0,t.Pen=new N};n.Border.prototype={loadFromJSON:function(e,r,o){var n=this;e&&(l(n,e,o),u(n,"Styles",t.BorderStyle),c(n,"ShadowColor"),e.Pen&&n.Pen.loadFromJSON(e.Pen,r,o))},clone:function(){var e=this,t=new L;return t.Styles=e.Styles,t.Shadow=e.Shadow,t.ShadowWidth=e.ShadowWidth,t.ShadowColor=e.ShadowColor,t.Pen=e.Pen.clone(),t},getLeftWidth:function(){var e=this;return 1&e.Styles?e.Pen.Width:0},getRightWidth:function(){var e=this;return(4&e.Styles?e.Pen.Width:0)+(e.Shadow?e.ShadowWidth:0)},getTopWidth:function(){var e=this;return 2&e.Styles?e.Pen.Width:0},getBottomWidth:function(){var e=this;return(8&e.Styles?e.Pen.Width:0)+(e.Shadow?e.ShadowWidth:0)}};var I=n.Font=function(){var e=this;e.Size=97500,e.Bold=!1,e.Italic=!1,e.Underline=!1,e.Strikethrough=!1,e.Name=""};I.prototype={loadFromJSON:function(e,t){e&&l(this,e,t)},clone:function(){var e=this,t=new I;return t.Size=e.Size,t.Bold=e.Bold,t.Italic=e.Italic,t.Underline=e.Underline,t.Strikethrough=e.Strikethrough,t.Name=e.Name,t}},n.FontWrapper=function(e){this.parentFont=e},n.FontWrapper.prototype={loadFromJSON:function(e,t){var r=this;e&&(r.prepareModify(),r.font.loadFromJSON(e,t))},assign:function(e){var t=this;e.font?t.font=e.font.clone():delete t.font},prepareModify:function(){var e=this;e.font||(e.font=e.parentFont.UsingFont().clone())},Clone:function(){var e=this,t=new n.FontWrapper(e.parentFont);return t.font=e.UsingFont().clone(),t},UsingFont:function(){var e=this;return e.font?e.font:e.parentFont.UsingFont()},get Name(){return this.UsingFont().Name},set Name(e){var t=this;t.prepareModify(),t.font.Name=e},get Point(){return this.UsingFont().Size/1e4},set Point(e){var t=this;t.prepareModify(),t.font.Size=1e4*e},get Bold(){return this.UsingFont().Bold},set Bold(e){var t=this;t.prepareModify(),t.font.Bold=e},get Italic(){return this.UsingFont().Italic},set Italic(e){var t=this;t.prepareModify(),t.font.Italic=e},get Underline(){return this.UsingFont().Underline},set Underline(e){var t=this;t.prepareModify(),t.font.Underline=e},get Strikethrough(){return this.UsingFont().Strikethrough},set Strikethrough(e){var t=this;t.prepareModify(),t.font.Strikethrough=e}};var O=n.TextFormat=function(){var e=this;e.WordWrap=!1,e.EndEllipsis=!1,e.TextAlign=33,e.TextOrientation=0,e.TextAngle=0,e.CharacterSpacing=0,e.LineSpacing=0,e.FirstCharIndent=0,e.HtmlTags=!1};O.prototype={loadFromJSON:function(e,r){var o=this,n="CharSpacing",a="LnSpacing";e&&(l(o,e,r),r&&(n=gr.wr.wrPropNameEncode(n),a=gr.wr.wrPropNameEncode(a)),n=e[n],n&&(o.CharacterSpacing=n),a=e[a],a&&(o.LineSpacing=a),s(o,"TextAlign",t.TextAlign),s(o,"TextOrientation",t.TextOrientation))},Clone:function(){var e=this,t=new O;return t.WordWrap=e.WordWrap,t.EndEllipsis=e.EndEllipsis,t.TextAlign=e.TextAlign,e.TextOrientation=e.TextOrientation,e.TextAngle=e.TextAngle,t.CharacterSpacing=e.CharacterSpacing,t.LineSpacing=e.LineSpacing,t.FirstCharIndent=e.FirstCharIndent,t}},n.Context=function(e){var t=this;t.ctx=e,e.textBaseline="top",t.pens=[new N],t.fills=[e.fillStyle],t.fonts=[],t.clips=[]},n.Context.prototype={get width(){return this.ctx.canvas.width},get height(){return this.ctx.canvas.height},get usingFont(){var e=this.fonts,t=e.length;return e[t-1]},selectFillStyle:function(e){var t=this;t.fills.push(e),t.ctx.fillStyle=e},selectFillColor:function(e){this.selectFillStyle(S(e))},restoreFillStyle:function(){var e=this,t=e.fills;t.pop(),e.ctx.fillStyle=t[t.length-1]},selectPen:function(e){var t=this;t.pens.push(e),t._applyPen()},selectPen2:function(e,t,r){this.selectPen(new N(e,t,r))},restorePen:function(){var e=this;e.pens.pop(),e._applyPen()},selectFont:function(e){var t=this,r=t.fonts,o=r[r.length-1];e!==o&&(t.ctx.font=h(e)),r.push(e)},restoreFont:function(){var e=this,t=e.fonts,r=t.pop(),o=t[t.length-1];t.length>0?o!==r&&(e.ctx.font=h(o)):e.ctx.font=""},fontSizeTo:function(e){var t=this,r=t.usingFont.clone();r.Size=e,t.selectFont(r)},pushClipRect:function(e,t,r,o){var n=this,a=this.ctx,i=n.clips,l=i.length,s=new k(e,t,e+r,t+o);l&&s.IntersectRect(i[l-1]),i.push(s),a.beginPath(),a.rect(s.left,s.top,s.Width(),s.Height()),a.clip()},popClipRect:function(){var e=this,t=this.ctx,r=t.canvas,o=e.clips,n=o.length;rect,o.pop(rect),rect=n>1?o[n-2]:new k(0,0,r.width,r.height),t.beginPath(),t.rect(rect.left,rect.top,rect.Width(),rect.Height()),t.clip()},measureTextWidth:function(e){return this.ctx.measureText(e).width},measureTextHeight:function(e){return p(this.usingFont)},drawText:function(e,t,r){this.ctx.fillText(e,t,r)},drawTextCenter:function(e,t,r){var o=this.ctx;o.textAlign="center",o.fillText(e,t,r),o.textAlign="start"},drawTextAlign:function(e,t,r,o,n,a,i){var l,s=this,u=p(s.usingFont),c=2&a,d=4&a,h=32&a,f=64&a;h?r+=(n-u)/2:f&&(r+=n-u),(c||d)&&(l=s.measureTextWidth(e),(!i||o>l)&&(t+=c?(o-l)/2:o-l)),i?s.ctx.fillText(e,t,r,o):s.ctx.fillText(e,t,r)},drawTextAlign2:function(e,t,r,o){this.drawTextAlign(e,t.left,t.top,t.Width(),t.Height(),r,o)},drawFormatText:function(e,t,r,o,n,a){var i=this;0===a.TextOrientation?a.TextAngle?i.drawTextRotate(e,t,r,a.TextAngle):(a.CharacterSpacing||a.LineSpacing||a.FirstCharIndent||a.ParagraphSpacing||1!==a.FontWidthRatio||a.TextAlign,i.drawTextAlign(e,t,r,o,n,a.TextAlign)):i.drawOrientationText(e,t,r,o,n,a)},drawOrientationText:function(e,t,r,o,n,a){var i=this,l=i.ctx,s=0,u=e.length,c=p(i.usingFont),d=a.TextOrientation,h=32&d;if(h)i.drawTextAlign(e,t,r,o,n,a.TextAlign);else for(;u>s;)l.fillText(e[s++],t,r),r+=c},drawTextRotate:function(e,t,r,o){var n=this.ctx;n.translate(t,r),n.rotate(B(-o)),this.ctx.fillText(e,0,0),n.setTransform(1,0,0,1,0,0)},drawEqualSpaceText:function(e,t,r,o){for(var n,a,i=this,l=t,s=e.length,u=0,c=(r-t)/s;s>u;)n=t+c*(u+1),a=e.substr(u++,1),i.drawText(a,(n+l-i.measureTextWidth(a))/2,o),l=n},beginPath:function(){var e=this;e.ctx.beginPath(),e.inpath=1},closePath:function(){this.ctx.closePath()},stroke:function(){var e=this;e.ctx.stroke(),e.inpath=0},fill:function(){var e=this;e.ctx.fill(),e.inpath=0},strokefill:function(){var e=this;e.ctx.stroke(),e.ctx.fill(),e.inpath=0},fillRect:function(e,t,r,o,n){var a=this;a.selectFillColor(n),a.ctx.fillRect(e,t,r,o),a.restoreFillStyle(n)},fillRect2:function(e,t){this.fillRect(e.left,e.top,e.Width(),e.Height(),t)},moveTo:function(e,t){var r=this,o=r.ctx;!r.inpath&&o.beginPath(),o.moveTo(e,t)},lineTo:function(e,t){var r=this,o=r.ctx;o.lineTo(e,t),!r.inpath&&o.stroke()},drawLine:function(e,t,r,o){var n=this.ctx;n.beginPath(),n.moveTo(e,t),n.lineTo(r,o),n.stroke()},drawPolyLine:function(e,t,r){var o=this.ctx,n=0,a=e.length;for(o.beginPath(),o.moveTo(e[n++],e[n++]);a>n;)o.lineTo(e[n++],e[n++]);r&&o.closePath(),o.stroke(),t&&o.fill()},bezierCurveTo:function(e,t,r,o,n,a){this.ctx.bezierCurveTo(e,t,r,o,n,a)},polyBezier:function(e){var t,r=this.ctx,o=e.length;for(r.beginPath(),r.moveTo(e[0].x,e[0].y),t=1;o>t;t++)r.bezierCurveTo(e[t].x,e[t++].y,e[t].x,e[t++].y,e[t].x,e[t].y);r.stroke()},circle:function(e,t,r,o,n){var a=this.ctx,i=(o>r?r:o)/2;e+=r/2,t+=o/2,a.beginPath(),a.arc(e,t,i,0,2*Math.PI),a.stroke(),n&&a.fill()},ellipse:function(e,t,r,o,n){var a=this.ctx,i=r>o?r:o,l=r/i,s=o/i;e+=r/2,t+=o/2,i/=2,a.beginPath(),a.save(),a.scale(l,s),a.arc(e/l,t/s,i,0,2*Math.PI),a.restore(),a.stroke(),n&&a.fill()},rectangle:function(e,t,r,o,n){var a=this;a.ctx.strokeRect(e,t,r,o),n&&a.ctx.fillRect(e,t,r,o)},rectangle2:function(e,t){this.rectangle(e.left,e.top,e.Width(),e.Height(),t)},square:function(e,t,r,o,n){var a=o>r?r:o;e+=(r-a)/2,t+=(o-a)/2,this.rectangle(e,t,a,a,n)},roundRectangle:function(e,t,r,o,n,a,i){var l=this.ctx;l.beginPath(),l.moveTo(e+n,t),l.lineTo(e+r-n,t),l.quadraticCurveTo(e+r,t,e+r,t+a),l.lineTo(e+r,t+o-a),l.quadraticCurveTo(e+r,t+o,e+r-n,t+o),l.lineTo(e+n,t+o),l.quadraticCurveTo(e,t+o,e,t+o-a),l.lineTo(e,t+a),l.quadraticCurveTo(e,t,e+n,t),l.stroke(),i&&l.fill()},roundSquare:function(e,t,r,o,n,a,i){var l=o>r?r:o;e+=(r-l)/2,t+=(o-l)/2,this.roundRectangle(e,t,l,l,n,a,i)},arc:function(e,t,r,o,n){var a=this,i=a.ctx,l=!a.inpath;l&&i.beginPath(),i.arc(e,t,r,-B(o),-B(n),n>=o),l&&i.stroke()},ellipseArc:function(e,t,r,o,n,a){var i=this,l=i.ctx,s=!i.inpath,u=l.ellipse,c=r/2,d=o/2,p=e+c,h=t+d,f=a>=n;n=-B(n),a=-B(a);s&&l.beginPath(),u?l.ellipse(p,h,c,d,0,n,a,f):l.arc(p,h,Math.min(c,d),n,a,f),s&&l.stroke()},pie:function(e,t,r,o,n,a){var i=this,l=i.ctx;o=B(o),n=B(n),l.beginPath(),l.moveTo(e,t),l.arc(e,t,r,-o,-n,1),l.closePath(),l.stroke(),a&&l.fill()},ellipsePie:function(e,t,r,o,n,a,i){var l,s,u=this.ctx,c=u.ellipse,d=r/2,p=o/2,h=e+d,f=t+p,g=a>=n;n=B(n),a=B(a),c||(d=p=Math.min(d,p)),l=h+Math.cos(n)*d,s=f-Math.sin(n)*p,u.beginPath(),u.moveTo(h,f),u.lineTo(l,s),c?u.ellipse(h,f,d,p,0,-n,-a,g):u.arc(h,f,d,-n,-a,g),u.closePath(),u.stroke(),i&&u.fill()},drawBar:function(e,t,r,o){var n,a=this,i=a.ctx,l=[{x:e.left,y:e.bottom},{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.right,y:e.bottom}];a.selectFillColor(r),a.selectPen(t),i.fillRect(e.left,e.top,e.Width(),e.Height()),i.beginPath(),n=l[o],i.moveTo(n.x,n.y),n=l[++o%4],i.lineTo(n.x,n.y),n=l[++o%4],i.lineTo(n.x,n.y),n=l[++o%4],i.lineTo(n.x,n.y),i.stroke(),a.restorePen(),a.restoreFillStyle()},DrawHorzLine:function(e,t,r){this.drawLine(t,e,r,e)},DrawVertLine:function(e,t,r){this.drawLine(e,t,e,r)},DrawPointMarker:function(t,r,o,n){function a(){var e,o=10===r?4:11===r?5:12===r?6:10,n=2*Math.PI/o,a=n/2,i=t.Width()/2,l=i/2,s=t.left+i,c=t.top+i,d=Math.PI/2,p=[];for(e=0;o>e;e++)p.push(s+Math.cos(d)*i,c-Math.sin(d)*i),d+=a,p.push(s+Math.cos(d)*l,c-Math.sin(d)*l),d+=a;u.drawPolyLine(p,1,1)}function i(){var e,a=o&&c;a&&(e=o.clone(),e.Color=n,u.selectPen(e)),u.drawLine(t.left,t.top,t.right,t.bottom),u.drawLine(t.left,t.bottom,t.right,t.top),9===r&&(l=(t.left+t.right)/2,u.drawLine(l,t.top,l,t.bottom),s=(t.top+t.bottom)/2,u.drawLine(t.left,s,t.right,s)),a&&u.restorePen()}var l,s,u=this,c=n!==e,d=t.Width(),p=Math.min(4,(d-4)/2);switch(c&&u.selectFillColor(n),o&&u.selectPen(o),r){case 3:case 4:case 5:u.ellipse(t.left,t.top,t.Width(),t.Height(),1),4===r?u.circle((t.left+t.right)/2-1,(t.top+t.bottom)/2-1,2,2,0):5===r&&(d=Math.min(4,d/3),u.drawLine(t.left+d,t.top+d,t.right-d,t.bottom-d),u.drawLine(t.right-d,t.top+d,t.left+d,t.bottom-d));break;case 0:case 1:case 2:u.rectangle(t.left,t.top,t.Width(),t.Height(),1),1===r?u.drawPolyLine([t.left+p,t.top+d/2,t.left+d/2,t.bottom-p,t.right-p,t.top+p]):2===r&&(u.drawLine(t.left+p,t.top+p,t.right-p,t.bottom-p),u.drawLine(t.right-p,t.top+p,t.left+p,t.bottom-p));break;case 8:case 9:i();break;case 6:u.drawPolyLine([(t.left+t.right)/2,t.top,t.left,(t.top+t.bottom)/2,(t.left+t.right)/2,t.bottom,t.right,(t.top+t.bottom)/2],1,1);break;case 7:u.drawPolyLine([(t.left+t.right)/2,t.top,t.left,t.bottom,t.right,t.bottom],1,1);break;case 10:case 11:case 12:case 13:a()}o&&u.restorePen(),c&&u.restoreFillStyle()},_applyPen:function(){var e=this,t=e.ctx,r=e.pens,o=r[r.length-1];t.lineWidth=o.Width,t.strokeStyle=S(o.Color),t.setLineDash(o.getDashStyle())}},n.Graphics=function(e){var t=this;t.report=e,t.ByUnit=0},n.Graphics.prototype={toPixels:function(e){var t=this;return t.ByUnit?t.report.UnitToPixels(e):e},pixelsTo:function(e){var t=this;return t.ByUnit?t.report.PixelsToUnit(e):e},get Left(){return 0},get Top(){return 0},get Width(){var e=this;return e.pixelsTo(e.ctx.width)},get Height(){var e=this;return e.pixelsTo(e.ctx.height)},attach:function(e){this.ctx=e},MoveTo:function(e,t){var r=this;r.ctx.moveTo(r.toPixels(e),r.toPixels(t))},LineTo:function(e,t){var r=this;r.ctx.lineTo(r.toPixels(e),r.toPixels(t))},FillRect:function(e,t,r,o,n){var a=this;a.ctx.fillRect(a.toPixels(e),a.toPixels(t),a.toPixels(r),a.toPixels(o),n)},Rectangle:function(e,t,r,o,n){var a=this;a.ctx.rectangle(a.toPixels(e),a.toPixels(t),a.toPixels(r),a.toPixels(o),n)},RoundRect:function(e,t,r,o,n,a,i){var l=this;l.ctx.roundRectangle(l.toPixels(e),l.toPixels(t),l.toPixels(r),l.toPixels(o),l.toPixels(n),l.toPixels(a),i)},Ellipse:function(e,t,r,o,n){var a=this;a.ctx.ellipse(a.toPixels(e),a.toPixels(t),a.toPixels(r),a.toPixels(o),n)},Pie:function(e,t,r,o,n,a){var i=this;i.ctx.pie(i.toPixels(e),i.toPixels(t),i.toPixels(r),o,n,a)},Arc:function(e,t,r,o,n){var a=this;a.ctx.arc(a.toPixels(e),a.toPixels(t),a.toPixels(r),o,n)},EllipseArc:function(e,t,r,o,n,a){var i=this;i.ctx.ellipseArc(i.toPixels(e),i.toPixels(t),i.toPixels(r),i.toPixels(o),n,a)},EllipsePie:function(e,t,r,o,n,a,i){var l=this;l.ctx.ellipsePie(l.toPixels(e),l.toPixels(t),l.toPixels(r),l.toPixels(o),n,a,i)},DrawLabelText:function(e,t,r){var o=this;o.ctx.drawText(e,o.toPixels(t),o.toPixels(r))},DrawRotateText:function(e,t,r,o){var n=this;n.ctx.drawTextRotate(e,n.toPixels(t),n.toPixels(r),o)},DrawText:function(e,t,r,o,n,a,i){var l=this;l.ctx.drawTextAlign(e,l.toPixels(t),l.toPixels(r),l.toPixels(o),l.toPixels(n),a)},DrawFormatText:function(e,t,r,o,n,a){var i=this;i.ctx.drawFormatText(e,i.toPixels(t),i.toPixels(r),i.toPixels(o),i.toPixels(n),a)},DrawFormatTextShrinkToFit:function(e,t,r,o,n,a){var i=this;i.ctx.drawTextAlign(e,i.toPixels(t),i.toPixels(r),i.toPixels(o),i.toPixels(n),a.TextAlign,1)},CalcLabelTextWidth:function(e){var t=this;return t.pixelsTo(t.ctx.measureTextWidth(e))},CalcLabelTextHeight:function(e){var t=this;return t.pixelsTo(t.ctx.measureTextHeight(e))},CalcTextOutLen:function(e,t,r,o){return r.length},CalcDrawFormatTextHeight:function(e,t,r){var o=this;return o.pixelsTo(o.ctx.measureTextHeight(e))},CalcDrawFormatTextWidth:function(e,t){var r=this;return r.pixelsTo(r.ctx.measureTextWidth(e))},CalcDrawFormatTextOutLen:function(e,t,r,o){return e.length},DrawPicture:function(e,t,r,o,n,a,i,l){},SelectFont:function(e){this.ctx.selectFont(e.font)},RestoreFont:function(){this.ctx.restoreFont()},FontPointChangeTo:function(e){this.ctx.fontSizeTo(e)},FontSizeRestore:function(){this.ctx.restoreFont()},SelectTextColor:function(e){this.ctx.selectFillColor(e)},RestoreTextColor:function(){this.ctx.restoreFillStyle()},SelectPen:function(e,t,r){this.ctx.selectPen2(e,t,r)},RestorePen:function(){this.ctx.restorePen()},SelectFillColor:function(e){this.ctx.selectFillColor(e)},RestoreFillColor:function(){this.ctx.restoreFillStyle()},PushClipRect:function(e,t,r,o){var n=this;n.ctx.pushClipRect(n.toPixels(e),n.toPixels(t),n.toPixels(r),n.toPixels(o))},PopClipRect:function(){this.ctx.popClipRect()},CurveTo:function(e,t,r,o,n,a){var i=this;i.ctx.bezierCurveTo(i.toPixels(e),i.toPixels(t),i.toPixels(r),i.toPixels(o),i.toPixels(n),i.toPixels(a))},CalcCurveControlPoints:function(e,t,r,o,n,a){var i=this,l=.4,s=Math.sqrt(Math.pow(r-e,2)+Math.pow(o-t,2)),u=Math.sqrt(Math.pow(n-r,2)+Math.pow(a-o,2)),c=s+u,d=1,p=1;c>0&&(d=l*s/c,p=l*u/c),i.CCPInnerX=r-d*(n-e),i.CCPInnerY=o-d*(a-t),i.CCPOuterX=r+p*(n-e),i.CCPOuterY=o+p*(a-t)},DrawPointMarker:function(e,t,r,o){var n=this;t=n.toPixels(t),r=n.toPixels(r),o=n.toPixels(o/2),n.ctx.DrawPointMarker(new k(t-o,r-o,t+o,r+o),e)},BeginPath:function(){this.ctx.beginPath()},ClosePath:function(){this.ctx.closePath()},EndPath:function(){},StrokePath:function(){this.stroke()},FillPath:function(){this.fill()},StrokeAndFillPath:function(){this.strokefill()}},n.HtmlStyles=function(){this.items=[]},n.HtmlStyles.prototype={add:function(e,t){this.items.push({name:e,value:t})},addBackColor:function(e){this.add("background-color",S(e))},addCellBorder:function(e){var t=this;e.ShowColLine&&e.ShowRowLine&&E(e.ColLinePen,e.RowLinePen)?t.add("border",d(e.ColLinePen)):(e.ShowRowLine&&t.add("border-bottom",d(e.ColLinePen)),e.ShowColLine&&t.add("border-right",d(e.RowLinePen)))},addObjectPadding:function(e){var t=e.padding,r="";return t.Right===t.Left&&t.Top===t.Bottom?(t.Right!==t.Top&&(r=g(t.Top)+" "),r+=g(t.Right)):r=g(t.Top)+" "+g(t.Right)+" "+g(t.Bottom)+" "+g(t.Left),this.add("padding",r)},addBorder:function(e){var t,r=this;e.Styles&&(t=d(e.Pen),15===e.Styles?r.add("border",t):(1&e.Styles&&r.add("border-left",t),4&e.Styles&&r.add("border-right",t),2&e.Styles&&r.add("border-top",t),8&e.Styles&&r.add("border-bottom",t))),e.Shadow&&(t=g(e.ShadowWidth)+" ",r.add("box-shadow",t+t+S(e.ShadowColor)))},addTextFormat:function(e,t){var r,o=this,n=e.TextFormat,a=n.LineSpacing,i="text-align",l=n.WordWrap;1&n.TextAlign?o.add(i,"left"):2&n.TextAlign?o.add(i,"center"):4&n.TextAlign?o.add(i,"right"):o.add(i,"justify"),t&&(i="vertical-align",16&n.TextAlign?o.add(i,"top"):32&n.TextAlign?o.add(i,"middle"):o.add(i,"bottom")),n.EndEllipsis&&(o.add("text-overflow","ellipsis"),l=!1),l?o.add("white-space","normal"):(o.add("overflow","hidden"),o.add("white-space","nowrap")),n.CharacterSpacing&&o.add("letter-spacing",g(n.CharacterSpacing)),a&&(r=p(e.obj.getUsingFont()),o.add("line-height",f((r+a)/r))),n.FirstCharIndent&&o.add("text-indent",g(n.FirstCharIndent)),D(n.ForeColor)&&o.add("color",S(n.ForeColor))},getText:function(){var e="";return this.items.forEach((function(t){e+=t.name+":"+t.value+";"})),e},clear:function(){this.items=[]}};var V=n.HtmlStyles;n.HtmlElement=function(e,t){var r=this;r.tag=e,r.classes=[],t.addChild(this)},n.HtmlElement.prototype={get styles(){var e=this;return e._styles||(e._styles=new V),e._styles},addClass:function(e){this.classes.push(e)},addStyle:function(e,t){this.styles.add(e,t)},addBackColorStyle:function(e){this.addStyle("background-color",S(e))},addAttribute:function(e,t){var r=this;r._attributes||(r._attributes=[]),r._attributes.push({name:e,value:t})},addChild:function(e){var t=this;t.children||(t.children=[]),t.children.push(e)},beginText:function(){var t=this,r="<"+t.tag;return t.classes.length>0&&(r+=' class="',t.classes.forEach((function(e,t){t>0&&(r+=" "),r+=e})),r+='"'),t._styles&&(r+=' style="'+t._styles.getText()+'"'),t._attributes&&t._attributes.forEach((function(t){var o=t.value;r+=" "+t.name,o!==e&&(r+='="'+o+'"')})),t.skipend&&(r+="/"),r+=">"},endText:function(){var e=this;return e.skipend?"":"</"+e.tag+">"}}}(),function(e){"use strict";gr.wr={WRZipSource:['":"','","','"},{"','":{"','},{"','":',',"',"false"],WRZipDest:"!$%&@^`~",WRAsciiMap_R:"r<~VH6SAZ?yiO %1#Ek>]`+|F_t/$RgQnX=YbqL)7uU9,oaB5}-'ev4;JD.2WsP@3zhl\"cfC^(K0mx!&Td{*GM:[pIj8\\Nw",propNameMap:{AlternatingBackColor:"G",BackColor:"Q",BarcodeType:"b",BorderCustom:"i",CharSpacing:"x",DBFieldName:"WA",FreeCell:"AB",GroupLabel:"OB",GroupTitle:"PB",Height:"ZB",IsCrossTab:"jB",LeftMargin:"tB",LnSpacing:"JC",Name:"YC",Oriention:"eC",RightMargin:"qD",SeriesLabel:"HE",Type:"LF",Value:"UF",Width:"eF"},propNameMap_R:{A:"AdjustRowHeight",B:"AlignColumn",C:"AlignColumnEx",D:"AlignColumnSide",E:"AlignToGrid",F:"Alignment",G:"AlternatingBackColor",H:"AlwaysShowHScrollBar",I:"AlwaysShowVScrollBar",J:"Anchor",K:"AppendBlankCol",L:"AppendBlankColWidth",M:"AppendBlankRow",N:"AppendBlankRowAtLast",O:"AppendBlankRowExclude",P:"Author",Q:"BackColor",R:"BackImage",S:"BackImageFile",T:"BackImagePreview",U:"BackImagePrint",V:"BackStyle",W:"BackgroundColor",X:"BarRatio",Y:"BarSingleSeriesColor",Z:"BarWidth",a:"BarWidthPercent",b:"BarcodeType",c:"BeforePostRecordScript",d:"BeforeSortScript",e:"BeginDateParameter",f:"Bold",g:"BookmarkText",h:"BorderColor",i:"BorderCustom",j:"BorderPrintType",k:"BorderStyles",l:"BorderWidth",m:"BottomMargin",n:"BubbleScalePerCm",o:"ByFields",p:"ByY2Axis",q:"CanGrow",r:"CanShrink",s:"CaptionAlignment",t:"CaptionPosition",u:"Center",v:"CenterView",w:"CenterWithDetailGrid",x:"CharSpacing",y:"CharacterSpacing",z:"Charset",AA:"Chart3D",BA:"ChartType",CA:"CheckSum",DA:"CodePage",EA:"ColLineColor",FA:"ColLineWidth",GA:"ColSpan",HA:"Color",IA:"Column",JA:"ColumnCount",KA:"ColumnMove",LA:"ColumnResize",MA:"ConditionScript",NA:"ConnectionString",OA:"ContinuePrint",PA:"CoordLineColor",QA:"CoordLineVisible",RA:"CornerDx",SA:"CornerDy",TA:"Cursor",UA:"CustomDraw",VA:"CustomDrawScript",WA:"DBFieldName",XA:"DataField",YA:"DataName",ZA:"DataType",aA:"Description",bA:"Direction",cA:"DisabledSumFields",dA:"DisplayField",eA:"Dock",fA:"DtmxEncoding",gA:"DtmxMatrixSize",hA:"DtmxModuleSize",iA:"Editable",jA:"EndDateParameter",kA:"EndEllipsis",lA:"ExportBeginScript",mA:"ExportEndScript",nA:"FalseText",oA:"FetchRecordScript",pA:"FillColor",qA:"FillColorAuto",rA:"FillStyle",sA:"FirstCharIndent",tA:"FixCols",uA:"FixedWidth",vA:"FlowTo",wA:"FontWidthRatio",xA:"ForeColor",yA:"Format",zA:"FormatScript",AB:"FreeCell",BB:"GetDisplayTextScript",CB:"GlobalScript",DB:"GridColsPerUnit",EB:"GridLinePrintType",FB:"GridRowsPerUnit",GB:"GroupAuto",HB:"GroupAutoSum",IB:"GroupBeginScript",JB:"GroupCount",KB:"GroupEndScript",LB:"GroupField",MB:"GroupIndex",NB:"GroupKeepTogether",OB:"GroupLabel",PB:"GroupTitle",QB:"GrowToBottom",RB:"GrowToNextRow",SB:"HCrossFields",TB:"HCrossPeriodType",UB:"HNewPageFixed",VB:"HPercentColumns",WB:"HResort",XB:"HSortAsc",YB:"HTotalAtFirst",ZB:"Height",aB:"HideOnRecordsetEmpty",bB:"HtmlTags",cB:"Image",dB:"ImageFile",eB:"ImageIndex",fB:"IncludeFooter",gB:"InitializeScript",hB:"InnerIndent",iB:"InnerStyles",jB:"IsCrossTab",kB:"Italic",lB:"KeepTogether",mB:"L2R",nB:"Label",oB:"LabelAsGroup",pB:"LabelInBar",qB:"LabelText",rB:"LabelTextAngle",sB:"Left",tB:"LeftMargin",uB:"LegendAtBottom",vB:"LegendColumnCount",wB:"LegendCursor",xB:"LegendShowSum",yB:"LegendSumLabel",zB:"LegendValueVisible",AC:"LegendVisible",BC:"Length",CC:"LimitsPerPage",DC:"LineColor",EC:"LineSpacing",FC:"LineType",GC:"LineVisible",HC:"LineWeight",IC:"ListCols",JC:"LnSpacing",KC:"Lock",LC:"Locked",MC:"MarginBeginWeight",NC:"MarginEndWeight",OC:"MarginGap",PC:"MarkerColor",QC:"MarkerColorAuto",RC:"MarkerLegendShow",SC:"MarkerSize",TC:"MarkerStyle",UC:"Max",VC:"Min",WC:"MirrorMargins",XC:"MonoPrint",YC:"Name",ZC:"NegativeAsZero",aC:"NewPage",bC:"NewPageColumn",cC:"OccupiedColumns",dC:"OccupyColumn",eC:"Oriention",fC:"PDF417Columns",gC:"PDF417ErrorLevel",hC:"PDF417Rows",iC:"PDF417Simple",jC:"PaddingBottom",kC:"PaddingLeft",lC:"PaddingRight",mC:"PaddingTop",nC:"PageColumnCount",oC:"PageColumnDirection",pC:"PageColumnGroupNA",qC:"PageColumnSpacing",rC:"PageDivideCount",sC:"PageDivideLine",tC:"PageDivideSpacing",uC:"PageEndScript",vC:"PageGroup",wC:"PageProcessRecordScript",xC:"PageStartScript",yC:"ParagraphSpacing",zC:"Parameter",AD:"ParentPageSettings",BD:"PenColor",CD:"PenStyle",DD:"PenWidth",ED:"PercentFormat",FD:"Picture",GD:"Pitch",HD:"PointWeight",ID:"PrintAdaptFitText",JD:"PrintAdaptMethod",KD:"PrintAdaptRFCStep",LD:"PrintAdaptRepeat",MD:"PrintAdaptTryToOnePage",ND:"PrintAsDesignPaper",OD:"PrintAtBottom",PD:"PrintBeginScript",QD:"PrintEndScript",RD:"PrintGridBorder",SD:"PrintOffsetSaveToLocal",TD:"PrintOffsetX",UD:"PrintOffsetY",VD:"PrintPageScript",WD:"PrintRotation",XD:"PrintToStretch",YD:"PrintType",ZD:"PrinterName",aD:"ProcessBeginScript",bD:"ProcessEndScript",cD:"ProcessRecordScript",dD:"QRCodeErrorLevel",eD:"QRCodeMask",fD:"QRCodeVersion",gD:"QuerySQL",hD:"RTF",iD:"RTrimBlankChars",jD:"RankNo",kD:"RegisterNo",lD:"RelationFields",mD:"RepeatOnPage",nD:"RepeatStyle",oD:"ReportFile",pD:"ResetPageNumber",qD:"RightMargin",rD:"RotateMode",sD:"RowCount",tD:"RowLineColor",uD:"RowLineWidth",vD:"RowSelection",wD:"RowSpan",xD:"RowsIncludeGroup",yD:"RowsPerPage",zD:"SameAsColumn",AE:"ScriptType",BE:"SelectionBackColor",CE:"SelectionForeColor",DE:"SeriesAuto",EE:"SeriesCount",FE:"SeriesCursor",GE:"SeriesField",HE:"SeriesLabel",IE:"SeriesName",JE:"Shadow",KE:"ShadowColor",LE:"ShadowWidth",ME:"ShapeType",NE:"SharePrintSetupOptions",OE:"ShiftMode",PE:"ShowColLine",QE:"ShowGrid",RE:"ShowMoneyDigit",SE:"ShowMoneyLabel",TE:"ShowMoneyLine",UE:"ShowMoneyLineColor",VE:"ShowMoneySepLineColor",WE:"ShowMoneyWidth",XE:"ShowPreviewWndScript",YE:"ShowRowLine",ZE:"ShrinkFontToFit",aE:"SingleSeriesColored",bE:"Size",cE:"SizeMode",dE:"SkipQuery",eE:"SortAsc",fE:"SortCaseSensitive",gE:"SortFields",hE:"SortSummaryBox",iE:"Space",jE:"SpanToNewPage",kE:"Strikethrough",lE:"Style",mE:"Styles",nE:"SubtotalCols",oE:"SummaryFun",pE:"SystemVar",qE:"Tag",rE:"Text",sE:"TextAlign",tE:"TextAngle",uE:"TextFormat",vE:"TextOrientation",wE:"TextVisible",xE:"Title",yE:"TitleRepeat",zE:"TitleRows",AF:"ToNewExcelSheet",BF:"TooltipText",CF:"Top",DF:"TopMargin",EF:"TotalCols",FF:"TotalExcludeColumns",GF:"TotalHPercentColumns",HF:"TotalVPercentColumns",IF:"Transparent",JF:"TransparentMode",KF:"TrueText",LF:"Type",MF:"U2D",NF:"Underline",OF:"Unit",PF:"VAlign",QF:"VCrossFields",RF:"VPercentColumns",SF:"VResort",TF:"VSortAsc",UF:"Value",VF:"ValueAsPercent",WF:"ValueFormat",XF:"ValueVisible",YF:"Version",ZF:"Visible",aF:"Watermark",bF:"WatermarkAlignment",cF:"WatermarkSizeMode",dF:"Weight",eF:"Width",fF:"WordWrap",gF:"XAxisLabel",hF:"XAxisMaximum",iF:"XAxisMinimum",jF:"XAxisSpace",kF:"XAxisTextAngle",lF:"XAxisTextFormat",mF:"XAxisTextVisible",nF:"XAxisVisible",oF:"XValueField",pF:"XmlTableName",qF:"YAxisLabel",rF:"YAxisMaximum",sF:"YAxisMinimum",tF:"YAxisSpace",uF:"YAxisTextFormat",vF:"YAxisTextVisible",wF:"YAxisVisible",xF:"YValueField",yF:"ZValueField",zF:"ZValueFormat"},wrPropNameEncode:function(e){var t=gr.wr.propNameMap[e];return t||e},wrPropNameDecode:function(e){var t=gr.wr.propNameMap_R[e];return t||e},decodeWR:function(e){function t(e){return e>=" "&&"~">=e&&(e=d[e.charCodeAt(0)-32]),e}for(var r,o,n,a,i,l="",s=4,u=e.length,c=gr.wr,d=c.WRAsciiMap_R,p=c.WRZipSource,h=c.WRZipDest,f=[];u>s;)l+=t(e[s++]);for(s=0,u=0,a=l[s];"["==a;){for(i={},r=++s;","!=a&&(a=l[++s],!("0">a||a>"9")););if(","!=a)break;for(i.f=+l.substring(r,s),r=++s;"]"!=a&&(a=l[++s],!("0">a||a>"9")););if("]"!=a)break;i.s=+l.substring(r,s++),f.push(i),u=s,a=l[s]}for(e=l.substr(u).split(""),i=f.length;i-- >0;)o=f[i].f,n=f[i].s,a=e[o],e[o]=e[n],e[n]=a;for(u=e.length,l="",s=0;u>s;s++)a=e[s],i=h.indexOf(a),i>=0?l+=p[i]:("#"==a&&(a=e[++s]),l+=a);return l}}}(),function(e){"use strict";var t=(gr.enum_,gr.const_),r=gr.common,o=gr.locale,n=gr.helper,a=r.DateTime,i=n.intFixed,l=n.confirmDateValue,s=n.confirmBooleanValue,u=n.rgba2color,c=n.color2rgba,d=n.decodeTextColor,p=gr.format={};p.BooleanFormatter=function(e){this.parse(e)},p.BooleanFormatter.prototype={parse:function(e){var t,r=this;e?(t=e.indexOf(":"),-1===t?(r.trueValueText=e,r.falseValueText=""):(r.trueValueText=e.substr(0,t),r.falseValueText=e.substr(t+1))):(r.trueValueText="true",r.falseValueText="false")},format:function(e){var t=this;return e=s(e),e?t.trueValueText:t.falseValueText}};var h=function(){this.defaultMe()};h.prototype={defaultMe:function(){var e=this;e.precision=9,e.leastPrecision=0,e.leastIntegerWidth=1,e.showPositive=!1,e.showNegative=!0,e.showSymbolAtHead=!0,e.negativeBracket=!1,e.intSepStep=0,e.asPercent=!1,e.asCurrency=!1,e.blankSepSymbol=!1,e.firstCurrencySymbol=!0,e.exponent=!1,e.textColor=0,e.prefix="",e.suffix=""},isCustomTextColor:function(){return 0!==this.textColor},parse:function(e){function t(e){return-1!=="0#.,+-()$%".indexOf(e)}var r,o,n,a,i,l=this;if(l.defaultMe(),e){if(r=d(e),r&&(e=e.substr(r.index),l.textColor=r.color),i=e.length,l.exponent="e"===e.charAt(0),!l.exponent){for(o=0;i>o&&!t(e.charAt(o));)++o;if(o>0&&(l.prefix=e.substr(0,o),e=e.substr(o),i=e.length),i>o){for(o=i-1;!t(e.charAt(o))&&o>0;)--o;i-1>o&&(l.suffix=e.substr(o+1),e=e.substr(0,o+1),i=e.length)}}for(a=e.indexOf("."),-1===a&&(a=i),o=e.indexOf(","),o>=0&&(l.intSepStep=a-o-1,l.intSepStep<0&&(l.intSepStep=3)),l.negativeBracket=e.indexOf("(")>=0&&e.indexOf(")")>=0,l.asPercent=e.indexOf("%")>=0,l.blankSepSymbol=e.indexOf(" ")>=0,o=e.indexOf("+"),l.showPositive=o>=0,n=e.indexOf("-"),l.showNegative=n>=0||!l.negativeBracket&&!l.isCustomTextColor(),n>o&&(o=n),n=e.indexOf("$"),l.asCurrency=n>=0,n>o&&(o=n),l.showSymbolAtHead=-1===o||a>o,l.asCurrency&&(l.negativeBracket?(o=e.indexOf(l.showSymbolAtHead?"(":")"),l.firstCurrencySymbol=o>n):l.firstCurrencySymbol=o>=n),l.leastIntegerWidth=0,o=0;a>o;++o)"0"===e.charAt(o)&&++l.leastIntegerWidth;for(l.leastPrecision=0,l.precision=0,o=a+1;i>o;++o)"0"===e.charAt(o)?(++l.leastPrecision,++l.precision):"#"===e.charAt(o)&&++l.precision}},format:function(e){var t,r,n,a,i,l,s,u,d,p,h,f=this,g="";if(e=+e,f.isCustomTextColor()&&(t=c(f.textColor),g="[_color#=rgb("+t.r+","+t.g+","+t.b+")]"),f.asPercent&&(e*=100),f.exponent){if(r=e,0>r&&(r=-r),n=0,0!==r){for(;r>=10;)r/=10,++n;for(;1>r;)r*=10,--n}return f.exponent=!1,0>e&&(r=-r),g+=f.format(r),g+="e",n>=0?g+="+":(g+="-",n=-n),g+=n,f.exponent=!0,g}if(h=e.toFixed(f.precision),p=h.length,f.precision>f.leastPrecision){for(a=p-1,i=a-f.precision+f.leastPrecision;a>i&&"0"===h.charAt(a);a--);"."!==h.charAt(a)&&a++,a<h.length&&(h=h.substr(0,a),p=a)}if(l=h.indexOf("."),0>l&&(l=p),g+=f.prefix,f.showSymbolAtHead?(f.asCurrency&&f.firstCurrencySymbol&&(g+=o.currencySymbol),0>e?f.negativeBracket&&(g+="("):f.showPositive&&e>0&&(g+="+"),f.asCurrency&&!f.firstCurrencySymbol&&(g+=o.currencySymbol),f.blankSepSymbol&&(g+=" ")):f.negativeBracket&&0>e&&(g+="("),a=0,s=l,0>e&&(--s,++a,f.showNegative&&(g+="-")),u=f.leastIntegerWidth-s,d=s,u>0)for(d+=u;d>s;)g+="0",d--,f.intSepStep>0&&d%f.intSepStep===0&&(g+=o.thousandSep);else for(;u++<0&&"0"===h.charAt(a);)a++;if(f.intSepStep>0)for(;d>0;)g+=h.charAt(a++),--d%f.intSepStep===0&&0!==d&&(g+=o.thousandSep);else g+=h.substring(a,l);return p>l&&(g+=h.substr(l)),f.showSymbolAtHead?f.negativeBracket&&0>e&&(g+=")"):(f.blankSepSymbol&&(g+=" "),f.asCurrency&&f.firstCurrencySymbol&&(g+=o.currencySymbol),0>e?g+=f.negativeBracket?")":"-":f.showPositive&&e>0&&(g+="+"),f.asCurrency&&!f.firstCurrencySymbol&&(g+=o.currencySymbol)),f.asPercent&&(g+="%"),g+f.suffix}};var f=function(e){e=e.substring(1,e.length-1);for(var t=e.split(","),r=0;r<t.length;r++){var o=t[r],n=o.indexOf("=");this[o.substr(0,n)]=o.substr(n+1)}};f.prototype={format:function(t){var r=this[t];return r===e&&(r=""),r}};var g="$$",m="$$$";p.NumericFormatter=function(e){this.parse(e)},p.NumericFormatter.prototype={defaultMe:function(){var t=this;t.formatType=0,t.positiveAnalyser=new h,t.negativeAnalyser&&(t.negativeAnalyser=e),t.zeroAnalyser&&(t.zeroAnalyser=e),t.intEnumAnalyser&&(t.intEnumAnalyser=e)},parse:function(e){function t(e){var t,r;t=e.split(";"),r=t.length,o.positiveAnalyser.parse(t[0]),r>1&&""!==t[1]&&(o.negativeAnalyser=new h,o.negativeAnalyser.parse(t[1])),r>2&&""!==t[2]&&(o.zeroAnalyser=new h,o.zeroAnalyser.parse(t[2]))}var r,o=this;if(o.defaultMe(),e){var n=e.length;e&&(r=e.indexOf(m),-1!==r?(o.formatType=1,e=e.substr(0,r)+e.substr(r+m.length),""!==e&&t(e)):n>=2&&e.substr(0,2)===g?2===n?o.formatType=2:(o.formatType=3,t(e.substr(2))):"{"===e.charAt(0)&&"}"===e.charAt(n-1)?(o.formatType=4,o.intEnumAnalyser=new f(e)):t(e))}},format:function(r){function o(e,r){var o,n,a=!1,i=!1,l=0,s="";for(o=r-1;o>=0;o--,l++)n=parseInt(e.charAt(o)),l%4===0&&l>0&&(a=!0),0===n?i=!0:(i&&(""!==s&&(s=t.BIG_AMT_NUMBER.charAt(0)+s),i=!1),l>0&&(a&&l%4!==0&&(s=t.HZ_AMT_STEP.charAt(l-l%4)+s),a=!1,s=t.HZ_AMT_STEP.charAt(l)+s),s=t.BIG_AMT_NUMBER.charAt(n)+s);return s}function n(e){var r,o,n="",a=e.length;for(o=0;a>o;o++)r=parseInt(e.charAt(o)),isNaN(r)||(n+=t.BIG_AMT_NUMBER.charAt(r));return n}function a(e){var r,n,a,i,l,s=0>=e;return e>-.005&&.005>e?t.HZ_ZERO_YUAN:(s&&(e=-e),i=e.toFixed(2),r=i.indexOf("."),l=o(i,r),""!==l&&(l+=t.HZ_AMT_STEP.charAt(0)),n=parseInt(i.charAt(r+1)),a=parseInt(i.charAt(r+2)),0===n&&0===a?l+=t.HZ_AMT_UNIT[0]:(0===n&&""===l||(l+=t.BIG_AMT_NUMBER.charAt(n)),0!==n&&(l+=t.HZ_AMT_UNIT.charAt(1)),0!==a?(l+=t.BIG_AMT_NUMBER.charAt(a),l+=t.HZ_AMT_UNIT.charAt(2)):l+=t.HZ_AMT_UNIT.charAt(0)),s&&(l=t.HZ_NEGATIVE+l),l)}function i(e,r){var n,a,i,l,s=Math.max(0,r.precision),u=Math.min(s,r.leastPrecision),c=-.5*Math.pow(.1,s),d=c>=e;for(0>e&&(e=-e),i=e.toFixed(s),n=i.length,a=i.indexOf("."),-1===a&&(a=n),l=o(i,a),""===l&&(l=t.BIG_AMT_NUMBER.charAt(0)),n--;n>a+u&&"0"===i.charAt(n);n--);if(n>a)for(l+="点",a++;n>=a;a++)l+=t.BIG_AMT_NUMBER.charAt(parseInt(i.charAt(a)));return d&&(l=t.HZ_NEGATIVE+l),""!==r.prefix&&(l=r.prefix+l),""!==r.suffix&&(l+=r.suffix),l}var l,s=this;if(r=+r,isNaN(r))l="";else if(s.formatType<=1){if(s.zeroAnalyser&&r>-.5&&.5>r){var u=s.positiveAnalyser.precision;s.positiveAnalyser.asPercent&&(u+=2);var c=u;s.negativeAnalyser&&(c=s.negativeAnalyser.precision,s.negativeAnalyser.asPercent&&(c+=2));var d=-.5*Math.pow(.1,c),p=.5*Math.pow(.1,u);r>d&&p>r&&(l=s.zeroAnalyser.format(0))}l===e&&(l=s.negativeAnalyser&&0>r?s.negativeAnalyser.format(r):s.positiveAnalyser.format(r)),1===s.formatType&&(l=n(l))}else l=4===s.formatType?s.intEnumAnalyser.format(r):2===s.formatType?a(r):i(r,s.positiveAnalyser);return l}},p.DateTimeFormatter=function(e){this.parse(e)},p.DateTimeFormatter.prototype={parse:function(r){function n(){for(S=1;D[y+1]===F;)y++,S++}function a(){var e=S;S%=2,e=(e-S)/2,e>0&&l(e)}function l(e){var t="",r=A.length;do{t+=F}while(--e>0);r>0&&15===A[r-1].type?A[r-1].data+=t:A.push({type:15,data:t,funDisplayText:v})}function s(e,t){return i(e.getFullYear(),t.subtype)}function u(r,n){var a=r.getMonth();return n.subtype<=4?i(a+1,n.subtype):o.supportIntl?5===n.subtype?new Intl.DateTimeFormat(e,{month:"short"}).format(r):new Intl.DateTimeFormat(e,{month:"long"}).format(r):10>a?t.HZ_NUMBER.charAt(a):t.HZ_NUMBER.charAt(9)+t.HZ_NUMBER.charAt(a-10)+t.HZ_DATETIME_UNIT.charAt(5)}function c(e,t){return i(e.getDate(),t.subtype)}function d(r,n){var a;return o.supportIntl?5===n.subtype?new Intl.DateTimeFormat(e,{weekday:"short"}).format(r):new Intl.DateTimeFormat(e,{weekday:"long"}).format(r):(a=r.getDay(),(5===n.subtype?t.HZ_DATETIME_UNIT.substr(0,1):t.HZ_DATETIME_UNIT.substring(2,4))+(a>0?t.HZ_NUMBER.charAt(a-1):t.HZ_DATETIME_UNIT.charAt(1)))}function p(e,t){var r=e.getHours()%12;return r||(r=12),i(r,t.subtype)}function h(e,t){return i(e.getHours(),t.subtype)}function f(e,t){return i(e.getMinutes(),t.subtype)}function g(e,t){return i(e.getSeconds(),t.subtype)}function m(e,t){return e.toLocaleDateString()}function _(e,t){return e.toLocaleTimeString()}function C(e,t){return e.toLocaleString()}function v(e,t){return t.data}function T(e,t){return e.getHours()<12?o.textAM:o.textPM}function x(e,t){return o.dateSep}function b(e,t){return o.timeSep}var w,y,S,D,F,P,E,A=this.items=[];if(r){D=r.split(""),w=D.length,y=0;do{switch(F=D[y],n(),E={},F){case"d":3>S?(E.type=3,E.funDisplayText=c,E.subtype=1===S?0:2):(E.type=4,E.funDisplayText=d,E.subtype=3===S?5:6);break;case"M":E.type=2,E.funDisplayText=u,E.subtype=1===S?0:2===S?2:3===S?5:6;break;case"y":E.type=1,E.funDisplayText=s,E.subtype=3>S?2:0;break;case"h":E.type=5,E.funDisplayText=p,E.subtype=1===S?0:2;break;case"H":E.type=6,E.funDisplayText=h,E.subtype=1===S?0:2;break;case"m":E.type=7,E.funDisplayText=f,E.subtype=1===S?0:2;break;case"s":E.type=8,E.funDisplayText=g,E.subtype=1===S?0:2;break;case"t":2===S&&(E.type=20,E.funDisplayText=T);break;case"%":a(),S&&(P=D[y+1],++y,"d"===P?(E.type=10,E.funDisplayText=m):"t"===P?(E.type=11,E.funDisplayText=_):"g"===P?(E.type=12,E.funDisplayText=C):y--);break;case":":a(),S&&(E.type=22,E.funDisplayText=b);break;case"/":a(),S&&(E.type=21,E.funDisplayText=x);break;default:l(S)}E.type&&15!==E.type&&A.push(E)}while(++y<w)}else A.push({type:12,funDisplayText:C})},format:function(t){var r="";return t!==e&&(t=l(t),this.items.forEach((function(e){r+=e.funDisplayText(t,e)}))),r}};var _=gr.utility={CreateDateTime:function(){return new a},DateTimeFormat:function(e,t){return new p.DateTimeFormatter(t).format(l(e))},NumberFormat:function(e,t){return new p.NumericFormatter(t).format(e)},NumberFormatToBigHZ:function(e,t){var r,o="$$0";if(t>0)for(o+=".",r=0;t>r;r++)o+="0";return _.NumberFormat(e,o)},NumberFormatToBigHZAmount:function(e){return _.NumberFormat(e,"$$")},NumberRound45:function(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r},NumberRound465:function(e,t){var r,o,n,a=Math.pow(10,t+2);return e=Math.floor(e*a),r=e%10,o=e%100-r,e-=o+r,o>=60?e+=100:50===o&&(r>0?e+=100:(n=e%1e3/100,n%2&&(e+=100))),e/a},ColorFromRGB:function(t,r,o,n){return n===e&&(n=1),u(t,r,o,n)}}}(),function(e){"use strict";var t=gr.enum_,r=gr.helper,o=gr.format,n=gr.utility,a=r.ensureNameText,i=r.enumName2Value,l=r.enumValue2Name,s=r.prototypeCopyExtend,u=(o.BooleanFormatter,o.DateTimeFormatter),c=o.NumericFormatter,d=gr.exp={},p="[#",h="#]",f=2,g=function(e){for(var t,r,o=e.length,n=0,a=0,i=0,l=[];o>n;)t=e[n],i?")"===t?i--:"("===t&&i++:","===t?(r=e.substring(a,n),r&&l.push(r),a=n+1):"("===t&&++i,++n;return r=e.substring(a,n),r&&l.push(r),l},m=d.Summary=function(){};m.prototype={init:function(e,t){var r=this;e&&(r.paramExp=new S(r.report,e)),t&&(r.displayField=r.report.RunningFieldByName(t))},getAsFloat:function(){var e=this;return e.valueField?e.valueField.AsFloat:e.value},getValue:function(){return this.getAsFloat()},setValue:function(e){var t=this;t.valueField?t.valueField.AsFloat=e:t.value=e},isDateTimeValue:function(){var e=this;return e.argExp&&e.argExp.isSingleVariable()&&e.argExp.varItems[0].varField.isDateTimeValue()},beginSummaryValue:function(){var t=this,r=t.SummaryFun;t.recordCount=0,4===r||5===r?t.value=e:27!==r&&28!==r&&(t.value=0),t.values=[]},summaryCurRecord:function(){var t=this,r=t.values,o=t.SummaryFun,n=t.paramExp,a=n?n.calculate():0;switch(++t.recordCount,o){case 1:case 2:case 27:case 28:isNaN(a)||(t.value+=a);break;case 4:case 5:n&&!n.isNull()&&(t.value===e?t.value=a:(5===o&&t.value<a||4===o&&t.value>a)&&(t.value=a,t.displayField&&(t.stringValue=t.displayField.DisplayText)));break;case 6:case 7:case 8:case 9:case 10:case 11:r.push_back(a);break;case 12:case 13:n&&n.isNull()&&(t.value+=1);break;case 16:case 17:case 15:case 20:case 21:case 22:case 23:case 24:case 25:n&&!n.isNull()&&r.push(a);break;case 14:n&&r.push(n.getTextForDistinct());break;case 19:case 18:n&&(a=n.getTextForDistinct(),(0===t.value||19===o&&t.value.localeCompare(a)<0||18===o&&t.value.localeCompare(a)>0)&&(t.value=a));break;case 26:t.value+=Math.abs(t.Calculate())}},endSummaryValue:function(){var t=this,r=t.values?t.values.length:0;switch(t.SummaryFun){case 2:t.recordCount>0?t.value/=t.recordCount:t.value=e;break;case 3:t.value=t.recordCount;break;case 6:case 20:t.value=r>1?t.devSq()/(r-1):e;break;case 7:case 21:t.value=r>1?t.devSq()/r:e;break;case 8:case 22:t.value=r>1?Math.sqrt(t.devSq()/(r-1)):e;break;case 9:case 23:t.value=r>1?Math.sqrt(t.devSq()/r):e;break;case 10:case 24:t.value=t.aveDev();break;case 11:case 25:t.value=t.devSq();break;case 16:case 17:if(t.values.sort((function(e,t){return e-t})),r<t.rankNo)return e;t.value=t.values[17===t.SummaryFun?r-t.rankNo:t.rankNo];break;case 13:t.value=t.recordCount-t.value;break;case 15:t.value=t.average();break;case 14:t.value=t.distinct()}},average:function(){var t=this,r=t.values.length,o=0;return t.values.forEach((function(e){o+=e})),r?o/r:e},aveDev:function(){var t=this,r=t.values.length,o=average(),n=0;return t.values.forEach((function(e){n+=Math.abs(e-o)})),r?n/r:e},devSq:function(){var e=average(),t=0;return this.values.forEach((function(r){var o=r-e;t+=o*o})),t},distinct:function(){var e,t,r=this,o=1,n=r.values.length,a=n;for(r.values.sort((function(e,t){return e.localeCompare(t)})),e=r.values[0];n>o;)t=r.values[o++],e===t?a--:e=t;return a}};var _=function(e,t,r){var o,n=this,a=g(r),i="";n.report=e,n.SummaryFun=t,a.length>0&&(o=a[0]),a.length>1&&(n.rankNo=parseInt(a[1])),n.init(o),n.paramExp&&(a=n.paramExp.varItems,1===a.length&&(i=a[0].varField.object.Format)),n.formater=new c(i)};_.prototype={type:4,getDisplayText:function(){var e=this;return e.formater.format(e.getAsFloat())},getExpText:function(){var e=this;return l(t.SummaryFun,e.SummaryFun)+"("+e.paramExp?e.paramExp.getExpText():""+e.RankNo?","+e.RankNo:")"}},s(_,m);var C=function(e,t,r){var o=this,n=g(r);o.report=e,o.MathFun=t,o.paramExps=[],n.forEach((function(t){o.paramExps.push(new S(e,t))}))};C.prototype={type:5,getAsFloat:function(){var e,r,o=this,a=o.MathFun,i=o.paramExps,s=i.length,u=1===s,c=0;if(1===a||2===a||22===a||9===a?u=2==s:20!==a&&21!==a||(u=s>1),!u)return alert("表达式中函数 '"+l(t.MathFun,a)+"' 的参数未正确提供。"),NaN;switch(e=i[0].calculate(),r=2===s?i[1].calculate():0,a){case 1:c=n.NumberRound45(e,r);break;case 2:c=n.NumberRound465(e,r);break;case 5:c=Math.abs(e);break;case 6:c=Math.acos(e);break;case 7:c=Math.asin(e);break;case 8:c=Math.atan(e);break;case 9:c=Math.atan2(e,r);break;case 15:c=Math.ceil(e);break;case 16:c=Math.cos(e);break;case 17:c=Math.exp(e);break;case 18:c=Math.floor(e);break;case 19:c=Math.log(e);break;case 20:if(c=e,s>1&&(r>e&&(c=r),s>2))for(;s-- >2;)e=i[s].calculate(),e>c&&(c=e);break;case 21:if(c=e,s>1&&(e>r&&(c=r),s>2))for(;s-- >2;)e=i[s].calculate(),c>e&&(c=e);break;case 22:c=Math.pow(e,r);break;case 23:c=Math.round(e);break;case 24:c=Math.sin(e);break;case 25:c=Math.sqrt(e);break;case 26:c=Math.tan(e)}return c},getValue:function(){var e=this,t=e.valueField;return t?t.AsFloat:e.getAsFloat()},getDisplayText:function(){var e=this,t=e.valueField;return t?t.DisplayText:e.getAsFloat()+""},getExpText:function(){for(var e=this,r=e.paramExps,o=r.length,n=0,a=l(t.MathFun,e.MathFun)+"(";o>n;)n>0&&(a+=","),a+=r[n].getExpText();return a+")"},isDateTimeValue:function(){return 0}};var v=function(e,r){var o=this,n=r.split(",");o["var"]=i(t.SystemVarType,n[0]),n.length>1&&(o.groupIndex=parseInt(n[1])),o.report=e};v.prototype={type:3,getAsFloat:function(){var e=this;return e.report.SystemVarValue2(e["var"],e.groupIndex)},getValue:function(){return this.getAsFloat()},getDisplayText:function(){var e=this;return e["var"]>0?e.getAsFloat()+"":""},getExpText:function(){var e=this;return"SystemVar("+l(t.SystemVarType,e["var"])+e.groupIndex?","+e.groupIndex:0},isDateTimeValue:function(){return 1===this["var"]}};var T=function(e){this.oParameter=e};T.prototype={type:2,getAsFloat:function(){return this.oParameter.AsFloat},getValue:function(){return this.oParameter.Value},getDisplayText:function(){var e=this;return e.valueField?e.valueField.DisplayText:e.oParameter.DisplayText},getExpText:function(){return a(this.oParameter.Name)},isDateTimeValue:function(){return 6===this.oParameter.DataType}};var x=function(e){this.object=e};x.prototype={type:1,getAsFloat:function(){return this.object.AsFloat},getValue:function(){return this.object.Value},getDisplayText:function(){return this.object.DisplayText},getExpText:function(){return a(this.object.Name)},isDateTimeValue:function(){return 6===this.object.FieldType}};var b=function(e){this.object=e};b.prototype={type:6,getAsFloat:function(){return parseFloat(this.object.DisplayText)},getValue:function(){return this.getDisplayText()},getDisplayText:function(){return this.object.DisplayText},getExpText:function(){return a(this.object.Name)},isDateTimeValue:function(){return 0}};var w=function(e,t,r){var o=this;o.varField=e,o.beginIndex=t,o.endIndex=r},y=function(e,t){function r(){for(u=c[n];_.test(u);)u=c[++n]}function o(e,r){var o=u===e;return o&&(n=t.indexOf(r,a),-1===n?m=!1:(d=t.substring(a+1,n),i=++n)),o}var n,a,i,l,s,u,c,d,p,h,f,g=this,m=!0,_=/\s/,C=/[\d.]/,v=/[()+-\/%*]/,T=/[()+-\/%*\s]/;for(c=t.split(""),s=c.length,g.expText=t,g.varItems=[],n=0;s>n&&m;)if(r(),v.test(u)||C.test(u))n++;else{if(a=n,o("{","}"))h=g.decodeVariable(e,d,1);else{if(!o("[","]")){for(;s>n&&!T.test(c[n]);)n++;if(i=n,d=t.substring(a,i),!d)continue}if(r(),"("===u){for(l=++n,f=1;s>n;)if(u=c[n++],")"===u){if(f--,0>=f)break}else"("===u&&f++;p=t.substring(l,n-1),i=n,h=g.decodeFunction(e,d,p)}else h=g.decodeVariable(e,d,0)}h?g.varItems.push(new w(h,a,i)):m=!1}g.valid=m};y.prototype={calculate:function(){var e=this,t=0,r="",o=NaN;return e.valid&&(e.varItems.forEach((function(o){t<o.beginIndex&&(r+=e.expText.substring(t,o.beginIndex)),t=o.endIndex,r+=o.varField.getAsFloat()+""})),r+=e.expText.substr(t),o=gr.script.calcExp(r),(o>=Number.POSITIVE_INFINITY||o<=Number.NEGATIVE_INFINITY)&&(o=NaN)),o},isSingleVariable:function(){var e=this;return 1===e.varItems.length&&0===e.varItems[0].beginIndex&&e.varItems[0].endIndex===e.expText.length}};var S=function(e,t){y.call(this,e,t)};S.prototype={decodeVariable:function(t,r,o){var n,a=e;return o?(n=t.ParameterByName(r))&&(a=new T(n)):(n=t.RunningFieldByName(r))?a=new x(n):(n=t.ParameterByName(r))?a=new T(n):(n=t.ControlByName(r))&&(a=new b(n)),a},decodeFunction:function(e,r,o){var n,a=i(t.SummaryFun,r);return a>=0?n=new _(e,a,o):"SystemVar"===r?n=new v(e,o):(a=i(t.MathFun,r),a>=0&&(n=new C(e,a,o))),n},getExpText:function(){var e=this,t=0,r="";return e.varItems.forEach((function(o){t<o.beginIndex&&(r+=e.expText.substring(t,o.beginIndex)),t=o.endIndex,r+=o.varField.getExpText()})),r+=e.expText.substr(t)},getTextForDistinct:function(){var e=this;return e.isSingleVariable()?e.varItems[0].varField.getDisplayText():e.calculate()+""},isNull:function(){return this.varItems.some((function(e){return e.IsNull}))}},s(S,y);var D=function(e,t){var r,o,n,a=this,i=0,l="";for(r=t.indexOf(":");r>=0&&(o=t.indexOf("[",i),!(-1===o||o>r))&&(o=t.indexOf("]",r),-1!==o);)i=o+1,r=t.indexOf(":",i);r>=0&&(l=a.format=t.substr(r+1),t=t.substr(0,r)),y.call(a,e,t),!l&&a.isSingleVariable()||(n=a.isSingleVariable()&&a.varItems[0].varField.isDateTimeValue(),!n&&l&&(n=/[yMdthHms]/.test(l)&&!/[0#e$]/.test(l)),a.formater=n?new u(l):new c(l))};D.prototype={getDisplayText:function(){function e(e){return'"'+e.expText+'" 不是有效的运算表达式'}var t,r=this;return r.valid?r.formater?(t=r.isSingleVariable()?r.varItems[0].varField.getValue():r.calculate(),r.formater.format(t)):r.varItems[0].varField.getDisplayText():e(this)}},s(D,y);var F=function(e,t){D.call(this,e,t)};F.prototype={decodeVariable:S.prototype.decodeVariable,decodeFunction:S.prototype.decodeFunction,isPureNumeric:function(){var e=this;return c.prototype.isPrototypeOf(e.formater)||e.isSingleVariable()&&!e.varItems[0].varField.isDateTimeValue()}},s(F,D);var P=function(e){this.oParameter=e};P.prototype={getAsFloat:function(){return this.oParameter.AsFloat},getValue:function(){return this.oParameter.Value},getDisplayText:function(){return this.oParameter.DisplayText},isDateTimeValue:function(){return 6===this.oParameter.DataType}};var E=function(e,t){var r=this;r.textBuilder=e,r.varType=t};E.prototype={getAsFloat:function(){function e(){var e,t,r=n.graphs,o=r.length;for(e=0;o>e&&(t=r[e],!t.some((function(e){return e===a})));e++);return t}var t,r=this,o=r.textBuilder,n=o.chart,a=o.seriesIndex,i=o.groupIndex;if(n.IsScatterGraph())switch(t=n.Value(a,i),r.varType){case 1:t=t.x;break;case 2:t=t.y;break;case 3:t=t.z;break;case 5:t=t.z/n.GetSeriesTotalValue(a);break;case 7:t=n.GetSeriesTotalValue(a)}else switch(t=n.Value(a,i),r.varType){case 4:t/=n.GetGroupTotalValue(e(),i);break;case 6:t=n.GetGroupTotalValue(e(),i);break;case 5:t/=n.GetSeriesTotalValue(a);break;case 7:Val=n.GetSeriesTotalValue(a)}return t},getValue:function(){return this.getAsFloat()},getDisplayText:function(){var e=this,t=e.varType,r=e.textBuilder,o=r.seriesIndex,a=r.groupIndex,i=r.chart,l=i.IsScatterGraph(),s=i.graphSerieses[o],u=e.getAsFloat(),c=0;if(l)switch(t){case 1:c=1;break;case 2:c=2;break;case 3:case 7:c=3;break;case 5:c=5;break;case 8:c=4}else switch(t){case 1:case 8:case 9:c=4;break;case 2:case 6:case 7:c=2;break;case 4:case 5:c=5}switch(c){case 1:u=i.XAxis.ScaleFormatParser.format(u);case 2:u=l?i.YAxisOfSeries(s).ScaleFormatParser.format(u):s.ValueFormatParser.format(u);break;case 3:u=s.ValueFormatParser.format(u);break;case 4:u=8===t?i.SeriesLabel(o):i.GroupLabel(a);break;case 5:u=n.NumberFormat(u,"0.00%")}return u},isDateTimeValue:function(){return 0}};var A=function(e,t){D.call(this,e,t)};A.prototype={decodeVariable:function(t,r,o){var n=t.chart.report.ParameterByName(r);return n?new P(n):e},decodeFunction:function(e,r,o){var n;return"chartvar"===r.toLowerCase()&&(o=i(t.ChartVarType,o),o>0&&(n=new E(e,o))),n}},s(A,D);var R=function(e){this.text=e};R.prototype={getDisplayText:function(){return this.text}};var B=d.TextBuilder=function(e,t){var r,o=this,n=e.XAxis?A:F,a=0,i=0,l=0;for(o.items=[],e.XAxis&&(o.chart=e,e=this);(i=t.indexOf(p,l))>=0;)l=t.indexOf(h,i+f),l>=0&&(r=new n(e,t.substring(i+f,l)),l+=f,r.valid&&(i>a&&o.items.push(new R(t.substring(a,i))),a=l,o.items.push(r)),i=l);a<t.length&&o.items.push(new R(t.substr(a)))};B.prototype={forEach:function(e){this.items.forEach(e)},generateDisplayText:function(){for(var e,t,r,o,n,a=this,i=a.items,l=0,s=i.length,u="";s>l;){if(e=i[l++],t=e.varItems)for(n=t.length,o=0;n>o;++o)if(r=t[o].varField,3===r.type&&r["var"]<0)return"";u+=e.getDisplayText()}return u},generateChartDisplayText:function(e,t){var r=this;return r.seriesIndex=e,r.groupIndex=t,r.generateDisplayText()},isStaticText:function(){var e=this;return 1==e.items.length&&R.prototype.isPrototypeOf(e.items[0])}}}(),function(e){"use strict";function t(e){switch(e){case 2:return lt;case 15:return st;case 3:return ut;case 13:return ct;case 4:return dt;case 5:return pt}return""}function r(e,t,r){return new m(e-r,t-r,e+r,t+r)}gr.dom={};var n=gr.enum_,a=gr.const_,i=gr.common,l=gr.helper,s=gr.format,u=gr.exp,c=s.BooleanFormatter,d=s.DateTimeFormatter,p=s.NumericFormatter,h=u.Summary,f=u.TextBuilder,g=i.DateTime,m=i.Rect,_=i.Pen,C=i.Border,v=i.Font,T=i.FontWrapper,x=i.TextFormat,b=i.Context,w=i.Graphics,y=i.HtmlStyles,S=i.HtmlElement,D=l.assignJSONMembers,F=l.enumMemberValid,P=l.enumBitMemberValid,E=l.colorMemberValid,A=l.fontString,R=l.fontHeight,B=l.intFixed,M=l.pixelsToHtml,k=l.percentToHtml,N=l.cloneDate,L=l.confirmDateValue,I=l.confirmCloneDateValue,O=l.strimDate,V=l.incDate,G=(l.incDate2,l.confirmBooleanValue),H=l.ensureNameText,W=l.enumName2Value,U=l.enumValue2Name,j=l.rgba2color,q=l.colorAlpha,z=l.color2rgba,Y=l.colorGradientLight,J=l.colorGradientDark,K=l.prototypeLinkExtend,X=l.prototypeCopyExtend,Z=l.createArray,Q=l.assignObjectEx,$=l.assignObject,ee=l.assignObjectAtom,te=l.parseXML,re=l.getRelativePosition,oe=l.addEvent,ne=l.bindEvents,ae=gr.wr?gr.wr.wrPropNameEncode:e,ie=l.toDegree,le=l.toRadians,se=function(){var e=0;return function(){return"-gr-canvas-"+e++}}(),ue=function(e){var t=0,r=0;e.length&&(e.forEach((function(e){t+=e.pxHeight})),e.forEach((function(e){e.pctHeight=Math.round(100*e.pxHeight/t),r+=e.pctHeight})),e[0].pctHeight+=100-r)},ce=function(e){var t=this;t.owner=e,t.items=[]};ce.prototype={loadFromJSON:function(e){var t,r=0;if(e)for(t=e.length;t>r;)this._doloadItem(e[r++])},getJsonMember:function(e){return this.owner.report.isWR?ae(e):e},assign:function(e){var t=this;t.RemoveAll(),e.forEach((function(e){t.Add().assign(e)}))},attachData:function(){for(var e=this.items,t=e.length;t--;)e[t].attachData()},prepare:function(){for(var e=this.items,t=0,r=e.length;r>t;)e[t++].prepare()},unprepare:function(){for(var e=this.items,t=e.length;t--;)e[t].unprepare()},generate:function(e){for(var t=this.items,r=0,o=t.length;o>r;)t[r++].generate(e)},itemByName:function(t){var r,o=this.items,n=o.length;if(t)for(t=t.toUpperCase();n--;)if(r=o[n],r.Name.toUpperCase()===t)return r;return e},indexOfCOMIndex:function(e){return e?("number"!=typeof e&&(e=this.IndexByName(e||"")),--e):e=-1,e},indexOf:function(e){for(var t=this.items,r=t.length;r--;)if(e===t[r])return r;return-1},decodeItems:function(e){var t,r=this,o=[];return e&&(t=e.split(";"),t.forEach((function(e){var t;e=e.trim(),t=r.itemByName(e),t&&o.push(t)}))),o},forEach:function(e){this.items.forEach(e)},_doloadItem:function(e){this.Add().loadFromJSON(e)},get Count(){return this.items.length},Item:function(e){var t=this;return t.items[t.indexOfCOMIndex(e)]},Add:function(){var e=this,t=e._createItem();return e.items.push(t),t},Remove:function(e){var t=this;e=t.indexOfCOMIndex(e),e>=0&&t.items.splice(e,1)},RemoveAll:function(){this.items=[]},IndexByName:function(e){var t=this.items,r=t.length;if(e)for(;r--;)if(t[r].Name===e)return r+1;return-1},ItemAt:function(t){var r=this.items;return t--,t>=0&&t<r.length?r[t]:e},ChangeItemOrder:function(e,t){var r=this.items;if(o,len=r.length,t=Math.max(1,Math.min(len,t))-1,e!=t&&e>0&&e--<=len)if(o=r[e],t>e)do{r[e]=r[e+1]}while(++e<t);else{do{r[e]=r[e-1]}while(--e>t);r[t]=o}}};var de=function(e){ce.call(this,e)};de.prototype={_doloadItem:function(e){var t=this,r=t.Add(W(n.ControlType,e[t.getJsonMember("Type")]));r&&r.loadFromJSON(e)},assign:function(e){var t=this;t.RemoveAll(),e.forEach((function(e){t.Add(e.ControlType).assign(e)}))},layout:function(){for(var e=this,t=e.items,r=e.owner.getRect(),o=0,n=t.length;n>o;)t[o++].layout(r)},generate:function(e){for(var t,r=this.items,o=r.length;o--;)t=r[o],t.Visible&&t.generate(e)},Add:function(t){function r(t,r){var o=e;switch(t){case 1:o=new Pe(r);break;case 2:o=new Ne(r);break;case 10:o=new ke(r);break;case 3:o=new Be(r);break;case 4:o=new Ae(r);break;case 5:o=new Re(r);break;case 7:o=new Ie(r);break;case 8:o=new Ee(r);break;case 9:o=new Ve(r);break;case 11:o=new It(r);break;case 12:o=new Le(r);break;case 13:o=new We(r);break;case 6:o=new Oe(r)}return o}var o=this,n=r(t,o.owner);return n&&o.items.push(n),n}},K(de,ce);var pe=function(e){ce.call(this,e)};pe.prototype={_doloadItem:function(e){var t=this,r=new tt(t.owner);r.loadFromJSON(e),t.items.push(r)},addTo:function(e){var t,r,o=this,n=o.owner.ColumnContent.ContentCells,a=new tt(o.owner);return o.items.push(a),t=new Se(e,!1),e.items.push(t),a.TitleCell=t,t.Column=a,r=new ye(n),n.items.push(r),a.ContentCell=r,r.Column=a,a},Add:function(){var e=this;return e.addTo(e.owner.ColumnTitle.TitleCells)},Remove:function(e){function t(e,r){var o,n,a=e.indexOf(e);if(a>=0)return e.splice(a,1),1;for(a=e.length,n=0;a>n;n++)if(o=e[n],o.GroupTitle&&t(o.SubTitles.items,r))return 1;return 0}var r,o=this,n=o.owner,a=n.ColumnContent.ContentCells.items;e=o.indexOfCOMIndex(e),e>=0&&(r=o.items[e],a.splice(a.indexOf(r.ContentCell),1),t(n.ColumnTitle.TitleCells.items,r.TitleCell),o.items.splice(e,1))},RemoveAll:function(){var e=this,t=e.owner;e.items=[],t.ColumnContent.ContentCells.items=[],t.ColumnTitle.TitleCells.items=[]}},K(pe,ce);var he=function(e,t){var r=this;ce.call(r,e),r.supcell=t};he.prototype={_doloadItem:function(e){var t=this,r=new Se(t,e[t.getJsonMember("GroupTitle")]);r.loadFromJSON(e),t.items.push(r)},assign:function(e){var t=this;t.items=[],e.forEach((function(e){var r=new Se(t,e.GroupTitle);t.items.push(r),r.assign(e),e.GroupTitle&&r.SubTitles.assign(e.SubTitles)}))},AddGroup:function(e,t){var r=this,o=new Se(r,!0);return o.Name=e,o.Text=t,r.items.push(o),o},RemoveGroup:function(e){var t=this,r=t.Item(e);r&&r.GroupTitle&&(ce.prototype.Remove.call(t,e),t.items=t.items.concat(r.SubTitles.items))},Add:function(){},Remove:function(e){},RemoveAll:function(){}},K(he,ce);var fe=function(e){ce.call(this,e)};fe.prototype={_doloadItem:function(e){var t=this,r=new ye(t);r.loadFromJSON(e),t.items.push(r)},assign:function(e){var t=this;t.items=[],e.forEach((function(e){var r=new ye(t);t.items.push(r),r.assign(e)}))},Add:function(){},ChangeItemOrder:function(e,t){},Remove:function(e){},RemoveAll:function(){}},K(fe,ce);var ge=function(e){ce.call(this,e)};ge.prototype._createItem=function(){return new $e(this.owner)},K(ge,ce);var me=function(e){ce.call(this,e)};me.prototype={_createItem:function(){return new rt(this.owner)},_doloadItem:function(e){!e.PageGroup&&this.Add().loadFromJSON(e)}},K(me,ce);var _e=function(e){ce.call(this,e)};_e.prototype._createItem=function(){return new qe(this.owner)},K(_e,ce);var Ce=function(e){ce.call(this,e)};Ce.prototype._createItem=function(){return new ze(this.owner)},K(Ce,ce);var ve=function(e){ce.call(this,e)};ve.prototype._createItem=function(){return new nt(this.owner)},K(ve,ce);var Te=function(e){var t=this;t.owner=e,t.report=e.report,t.Tag=""};Te.prototype={afterLoad:function(e){},loadFromJSON:function(e){var t=this;e&&(D(t,e),t.afterLoad(e))},assign:function(e){var t,r,o=this,n=o.Font,a=e.onclick,i=e.ondblclick;for(var l in e)o.hasOwnProperty(l)&&(t=e[l],r=_typeof(t),"object"!==r&&"array"!==r&&(o[l]=t));n&&n.assign(e.Font),a&&(o.onclick=a),i&&(o.ondblclick=i),o.children&&o.children.forEach((function(t){var r=e[t];r&&(r.owner?o[t].assign(r):$(o[t],r))}))},registerEventClass:function(){var e=this,t=e.report.viewer._domevents,r=e.onclick,o=e.ondblclick;r&&!e.onclickClassID&&(t.push({obj:e,type:1,fun:r}),e.onclickClassID=t.length),o&&!e.ondblclickClassID&&(t.push({obj:e,type:2,fun:o}),e.ondblclickClassID=t.length)},resetEventClass:function(){var e=this;e.onclickClassID&&delete e.onclickClassID,e.ondblclickClassID&&delete e.ondblclickClassID},addElementEventClass:function(e){var t=this,r=t.report.viewer,o=t.onclickClassID,n=t.ondblclickClassID;o&&e.addClass(r._getEventCSSName(o)),n&&e.addClass(r._getEventCSSName(n))},getUsingFont:function(){return this.Font.UsingFont()},getJsonMember:function(e){return this.report.isWR?ae(e):e},toFillBack:function(){var e=this;return e.BackColor!==e.owner.BackColor},getRunningNo:function(){var e=this,t=e.report.ownerSR,r=t?1e4*t.getRunningNo():0;return r+e._runningNo()},_runningNo:function(){return 0}};var xe=function(e){var t=this;Te.call(t,e),t._borderCustom=!1,t.BackColor=e.BackColor,t.CanGrow=!1,t.CanShrink=!1,t.Font=new T(e.Font),t._freeCell=!0,t.setFreeCell(!1)};xe.prototype={loadFromJSON:function(e){var t=this;e&&(t.setFreeCell(!!e[t.getJsonMember("FreeCell")]),D(t,e),t.afterLoad(e))},afterLoad:function(e){var t=this,r=t.report,o=r.viewer.alpha,n=r.isWR;E(t,"BackColor",o.background),E(t,"ForeColor",o.text),t.Font.loadFromJSON(e.Font,n),t.setBorderCustom(e[t.getJsonMember("BorderCustom")]),t._borderCustom&&t.Border.loadFromJSON(e.Border,o.border,n),t.FreeCell?t.Controls.loadFromJSON(e.Control):t.TextFormat.loadFromJSON(e,n)},assign:function(e){var t,r=this;r.setFreeCell(e.FreeCell),r.setBorderCustom(e.BorderCustom),Te.prototype.assign.call(r,e),r.Font.assign(e.Font),e.Border&&$(r.Border,e.Border),e.FreeCell?(r.Controls.assign(e.Controls),r.isSingleDockControl()&&(t=r.Controls.items[0],!t.onclick&&r.onclick&&(t.onclick=r.onclick),!t.ondblclick&&r.ondblclick&&(t.ondblclick=r.ondblclick))):$(r.TextFormat,e.TextFormat)},attachData:function(){var e=this;e.FreeCell?e.Controls.attachData():e._getWrapperClass().attachData.call(e)},prepare:function(){var e,t=this,r=t.report.viewer,o=t.Controls,n=t.Font.font;t.registerEventClass(),t.FreeCell&&(o.layout(),t.isSingleDockControl()||2===r.options.controlPosition||(e=t.getRect(),je.prototype.buildTableLayout.call(t,e.Width(),e.Height())),o.prepare(),t.isSingleDockControl()&&(e=o.items[0],!e.onclick&&t.onclick&&(e.onclick=t.onclick,e.onclickClassID=t.onclickClassID),!e.ondblclick&&t.ondblclick&&(e.ondblclick=t.ondblclick,e.ondblclickClassID=t.ondblclickClassID))),n&&(t.defaultFontStyle=r.selectFontItem(n)),t.tableRows&&t.tableRows.forEach((function(e){e.defaultStyle=r.selectSectionItem(e)})),t.defaultStyle=r.selectCellItem(t)},unprepare:function(){var e=this;e.FreeCell?e.Controls.unprepare():e._getWrapperClass().unprepare.call(e),e.resetEventClass(),delete e.defaultFontStyle,delete e.defaultStyle},doGenerate:function(e){var t=this,r=t.report.viewer,o=t.Controls,n=t.Font.font,a=t.defaultFontStyle;e.addClass(r.selectCell(t)),n&&a&&e.addClass(r.selectFont(n,a)),t.addStyles&&t.addStyles(e),t.FreeCell?t.isSingleDockControl()?o.items[0].generateInCell(e):(t.addElementEventClass(e),t.tableRows?(e.addStyle("padding","0px"),e=new S("table",e),e.addStyle("border-collapse","collapse"),je.prototype.generateTableRows.call(t,e)):(e.addStyle("position","relative"),o.generate(e))):(t.addElementEventClass(e),Fe.prototype.generateNormal.call(t,e))},setFreeCell:function(e){var t,r=this;r._freeCell!==e&&(r._freeCell=e,e?(r.Controls=new de(r),delete r.ControlType):(t=r._getWrapperClass(),t.createWrapper.call(r),r.ControlType=t.ControlType,delete r.Controls))},setBorderCustom:function(e){var t=this;t._borderCustom!==e&&(t._borderCustom=e,e?t.Border=new C(12):delete t.Border)},setForeColor:function(e){var t=this;t.FreeCell?t.Controls.forEach((function(t){t.ForeColor=e})):t.ForeColor=e},getDisplayText:function(){var e=this;return e._getWrapperClass().getDisplayText.call(e)},setDisplayText:function(e){var t=this;return t._getWrapperClass().setDisplayText.call(t,e)},getControls:function(){var e=this;return e.FreeCell?e.Controls.items:[e]},isSingleDockControl:function(){var e=this.Controls.items;return 1===e.length&&5===e[0].Dock},isControlPositionClass:function(){return 0},_getDisplayText:function(){var e=this;return e._getWrapperClass()._getDisplayText.call(e)}},X(xe,Te);var be=function(e,t,r){var o=this;xe.call(o,e),o.row=t,o.col=r,o.ColSpan=1,o.RowSpan=1,o.Text="",o.DataName=""};be.prototype={generate:function(e){var t=this;e=new S("td",e),t.ColSpan>1&&e.addAttribute("colspan",t.ColSpan+""),t.RowSpan>1&&e.addAttribute("rowspan",t.RowSpan+""),t.doGenerate(e)},getOwnerGrid:function(){return this.owner},_getWrapperClass:function(){return Ee.prototype},getRect:function(){for(var e=this,t=e.owner,r=e.col,o=e.row,n=r+e.ColSpan,a=o+e.RowSpan,i=0,l=0;n>r;)i+=t.columns[r++].pxWidth;for(;a>o;)l+=t.rows[o++].pxHeight;return new m(0,0,i,l)},_runningNo:function(){return this.owner.owner._runningNo()},get FreeCell(){return!!this._freeCell},set FreeCell(e){this.setFreeCell(e)},get BorderCustom(){return!!this._borderCustom},set BorderCustom(e){this.setBorderCustom(e)},get DisplayText(){var e=this;return e.FreeCell?"":e.getDisplayText()},set DisplayText(e){var t=this;!t.FreeCell&&t.setDisplayText(e)}},X(be,xe);var we=function(e){var t=this;xe.call(t,e),t.Column=""};we.prototype={afterLoad:function(e){var t=this;xe.prototype.afterLoad.call(t,e),t.Column=t.owner.owner.Columns.itemByName(t.Column)},prepare:function(){var e=this;xe.prototype.prepare.call(e),e.CanShrink&&(e.owner.CanShrink=1)},getOwnerGrid:function(){return this.owner.owner}},X(we,xe);var ye=function(e){var t=this;we.call(t,e.owner),t.DataField=""};ye.prototype={_getWrapperClass:function(){return Ae.prototype},afterLoad:function(e){var t=this;we.prototype.afterLoad.call(t,e),t.Column.ContentCell=t},generate:function(e){var t=this,r=t.Column._crossOrderNo;e=new S("td",e),r&&e.addAttribute("_grcrossno",r),t.doGenerate(e)},generateMerge:function(e,t){var r=this,o=r.report.viewer,n=r.Font.font,a=r.Column._crossOrderNo;e=new S("td",e),a&&e.addAttribute("_grcrossno",a),e.addClass(o.selectCell(r)),n&&e.addClass(o.selectFont(n,r.defaultFontStyle)),t.generateInCell(e)},isControlPositionClass:function(){return this.FreeCell},get Name(){return this.Column.Name},set Name(e){this.Column.Name=e},get FreeCell(){return!!this._freeCell},set FreeCell(e){this.setFreeCell(e)},get BorderCustom(){return!!this._borderCustom},set BorderCustom(e){this.setBorderCustom(e)},get DisplayText(){var e=this;return e.FreeCell?"":e.getDisplayText()},set DisplayText(e){var t=this;!t.FreeCell&&t.setDisplayText(e)},getRect:function(){var e=this;return new m(0,0,e.Column.pxWidth,e.owner.pxHeight)},_runningNo:function(){return this.getOwnerGrid().Recordset.RecordNo+1}},X(ye,we);var Se=function(e,t){var r=this;we.call(r,e.owner),r.SupCell=e.supcell,r.Visible=!0,r.GroupTitle=t,r.Text="",r.Height=0,t&&(r._name="",r.SubTitles=new he(r.owner,r))};Se.prototype={_getWrapperClass:function(){return Ee.prototype},afterLoad:function(e){var t=this;we.prototype.afterLoad.call(t,e),t.GroupTitle?(t._name=e[t.getJsonMember("Name")],t.SubTitles.loadFromJSON(e.ColumnTitleCell)):t.Column.TitleCell=t},prepare:function(){var e=this;we.prototype.prepare.call(e),e.SubTitles&&e.SubTitles.prepare()},generate:function(e){var t=this;e=new S("th",e),t.doGenerate(e)},addStyles:function(e){var t=this,r=t.GroupTitle?1:t.owner.layerCount-t.owner.generatingLayer;t.colspan>1&&e.addAttribute("colspan",t.colspan+""),r>1&&e.addAttribute("rowspan",r+"")},getRect:function(){var e=this,t=e.owner.layerCount-e.layer,r=e.Column,o=0;return e.GroupTitle?(t=1,r=e.findFirstColumn(),r&&(o=e.findLastColumn().pxRight-r.pxLeft)):o=r.pxWidth,new m(0,0,o,e.owner.pxHeight*t)},findFirstColumn:function(){var t,r=this,o=r.Column;return r.GroupTitle&&(t=r.SubTitles.items,o=t.length>0?t[0].findFirstColumn():e),o},findLastColumn:function(){var t,r=this,o=r.Column;return r.GroupTitle&&(t=r.SubTitles.items,o=t.length>0?t[t.length-1].findLastColumn():e),o},encloseColumnObject:function(e){var t=this;t.owner.owner._ColumnMoveTo(e,t)},get FreeCell(){return!!this._freeCell},set FreeCell(e){this.setFreeCell(e)},get BorderCustom(){return!!this._borderCustom},set BorderCustom(e){this.setBorderCustom(e)},get DisplayText(){var e=this;return e.FreeCell?"":e.getDisplayText()},set DisplayText(e){var t=this;!t.FreeCell&&t.setDisplayText(e)},get Name(){var e=this;return e.GroupTitle?e._name:e.Column.Name},set Name(e){var t=this;t.GroupTitle?t._name=e:t.Column.Name=e},EncloseColumn:function(e){var t=this,r=t.owner.owner,o=r.Columns.Item(e);o&&r._ColumnMoveTo(o,t)},AddSubGroupTitle:function(e,t){return this.SubTitles.AddGroup(e,t)}},X(Se,we);var De=function(e){var t=this;Te.call(t,e),t.Left=0,t.Top=0,t.Width=0,t.Height=0,t.Anchor=3,t.Dock=0,t.Center=0,t.AlignColumnSide=3,t.AlignColumn="",t.AlignColumnEx="",t.Locked=!1,t.ShiftMode=1,t.PaddingLeft=0,t.PaddingRight=0,t.PaddingTop=0,t.PaddingBottom=0,t.BackColor=e.BackColor,t.BackStyle=2,t.ForeColor=e.ForeColor?e.ForeColor:q(0,t.report.viewer.alpha.text),t.Visible=!0,t.CustomDraw=!1,t.Border=new C(0),t.Font=new T(e.Font),t.Name="",t.CustomDrawScript=""};De.prototype={children:["Border"],attachData:function(){},afterLoad:function(e){var t=this,r=t.report.isWR,o=t.report.viewer.alpha;F(t,"Dock",n.DockStyle),F(t,"Center",n.CenterStyle),F(t,"AlignColumnSide",n.AlignColumnSideStyle),F(t,"ShiftMode",n.ShiftMode),F(t,"BackStyle",n.BackStyle),P(t,"Anchor",n.AnchorStyle),E(t,"BackColor",o.background),E(t,"ForeColor",o.text),t.Font.loadFromJSON(e.Font,r),t.Border.loadFromJSON(e.Border,o.border,r)},layout:function(t){var r,o=this,n=o.report,a=n.size2Pixel(o.Left),i=n.size2Pixel(o.Top),l=n.size2Pixel(o.Width),s=n.size2Pixel(o.Height),u=new m(a,i,a+l,i+s),c=n.getRunningColumn(o.AlignColumn),d=n.getRunningColumn(o.AlignColumnEx);if(c&&!c.Visible&&(c=e),d&&!d.Visible&&(d=e),c||d)switch(c&&d?d.pxLeft<c.pxLeft&&(r=d,d=c,c=r):d?c=d:d=c,o.AlignColumnSide){case 1:u.left=c.pxLeft,u.right=u.left+l;break;case 2:u.right=d.pxRight,u.left=u.right-l;break;default:u.left=c.pxLeft,u.right=d.pxRight}else{if(0!==o.Dock)switch(u=t.clone(),o.Dock){case 5:t.left=t.right,t.top=t.bottom;break;case 1:u.right=Math.min(t.right,t.left+l),t.left=u.right;break;case 2:u.bottom=Math.min(t.bottom,t.top+s),t.top=u.bottom;break;case 3:u.left=Math.max(t.left,t.right-l),t.right=u.left;break;case 4:u.top=Math.max(t.top,t.bottom-s),t.bottom=u.top}0!==o.Center&&5!==o.Dock&&(1!==o.Center&&3!==o.Center||(l=u.Width(),u.left=(t.left+t.right-l)/2,u.right=u.left+l),2!==o.Center&&3!==o.Center||(s=u.Height(),u.top=(t.top+t.bottom-s)/2,u.bottom=u.top+s))}o.pxRect=u,o.oAlignColumn=c,o.oAlignColumnEx=d},prepare:function(){var e=this,t=e.report.viewer,r=!e.owner.isSingleDockControl&&e.owner.isControlPositionClass();e.registerEventClass(),e.defaultStyle=t.selectControlItem(e),e.Font.font&&(e.defaultFontStyle=t.selectFontItem(e.Font.font)),r&&(e.defaultPositionStyle=t.selectPositionItem(e))},unprepare:function(){var e=this;e.resetEventClass(),delete e.defaultStyle,delete e.defaultFontStyle,delete e.defaultPositionStyle,delete e.oAlignColumn,delete e.oAlignColumnEx},prepareLayout:function(e){return e},generate:function(e){var t,r=this,o=r.report.viewer,n=r.pxRect;t=new S("span",e),r.addElementEventClass(t),t.addClass(o.selectControl(r)),r.Font.font&&t.addClass(o.selectFont(r.Font.font,r.defaultFontStyle)),r.defaultPositionStyle?t.addClass(o.selectPosition(r)):(t.addStyle("left",M(n.left)),t.addStyle("top",M(n.top)),t.addStyle("width",M(r.getContentWidth())),t.addStyle("height",M(r.getContentHeight()))),r.generateContent(r.prepareLayout(t))},generateInCell:function(e){var t=this;t.addElementEventClass(e),t.oAlignColumn&&t.setCrossNoAttr(e),t.generateContent(e)},generateContent:function(e){var t=this;t.CustomDraw?t.generateCanvas(e):t.generateNormal(e)},generateCanvas:function(e){var t=this,r=t.getRunningNo(),o=r?t.cloneCanvas(r):t;return t.report.registerCanvas(o,e),o},cloneCanvas:function(e){var t,r,o=this,n=new o.constructor(o.owner);for(t in n.runningNo=e,n.origin=o,n.assign(o),o)r=o[t],"object"!=_typeof(r)||n[t]||(n[t]=r);return n},resizeCanvas:function(){var e=this,t=e.canvas;t.width=Math.min(t.parentNode.clientWidth,window.innerWidth),t.height=Math.min(t.parentNode.clientHeight,window.innerHeight),e.drawCanvas(1)},drawCanvas:function(e){var t=this,r=t.getOwnerDetailGrid();r&&r.syncElementData(t.canvas),t.report.fireControlCustomDraw(t)},setCrossNoAttr:function(e){var t=this.oAlignColumn._crossOrderNo;t&&e.addAttribute("_grcrossno",t)},toFillBack:function(){var e=this;return 1===e.BackStyle&&e.BackColor!==e.owner.BackColor},getRunningNo:function(){return this.owner.getRunningNo()},getContentWidth:function(){var e=this,t=e.Border;return e.pxRect.Width()-e.PaddingLeft-e.PaddingRight-t.getLeftWidth()-t.getRightWidth()},getContentHeight:function(){var e=this,t=e.Border;return e.pxRect.Height()-e.PaddingTop-e.PaddingBottom-t.getTopWidth()-t.getBottomWidth()},getOwnerDetailGrid:function(){var t,r=this,o=r.owner,n=o.owner,a=n?n.owner:e;return a&&(a.ColumnTitle?t=a:n.isPrototypeOf(We)&&(t=a.getOwnerDetailGrid())),t},SetBounds:function(e,t,r,o){var n=this;n.Left=e,n.Top=t,n.Width=r-e,n.Height=o-t},BringToFront:function(){var e=this,t=e.owner.Controls;t.ChangeItemOrder(t.indexOf(e),t.length)},SendToBack:function(){var e=this,t=e.owner.Controls;t.ChangeItemOrder(t.indexOf(e),1)},DrawDefault:function(){}},X(De,Te);var Fe=function(e){var t=this;De.call(t,e),t.createWrapper(),t.AsTextBox=t};Fe.prototype={children:["Border","TextFormat"],afterLoad:function(e){var t=this;De.prototype.afterLoad.call(t,e),t.TextFormat.loadFromJSON(e,t.report.isWR)},createWrapper:function(){var e=this;e.PaddingLeft=2,e.PaddingRight=1,e.PaddingTop=1,e.PaddingBottom=1,e.CanGrow=!1,e.CanShrink=!1,e.ShrinkFontToFit=!1,e.ForeColor=e.owner.ForeColor?e.owner.ForeColor:q(0,e.report.viewer.alpha.text),e.TextFormat=new x,e.GetDisplayTextScript=""},prepareLayout:function(e){var t=this,r=t.TextFormat,o=r.TextAlign;return 16&o||(r.WordWrap||64&o?(e.addStyle("display","table"),e=new S("span",e),e.addStyle("display","table-cell"),e.addStyle("vertical-align",32&o?"middle":"bottom")):e.addStyle("line-height",M(t.getContentHeight()))),e},generateNormal:function(e){function t(){var e,t=n.split(""),r=t.length,o=0;for(n="";r>o;)if(e=t[o]," "===e&&r-1>o&&" "===t[o+1])for(;r>o&&" "===t[o];)n+="&nbsp;",o++;else n+=e,o++}var r=this,o="<br />",n=r.getDisplayText();r.TextFormat.HtmlTags||(/[\r\n&<>"]/.test(n)&&(n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\r\n/g,o).replace(/\r/g,o).replace(/\n/g,o)),/  /.test(n)&&t()),e.innerText=n},getDisplayText:function(){var e=this;return e.displayTextAssigned=!1,e.doingGetDisplayText||(e.doingGetDisplayText=!0,e.report.fireTextBoxGetDisplayText(e),e.doingGetDisplayText=!1),e.displayTextAssigned?e.assignedDisplayText:e._getDisplayText()},setDisplayText:function(e){var t=this;t.assignedDisplayText=e,t.displayTextAssigned=!0},DrawDefault:function(){var e=this,t=e.getDisplayText(),r=e.canvas;e.report.Graphics.DrawFormatText(t,0,0,r.width,r.height,e.TextFormat)}},X(Fe,De);var Pe=function(e){var t=this;Fe.call(t,e),t.Text="",t.Parameter=""};Pe.prototype={ControlType:1,_getDisplayText:function(){var e=this;return e.valueField?e.valueField.DisplayText:e.oParameter?e.oParameter.DisplayText:e.Text},attachData:function(){var e=this;e.Parameter&&(e.oParameter=e.report.ParameterByName(e.Parameter))},unprepare:function(){var e=this;Fe.prototype.unprepare.call(e),delete e.oParameter},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get AsStaticBox(){return this}},X(Pe,Fe);var Ee=function(e){var t=this;Fe.call(t,e),t.Text=""};Ee.prototype={ControlType:8,createWrapper:function(){var e=this;Fe.prototype.createWrapper.call(e),e.Text=""},_getDisplayText:function(){return this.textBuilder.generateDisplayText()},attachData:function(){var e=this;e.textBuilder=new f(e.report,e.Text)},getGroupVars:function(){function e(r){r.varItems&&r.varItems.forEach((function(r){var o=r.varField,n=o.type;4!==n&&2!==n&&5!==n||t.push(o),4===n?o.paramExp&&e(o.paramExp):5===n&&o.paramExps.forEach(e)}))}var t=[];return this.textBuilder.forEach(e),t},isPureNumericExpression:function(){var e=this;return e.prepare(),e.textBuilder&&1===e.textBuilder.items.length&&e.textBuilder.items[0].isPureNumeric()},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get AsFloat(){var e=this.textBuilder.items[0],t=e.__proto__.hasOwnProperty("calculate")?e.calculate():0;return isNaN(t)?0:t},get Value(){return this.getDisplayText()},get AsMemoBox(){return this}},X(Ee,Fe);var Ae=function(e){var t=this;Fe.call(t,e),t.DataField=""};Ae.prototype={ControlType:4,createWrapper:function(){var e=this;Fe.prototype.createWrapper.call(e),e.DataField=""},attachData:function(){var e=this;e.oDataField=e.report.RunningFieldByName(e.DataField)},unprepare:function(){var e=this;Fe.prototype.unprepare.call(e),delete e.oDataField},_getDisplayText:function(){var e=this.oDataField;return e?e.DisplayText:""},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get AsFieldBox(){return this}},X(Ae,Fe);var Re=function(e){var t=this;Fe.call(t,e),t.SummaryFun=1,t.RankNo=1,t.DataField="",t.DisplayField="",t.Format=""};Re.prototype={ControlType:5,afterLoad:function(e){var t=this;Fe.prototype.afterLoad.call(t,e),F(t,"SummaryFun",n.SummaryFun)},attachData:function(){var e,t,r=this,o=r.Format;r.init(r.DataField,r.DisplayField),o||(e=r.report.RunningFieldByName(r.DataField),e&&(o=e.Format)),t=r.paramExp,t&&1===t.varItems.length&&1===t.varItems[0].type&&6===t.varItems[0].object.FieldType?r.formater=new d(o):r.formater=new p(o)},_getDisplayText:function(){var e,t=this,r=t.SummaryFun,o=t.valueField;if(18===r||19===r||t.displayField)e=o?o.DisplayText:t.value;else{if(o){if(o.IsNull)return"";e=o.AsFloat}else e=t.value;e=t.formater.format(e)}return e},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get Value(){return this.getValue()},set Value(e){this.setValue(e)},get AsSummaryBox(){return this}},X(Re,Fe),X(Re,h);var Be=function(e){var t=this;Fe.call(t,e),t.SystemVar=-1,t.GroupIndex=1,t.Format=""};Be.prototype={ControlType:3,afterLoad:function(e){var t=this;Fe.prototype.afterLoad.call(t,e),F(t,"SystemVar",n.SystemVarType)},attachData:function(){var e=this,t=e.Format;1===e.SystemVar?e.formater=new d(t):e.formater=new p(t)},_getDisplayText:function(){var e=this,t=e.SystemVar;return t>0?e.formater.format(e.report.SystemVarValue2(t,e.GroupIndex)):""},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get AsSystemVarBox(){return this}},X(Be,Fe);var Me=function(e){De.call(this,e)};Me.prototype={generateContent:function(e){this.generateCanvas(e)},drawCanvas:function(e){var t=this;t.draw(e),t.CustomDraw&&De.prototype.drawCanvas.call(t,e)},DrawDefault:function(){this.draw()}},X(Me,De);var ke=function(e){var t=this;Me.call(t,e),t.L2R=!0,t.U2D=!0,t.LinePen=new _};ke.prototype={ControlType:10,children:["LinePen"],afterLoad:function(e){var t=this,r=t.report,o=r.PixelsToUnit(t.LinePen.Width);Me.prototype.afterLoad.call(t,e),t.LinePen.loadFromJSON(e.Pen,r.viewer.alpha.stroke,r.isWR),t.Height<o&&(t.Height=o,t.HL=1),t.Width<o&&(t.Width=o,t.VL=1)},draw:function(e){var t,r=this,o=r.canvas,n=new b(o.getContext("2d")),a=0,i=0,l=r.VL?0:o.width,s=r.HL?0:o.height;n.selectPen(r.LinePen),r.L2R||(t=a,a=l,l=t),r.U2D||(t=i,i=s,s=t),n.drawLine(a,i,l,s)},get AsLine(){return this}},X(ke,Me);var Ne=function(e){var t=this;Me.call(t,e),t.ShapeType=4,t.FillColor=0,t.FillStyle=2,t.CornerDx=4,t.CornerDy=4,t.LinePen=new _};Ne.prototype={ControlType:2,children:["LinePen"],afterLoad:function(e){var t=this,r=t.report,o=t.report.viewer.alpha;Me.prototype.afterLoad.call(t,e),F(t,"ShapeType",n.ShapeBoxType),F(t,"FillStyle",n.BackStyle),E(t,"FillColor",o.background),t.LinePen.loadFromJSON(e.Pen,o.stroke,r.isWR)},draw:function(e){var t,r,o,n=this,a=n.canvas,i=a.width,l=a.height,s=new b(a.getContext("2d")),u=n.LinePen.Width/2,c=1===n.FillStyle;switch(s.selectPen(n.LinePen),c&&s.selectFillColor(n.FillColor),n.ShapeType){case 7:s.drawLine(0,u,i,u);break;case 1:t=s.circle;break;case 2:t=s.ellipse;break;case 3:t=s.rectangle;break;case 6:t=s.square;break;case 4:t=s.roundRectangle,r=1;break;case 5:t=s.roundSquare,r=1}t&&(o=[u,u,i-2*u,l-2*u],r&&o.push(n.CornerDx,n.CornerDy),o.push(c),t.apply(s,o)),c&&s.restoreFillStyle(),s.restorePen()},get AsShapeBox(){return this}},X(Ne,Me);var Le=function(e){var t=this;Me.call(t,e),t.Text="",t.BarcodeType=4,t.BarWidth=0,t.BarRatio=2,t.CheckSum=!1,t.Direction=1,t.Alignment=2,t.CaptionPosition=3,t.CaptionAlignment=2,t.PDF417Rows=0,t.PDF417Columns=0,t.PDF417ErrorLevel=0,t.PDF417Simple=!1,t.QRCodeVersion=0,t.QRCodeErrorLevel=1,t.QRCodeMask=0,t.DtmxEncoding=2,t.DtmxMatrixSize=2,t.DtmxModuleSize=0};Le.prototype={ControlType:12,attachData:function(){var e=this;e.textBuilder=new f(e.report,e.Text)},afterLoad:function(e){var t=this,r=e[t.getJsonMember("BarcodeType")];switch(Me.prototype.afterLoad.call(t,e),r){case"Code25_Interleaved":t.BarcodeType=1;break;case"Code25_Industrial":t.BarcodeType=2;break;case"Code25_Matrix":t.BarcodeType=3;break;case"Code39Extended":t.BarcodeType=5;break;case"Code93Extended":t.BarcodeType=10;break;default:F(t,"BarcodeType",n.BarcodeType)}F(t,"Direction",n.BarcodeDirection),F(t,"Alignment",n.StringAlignment),F(t,"CaptionPosition",n.BarcodeCaptionPosition),F(t,"CaptionAlignment",n.StringAlignment),F(t,"DtmxEncoding",n.DtmxEncoding),F(t,"DtmxMatrixSize",n.DtmxMatrixSize)},getDisplayText:function(){return this.textBuilder.generateDisplayText()},generateCanvas:function(e){var t,r=this,o=r.BarcodeType,n=encodeURI(window.rubylong.grhtml5.barcodeURL),a={type:o,text:r.DisplayText,codepage:r.report.CodePage};t=Me.prototype.generateCanvas.call(r,e),1!==r.CaptionPosition&&(a.requireShowText=!0),n&&a.text&&(51===o||54===o?(a.Version=r.QRCodeVersion,a.ErrorLevel=r.QRCodeErrorLevel,a.Mask=r.QRCodeMask):50===o?(a.Rows=r.PDF417Rows,a.Columns=r.PDF417Columns,a.ErrorLevel=r.PDF417ErrorLevel,a.Simple=r.PDF417Simple):52===o||53===o?(a.Encoding=r.DtmxEncoding,a.MatrixSize=r.DtmxMatrixSize,a.ModuleSize=r.DtmxModuleSize):a.CheckSum=r.CheckSum,n+="?params="+encodeURIComponent(JSON.stringify(a)),window.rubylong.ajax(n,(function(e,t){var r,o=this;t&&(r=o.getOwnerDetailGrid(),r&&r.syncElementData(o.canvas),o._dodraw(JSON.parse(e.responseText)))}),t,"POST"))},draw:function(e){},_dodraw:function(e){function t(e){return 50===e||51===e||54===e||52===e||53===e}function r(e){return 15===e||14===e||16===e||17===e||18===e}function o(e){return parseInt(e,16)}function n(){var e,t,r,n,a,i,l,c=s/F,m=u/P,_={init:function(){f.right=z.left,f.bottom=z.top+m},draw:function(){f.right+=c*a,v.fillRect2(f,h),f.left=f.right},end:function(){f.right+=c*a,v.fillRect2(f,h),f.top=f.bottom,f.bottom+=m,f.left=z.left,f.right=z.left}},C={init:function(){f.left=z.right,f.top=z.bottom-m},draw:function(){f.left-=c*a,v.fillRect2(f,h),f.right=f.left},end:function(){f.left-=c*a,v.fillRect2(f,h),f.bottom=f.top,f.top-=m,f.left=z.right,f.right=z.right}},T={init:function(){f.bottom=z.top,f.left=z.right-m},draw:function(){f.bottom+=c*a,v.fillRect2(f,h),f.top=f.bottom},end:function(){f.bottom+=c*a,v.fillRect2(f,h),f.right=f.left,f.left-=m,f.top=z.top,f.bottom=z.top}},b={init:function(){f.top=z.bottom,f.right=z.left+m},draw:function(){f.top-=c*a,v.fillRect2(f,h),f.bottom=f.top},end:function(){f.top-=c*a,v.fillRect2(f,h),f.left=f.right,f.right+=m,f.top=z.bottom,f.bottom=z.bottom}};switch(50!=y&&(c>m?c=m:m=c),d=c*F,p=m*P,U=(s-d)/2,j=(u-p)/2,M||(g=U,U=j,j=g),z.left+=U,z.right=z.left+d,z.top+=j,z.bottom=z.top+p,S){case 1:l=_;break;case 2:l=C;break;case 3:l=T;break;default:l=b}for(f=z.clone(),l.init(),A=E.length,g=0,t=0;P>t;++t){for(r=o(E[g++])<<4|o(E[g++]),n=128,h=r&n?w:x,a=1,n>>=1,e=1;F>e;++e)0==e%8&&(r=o(E[g++])<<4|o(E[g++]),n=128),i=r&n?w:x,h===i?++a:(l.draw(),h=i,a=1),n>>=1;l.end()}}function a(){switch(y){case 15:O=15,V=0;break;case 16:case 17:case 18:O=12,V=12}}function i(){function e(){var e=_.BarRatio;switch(y){case 1:case 2:case 4:case 14:case 15:case 5:case 13:case 16:case 17:case 18:case 19:case 20:2>e&&(e=2),e>3&&(e=3);break;case 3:2.25>e&&(e=2.25),e>3&&(e=3)}return[1,e,1.5*e,2*e]}function t(e){var t=o(e);return{w:p[t%4],lt:Math.floor(t/4)}}function r(e){for(var r=e.length,o=0;r-- >0;)o+=t(e[r]).w;return o}var n,a,i,l=_.Alignment,p=e(),h=r(E),m=_.BarWidth,C=N/B.length/10,T=2*u/5,b=k?u+2*L/3:u;if(G=C*O,H=C*V,c=m?report.UnitToPixels(m):(s-G-H)/h,d=c*h+G+H,W=d>s+1,!W){switch(l){case 1:U=G;break;case 2:U=(s-d)/2+G;break;default:U=s-d+G}switch(f=z,S){case 1:f.left+=U;break;case 2:f.right-=U;break;case 3:f.top+=U;break;default:f.bottom-=U}for(g=0;A>g;++g)switch(n=t(E[g]),m=n.w*c,a=2===n.lt?T:3==n.lt?b:u,i=0==n.lt?x:w,S){case 1:f.right=f.left+m,f.bottom=f.top+a,v.fillRect2(f,i),f.left=f.right;break;case 2:f.left=f.right-m,f.bottom=f.top+a,v.fillRect2(f,i),f.right=f.left;break;case 3:f.bottom=f.top+m,f.left=f.right-a,v.fillRect2(f,i),f.top=f.bottom;break;default:f.top=f.bottom-m,f.left=f.right-a,v.fillRect2(f,i),f.bottom=f.top}}}function l(){var e,t,r,o,n=_.CaptionAlignment,a=1===n?33:2===n?34:36,i=_.Alignment,l=Y.left+U;if(M?(3===D&&(j=-j),Y.top+=j,Y.bottom+=j):(2===D&&(U=-U),Y.left+=U,Y.right+=U),k)switch(g=0,y){case 15:l-=G,v.drawText(B.substr(g++,1),l,Y.top),l=Y.left+U+4*c,o=l+42*c,v.drawEqualSpaceText(B.substr(g,6),l,o,Y.top),g+=6,l=Y.left+U+50*c,o=l+41*c,v.drawEqualSpaceText(B.substr(g,6),l,o,Y.top);break;case 14:l+=4*c,o=l+28*c,v.drawEqualSpaceText(B.substr(g,4),l,o,Y.top),g+=4,l=Y.left+U+36*c,o=l+27*c,v.drawEqualSpaceText(B.substr(g,4),l,o,Y.top);break;case 17:case 18:v.fontSizeTo(Math.floor(.77*v.usingFont.Size)),L=R(v.usingFont),N=v.measureTextWidth("0"),l-=G,v.drawText("0",l,Y.bottom-L),e=B.substr(6),N=v.measureTextWidth(e),l=Y.right-U+H-N,v.drawText(e,l,Y.bottom-L),v.restoreFont(),l=Y.left+U+4*c,o=l+42*c,v.drawEqualSpaceText(B.substr(0,6),l,o,Y.top);break;case 16:v.fontSizeTo(Math.floor(.77*v.usingFont.Point)),L=R(v.usingFont),e=B.substr(0,1),N=v.measureTextWidth(e),l-=G,v.drawText(e,l,Y.bottom-L),e=B.substr(11),N=v.measureTextWidth(e),l=Y.left+U+95*c+Math.max(H-N,2),v.drawText(e,l,Y.bottom-L),v.restoreFont(),l=Y.left+U+11*c,o=l+35*c,++g,v.drawEqualSpaceText(B.substr(g,5),l,o,Y.top),l=o+5*c,o=l+35*c,g+=5,v.drawEqualSpaceText(B.substr(g,5),l,o,Y.top)}else if(M){switch(i){case 1:Y.right=Y.left+d;break;case 2:Y.left=(Y.left+Y.right-d)/2,Y.right=Y.left+d;break;default:Y.left=Y.right-d}v.drawTextAlign2(B,Y,a)}else{switch(i){case 1:Y.bottom=Y.top+d;break;case 2:Y.top=(Y.top+Y.bottom-d)/2,Y.bottom=Y.top+d;break;default:Y.top=Y.bottom-d}switch(t=Y.right,n){case 1:r=Y.top;break;case 2:r=(Y.top+Y.bottom-N)/2;break;default:r=Y.bottom-N}v.drawTextRotate(B,t,r,270)}}var s,u,c,d,p,h,f,g,_=this,C=_.canvas,v=new b(C.getContext("2d")),T=_.getUsingFont(),x=_.BackColor,w=_.ForeColor,y=_.BarcodeType,S=_.Direction,D=_.CaptionPosition,F=e.cols,P=e.rows,E=e.graph,A=E?E.length:0,B=e.text?e.text:_.DisplayText,t=t(y),M=1===S||2===S,k=r(y)&&1===S&&3===D,N=0,L=R(T),I=t?Math.max(L,10):0,O=0,V=0,G=0,H=0,W=!1,U=0,j=0,q=new m(0,0,C.width,C.height),z=q.clone(),Y=q.clone();if(F){if(v.selectFont(T),1!==D&&(M?2===D?(Y.bottom=Y.top+L,z.top=Y.bottom+I):(Y.top=Y.bottom-L,z.bottom=Y.top-I):2===D?(Y.left=Y.right-L,z.right=Y.left-I):(Y.right=Y.left+L,z.left=Y.right+I)),s=M?z.Width():z.Height(),u=M?z.Height():z.Width(),10>s||10>u)return void v.restoreFont();1!=D&&(N=v.measureTextWidth(B)),t?n():(a(),i()),W?pdd.drawTextCenter("条宽度太大，条码无法完整显示",(q.left+q.right)/2,(q.top+q.bottom-L)/2):1!=D&&l(),v.restoreFont()}},get Value(){return this.getDisplayText()},get DisplayText(){return this.getDisplayText()},get AsBarcode(){return this}},X(Le,Me);var Ie=function(e){var t=this;De.call(t,e),t.Alignment=3,t.SizeMode=3,t.TransparentMode=0,t.RotateMode=0,t.ImageIndex=0,t.Picture="",t.ImageFile="",t.DataField=""};Ie.prototype={ControlType:7,afterLoad:function(e){var t=this;De.prototype.afterLoad.call(t,e),F(t,"SizeMode",n.PictureSizeMode),F(t,"TransparentMode",n.PictureTransparentMode),F(t,"RotateMode",n.PictureRotateMode)},attachData:function(){var e=this;e.oDataField=e.report.RunningFieldByName(e.DataField)},generateNormal:function(e){var t,r,o,n,i,l,s,u,c=this,d=c.Picture,p=c.oDataField,h=c.ImageFiles,f=h?h[c.getOwnerDetailGrid().Recordset.RecordNo]:c.ImageFile,g=c.ImageIndex,m=c.SizeMode;if(d?n="data:image;base64,"+d:p?(n=p.AsString,n.length>256&&(n="data:image;base64,"+n)):f?n=f:g&&(n=g),n)if(isNaN(n))if(5===m)e.addStyle("background-image","url("+n+")");else{if(t=c.pxRect,t||(t=c.owner.getRect()),r=t.Width(),o=t.Height(),e.addStyle("text-align","center"),e.addStyle("vertical-align","middle"),i=new S("img",e),i.skipend=1,2===c.SizeMode)s=r,u=o;else try{l=document.createElement("img"),l.src=n,3===c.SizeMode||l.width>r||l.height>o?l.width*o>r*l.height?s=r:u=o:l.width&&l.height?(s=l.width,u=l.height):(s=r,u=o)}catch(_){s=r,u=o}s&&i.addAttribute("width",Math.round(s)),u&&i.addAttribute("height",Math.round(u)),i.addAttribute("src",n)}else n=+n,e.addStyle("text-align","center"),e.addStyle("vertical-align","middle"),i=new S("input",e),i.skipend=1,i.addAttribute("type","checkbox"),i.addAttribute("id",c.getCheckBoxID()),i.addClass(a.CSS_CB),-1!==n&&-3!==n||i.addAttribute("checked"),p&&i.addAttribute(a.ATTR_FIELD,p.Name),c.report._has_cb=1},getCheckBoxID:function(){var e=this,t=e.owner.owner;return t.ContentCells?"CBC"+t.owner.Recordset.RecordNo:t.Header?"CBG"+t.recordset.recordNo:e.Name},set Text(e){this[e.length>256?"Picture":"ImageFile"]=e},get checked(){var e=this,t=e.oDataField,r=t?t.AsInteger:e.ImageIndex;return-1===r||-3===r},set checked(e){var t,r=this,o=r.oDataField,n=e?-1:-2;o?(t=o.owner,t.Edit(),o.AsInteger=n,t.Post()):r.ImageIndex=n,document.getElementById(r.getCheckBoxID()).checked=e},get AsPictureBox(){return this},LoadFromFile:function(e){var t=this,r=t.getOwnerDetailGrid();r?(t.ImageFiles||(t.ImageFiles={}),t.ImageFiles[r.Recordset.RecordNo]=e):t.ImageFile=e}},X(Ie,De);var Oe=function(e){var t=this;De.call(t,e)};Oe.prototype={ControlType:6,get AsRichTextBox(){return this},generateNormal:function(e){e.innerText="不支持RichTextBox"}},X(Oe,De);var Ve=function(e){var t=this;De.call(t,e),t.HideOnRecordsetEmpty=!1,t.RelationFields="",t.Report=new at(e.report.viewer,t)};Ve.prototype={ControlType:9,afterLoad:function(e){var t=this,r=e.Report;De.prototype.afterLoad.call(t,e),t.Report.isWR=t.report.isWR,r&&t.Report.loadFromJSON(r)},prepare:function(){var e=this,t=e.report;De.prototype.prepare.call(e),t._srChildren||(t._srChildren=[]),t._srChildren.push(e),e.prepareRelationRecordset()},prepareRelationRecordset:function(){var e,t,r,o,n,a,i=this,l=i.RelationFields,s=i.report,u=s.DetailGrid,c=i.Report,d=c.DetailGrid;if(l&&d&&u&&(e=u.Recordset,r=d.Recordset,t=e.decodeFields(l),o=r.decodeFields(l),t.length===o.length&&r.RecordCount)){for(i._rmFields=t,i._rdFields=o,a=i._relations=[],r.First(),n=[],a.push(n),n.push(r.curRecord),r.keepValue(),r.Next();!r.Eof();)r.fieldsKeepedValueChanged(o)&&(n=[],a.push(n),r.keepValue()),n.push(r.curRecord),r.Next();a.sort((function(e,t){for(var r,n,a,i=0,l=o.length;l>i;){if(r=o[i++]._tableMember,n=e[0][r],a=t[0][r],a>n)return-1;if(n>a)return 1}return 0}))}},generateNormal:function(t){for(var r,o,n,a=this,i=a.Report.DetailGrid?a.Report.DetailGrid.Recordset:e,l=a._relations,s=a.report,u=s.DetailGrid,c=a.getOwnerDetailGrid(),d=a.Report.Parameters,p=d.Count;p>0;)o=d.Item(p--),n=o.Name,c?(r=s.FieldByName(n),r?o.Value=r.Value:(r=s.ParameterByName(n),r&&(o.Value=r.Value))):(r=s.ParameterByName(n),r?o.Value=r.Value:u&&(r=s.FieldByName(n),r&&(o.Value=r.Value)));l&&a.attachRelationTable(),(!a.HideOnRecordsetEmpty||!i||i.RecordCount)&&a.Report.generate(t),l&&a.detachRelationTable()},detachRelationTable:function(){var e=this.Report.DetailGrid.Recordset;e._dataTable=e._bakTable,e._relTblIndex=-1,delete e._bakTable},attachRelationTable:function(){function e(){for(var e,r,o=n._rmFields,a=n._rdFields,i=o.length,s=0;i>s;){if(r=t[a[s]._tableMember],e=l[o[s++]._tableMember],e>r)return-1;if(r>e)return 1}return 0}var t,r,o,n=this,a=n._relations,i=n.Report.DetailGrid.Recordset,l=n.report.DetailGrid.Recordset.curRecord,s=a.length-1,u=0;for(i._bakTable=i._dataTable,i._dataTable=[];s>=u;)if(r=Math.floor((u+s)/2),t=a[r][0],o=e(),0>o)u=r+1;else{if(!(o>0)){i._dataTable=a[r],i._relTblIndex=r;break}s=r-1}return!0},attachRelationTable2:function(e){var t=this;t.Report.DetailGrid.Recordset._dataTable=t._relations[e]},get AsSubReport(){return this}},X(Ve,De);var Ge=function(e){var t=this;Te.call(t,e),t.Visible=!0,t.FixedWidth=!1,t.Width=t.report.cm2Size(3)};Ge.prototype={prepare:function(){self.pxWidth=this.report.size2Pixel(self.Width)},get FreeGrid(){return this.owner}},X(Ge,Te);var He=function(e){var t=this;Te.call(t,e),t.Visible=!0,t.Height=t.report.cm2Size(.58)};He.prototype={prepare:function(){self.pxHeight=this.report.size2Pixel(self.Height)},get FreeGrid(){return this.owner}},X(He,Te);var We=function(e){var t=this;De.call(t,e),t.ColumnCount=5,t.RowCount=5,t.TitleRows=1,t.ShowColLine=!0,t.ShowRowLine=!0,t.ColLinePen=new _,t.RowLinePen=new _,t.columns=[],t.rows=[],t.cells=[]};We.prototype={ControlType:13,attachData:function(){var e,t,r,o=this;for(t=o.cells.length,e=0;t>e;e++)r=o.cells[e],r&&r.forEach((function(e){e.attachData(),e.prepare()}))},prepareChildren:function(){var e,t=this,r=t.columns,o=t.rows,n=t.cells;for(e=r.length=t.ColumnCount;e--;)r[e]||(r[e]=new Ge(t));for(e=n.length=o.length=t.RowCount;e--;)o[e]||(o[e]=new He(t)),n[e]||(n[e]=[],n[e].length=t.ColumnCount)},prepare:function(){var e=this,t=new y;e.columns.length===e.ColumnCount&&e.rows.length===e.RowCount&&e.cells.length===e.RowCount||e.prepareChildren(),De.prototype.prepare.call(e),t.addCellBorder(e),e.blankCellStyle=e.report.viewer.addCustomStyle(t)},assign:function(e){var t=this;De.prototype.assign.call(t,e),e.columns.forEach((function(e,r){var o=new Ge(t);o.assign(e),o.pxWidth=e.pxWidth,t.columns[r]=o})),e.rows.forEach((function(e,r){var o=new He(t);o.assign(e),o.pxHeight=e.pxHeight,t.rows[r]=o})),e.cells.forEach((function(e,r){e.forEach((function(e,o){var n=new be(t,r,o);n.assign(e),t.cells[r]||(t.cells[r]=[]),t.cells[r][o]=n}))})),t.Height=e.Height},afterLoad:function(e){var t,r,o,n,a,i=this,l=i.report,s=i.Border,u=i.columns=[],c=i.rows=[],d=i.cells=[];if(De.prototype.afterLoad.call(i,e),i.prepareChildren(),e.FreeGridColumn)for(n=e.FreeGridColumn.length,o=0;n>o;o++)r=e.FreeGridColumn[o],u[r.index-1].loadFromJSON(r);if(e.FreeGridRow)for(n=e.FreeGridRow.length,o=0;n>o;o++)r=e.FreeGridRow[o],c[r.index-1].loadFromJSON(r);if(e.FreeGridCell)for(n=e.FreeGridCell.length,o=0;n>o;o++)r=e.FreeGridCell[o],--r.row,--r.col,t=d[r.row][r.col]=new be(i,r.row,r.col),t.loadFromJSON(r);for(n=u.length,a=0,o=0;n>o;o++)t=u[o],t.pxWidth=l.size2Pixel(t.Width),a+=t.Width;for(i.Width=a+l.pixel2Size(s.getLeftWidth()+s.getRightWidth()),n=c.length,a=0,o=0;n>o;o++)t=c[o],t.pxHeight=l.size2Pixel(t.Height),a+=t.Height;i.Height=a+l.pixel2Size(s.getTopWidth()+s.getBottomWidth())},generateNormal:function(e){var t,r,o,n,a=this,i=a.report.viewer,l=new S("table",e),s=new S("colgroup",l),u=[];for(a.Font.font&&l.addClass(i.selectFont2(a.Font.font)),l.styles.addBorder(a.Border),l.addStyle("border-collapse","collapse"),l.addStyle("width","100%"),a.toFillBack()&&l.addBackColorStyle(a.BackColor),n=a.ColumnCount,r=0,o=0;n>o;o++)r+=a.columns[o].pxWidth;for(o=0;n>o;o++)t=new S("col",s),t.skipend=1,t.addStyle("width",k(100*a.columns[o].pxWidth/r));for(o=0;o<a.RowCount;o++)r=[],r.length=a.ColumnCount,u.push(r);a.cells.forEach((function(e,t){e.forEach((function(e){function t(){for(var t,r=e.row,o=r+e.RowSpan,n=e.col+e.ColSpan;o>r;r++)for(t=e.col;n>t;t++)u[r][t]=1}(e.ColSpan>1||e.RowSpan>1)&&t(),u[e.row][e.col]=e}))})),u.forEach((function(e,t){var r,o=a.ColumnCount,n=0,s=new S("tr",l);s.addStyle("height",M(a.rows[t].pxHeight));do{for(;o>n&&!e[n];)r=new S("td",s),r.addClass(i._getCSSName(a.blankCellStyle)),n++;for(;o>n&&1===e[n];)n++;o>n&&(r=e[n])&&(r.generate(s),n=r.col+r.ColSpan)}while(o>n)}))},get AsFreeGrid(){return this},ColumnAt:function(e){var t=this,r=t.columns;return r.length!==t.ColumnCount&&t.prepareChildren(),r[e-1]},RowAt:function(e){var t=this,r=t.rows;return r.length!==t.RowCount&&t.prepareChildren(),r[e-1]},CellAt:function(t,r){var o,n=this,a=n.cells,i=e;return a.length!==n.RowCount&&n.prepareChildren(),t>0&&t<=n.RowCount&&r>0&&r<=n.ColumnCount&&(o=a[--t],i=o[--r],i||(i=o[r]=new be(n,t,r))),i},CellByDataName:function(t){for(var r,o,n,a=this,i=a.cells,l=i.length,s=l;s--;)for(r=i[s],o=r.length;o--;)if(n=r[o],n&&n.DataName===t)return n;return e}},X(We,De);var Ue=function(e){var t=this;Te.call(t,e),t.Visible=!0,t.CanGrow=!1,t.CanShrink=!1,t.Height=e.report.cm2Size(t.defaultHeight()),t.BackColor=e.BackColor,t.FormatScript="",t.Font=new T(t.getParentFont())};Ue.prototype={afterLoad:function(e){var t=this,r=t.report;e[t.getJsonMember("BackColor")]||(t.BackColor=t.getParentBackColor()),E(t,"BackColor",r.viewer.alpha.background),t.Font.loadFromJSON(e.Font,r.isWR)},prepare:function(){var e=this,t=e.Controls;e.registerEventClass(),e.pxHeight=e.report.size2Pixel(e.Height),e._singleHidableSR=e.getSingleHidableSR(),e._singleSR=t&&1===t.Count&&9===t.Item(1).ControlType},unprepare:function(){var e=this;e.resetEventClass(),delete e.defaultStyle},generate:function(e){var t=this;t.report.fireSectionFormat(t),t.pxHeight=t.report.size2Pixel(t.Height),t.isToGenerate()&&(t._singleSR&&!t.Group?t.Controls.Item(1).generateContent(e):t.doGenerate(e))},defaultHeight:function(){return 3},getParentBackColor:function(e){return this.owner.BackColor},getParentFont:function(){return this.owner.Font},getSingleHidableSR:function(){return e},isControlPositionClass:function(){return 0},isToGenerate:function(){function e(){var e,r=t._singleHidableSR,o=r._relations;return o&&r.attachRelationTable(),e=!r.Report.DetailGrid||r.Report.DetailGrid.Recordset.RecordCount,o&&r.detachRelationTable(),e}var t=this,r=t.Visible&&t.Height>0;return r&&t._singleHidableSR&&(r=e()),r}},X(Ue,Te);var je=function(e){var t=this;Ue.call(t,e),t.Controls=new de(t)};je.prototype={children:["Controls"],afterLoad:function(e){var t=this;Ue.prototype.afterLoad.call(t,e),t.Controls.loadFromJSON(e.Control)},attachData:function(){this.Controls.attachData()},prepare:function(){var e=this,t=e.Controls,r=e.report,o=r.viewer;Ue.prototype.prepare.call(e),t.layout(),2!==o.options.controlPosition&&e.buildTableLayout(r.getReportWidth(),e.pxHeight),t.prepare(),e.tableRows&&(r.reportFitHeight&&ue(e.tableRows),e.tableRows.forEach((function(e){e.defaultStyle=o.selectSectionItem(e)}))),e.defaultStyle=o.selectSectionItem(e)},unprepare:function(){var e=this;Ue.prototype.unprepare.call(e),e.Controls.unprepare()},buildTableLayout:function(t,r){function o(t,r,o,n){var a,i,l,s=[];for(u.forEach((function(e){s.push({pos:e.pxRect[t],count:1},{pos:e.pxRect[r],count:1})})),s.sort((function(e,t){return e.pos-t.pos})),a=s.length,i=0;a>i&&s[i].pos<o;)s[i++]=e;if(i>0&&(s.unshift({pos:o,count:i}),++a),!isNaN(n)){for(i=a-1;i>=0&&s[i]&&s[i].pos>n;)s[i--]=e;i=a-1-i,i>=0&&s.push({pos:n,count:i})}return l={pos:-98765},s.forEach((function(t,r){t&&(l.pos===t.pos?(l.count++,s[r]=e):l=t)})),l={pos:-98765},s.forEach((function(t,r){t&&(t.pos-l.pos<8?l.count>t.count?(l.count+=t.count,s[r]=e):(t.count+=l.count,s[i]=e,l=t,i=r):(l=t,i=r))})),s=s.filter((function(e){return e})),a=s.length,a>1&&(s[0].pos<o+4&&(s[0].pos=o),s[0].pos!==o&&(s.unshift({pos:o,count:0}),a++),isNaN(n)||(a--,n-s[a].pos<4&&(s[a].pos=n),s[a].pos!==n&&s.push({pos:n,count:0}))),s}function n(e,t,r){var o=0,n=r.length;u.sort((function(t,r){return t.pxRect[e]-r.pxRect[e]})),u.forEach((function(a){for(var i=a.pxRect[e];n>o&&r[o].pos<i;)o++;(o>=n||o>0&&i-r[o-1].pos<r[o].pos-i)&&--o,a.cell[t]=o}))}var a,i,l,s,u,c,d,p,h=this,f=h.report.viewer,g=h.getTableColEdges,m=h.getMergedColumns?h.getMergedColumns():0,_=[],C=[];if(u=h.Controls.items.filter((function(e){return e.cell={control:e},e.Visible})),i=u.length,c=o("top","bottom",0,r),l=c.length-1,g?(d=h.getTableColEdges(),s=d.length-1,8>s&&(p=o("left","right",0,t),p.length>2*s&&(d=p,g=e))):d=o("left","right",0,t),s=d.length-1,!g)for(h.tableCols=[],a=0;s>a;)h.tableCols.push(d[a+1].pos-d[a++].pos);for(n("top","beginRow",c),n("bottom","endRow",c),n("left","beginCol",d),n("right","endCol",d),u.forEach((function(e){var t=e.cell;t.endCol<=t.beginCol&&t.endCol<s&&t.endCol++,t.endRow<=t.beginRow&&t.endRow<l&&t.endRow++})),a=0;l>a;)C.push({section:h,pxHeight:c[a+1].pos-c[a++].pos,cells:[]});for(u=u.filter((function(e){var t=e.cell;return t.beginCol<t.endCol&&t.beginRow<t.endRow})),u.sort((function(e,t){var r=e.cell.beginRow-t.cell.beginRow;return r||e.cell.beginCol-t.cell.beginCol})),a=0;l>a;a++)p=[],p.length=s,_.push(p);m&&m.forEach((function(e){var t=e.index;_.forEach((function(e){e[t]=1}))})),a=0,u.forEach((function(e){for(var t,r,o=e.cell,n=_[o.beginRow];o.beginCol<o.endCol&&n[o.beginCol];)o.beginCol++;for(;o.endCol>o.beginCol&&n[o.endCol-1];)o.endCol--;if(o.beginCol<o.endCol){for(t=o.beginRow;t<o.endRow;t++)for(r=o.beginCol;r<o.endCol;r++)_[t][r]=1;n[o.beginCol]=e,a++}})),1===f.options.controlPosition||m||i&&a/i>.8?(_.forEach((function(e,t){var r,o,n,a=C[t].cells;r=o=0;do{for(;s>o&&!e[o];)o++;for(o>r&&(a.push({beginCol:r,endCol:o}),r=o);s>o&&1===e[o];)o++;r=o,s>r&&(n=e[r])&&(n=n.cell,a.push(n),r=o=n.endCol)}while(s>o)})),C.forEach((function(e){var t=0,r=0;e.cells.forEach((function(e){e.control&&(t++,e.control.CanShrink&&r++)})),t&&r===t&&delete e.pxHeight})),h.tableRows=C):(delete h.tableCols,delete h.tableRows,h.Controls.items.forEach((function(e){delete e.cell})))},doGenerate:function(e){var t=this,r=t.report.viewer;e=new S(t.tableRows?"table":"div",e),t.addElementEventClass(e),e.addClass(r.selectSection(t)),t.tableRows?(e.addStyle("border-collapse","collapse"),t.generateTableRows(e)):(e.addStyle("position","relative"),t.Controls.generate(e))},generateTableRows:function(e,t){function r(){var e,t,r=d.length-1,o=d[r],n=s.showingColumns,a=s.Border;n.length>0&&(e=n[n.length-1],t=a.getLeftWidth()+a.getRightWidth(),Math.abs(o-e.pxWidth-t)<.5&&(d[r]-=t))}var o,n,a=this,i=a.owner,l=a.report,s=i.RunningDetailGrid,u=l.viewer,c=a.owner!==l||l.reportFitWidth,d=a.tableCols,p=0;d&&(d.forEach((function(e){p+=e})),i==a.report&&s&&r(),o=new S("colgroup",e),e.addStyle("width",c?"100%":M(p)),d.forEach((function(e){n=new S("col",o),n.skipend=1,n.addStyle("width",k(100*e/p))}))),a.tableRows.forEach((function(r,o){function n(e){e.ContentCell.generate(i),e.mergingElement=i.children[i.children.length-1],e.ContentCell.getUsingFont()!==a.getUsingFont()&&e.mergingElement.addClass(u.selectFont2(e.ContentCell.getUsingFont())),e.ContentCell.BackColor!==a.BackColor&&e.mergingElement.addBackColorStyle(e.ContentCell.BackColor),e.mergedHeader.todoMerge=0}var i;i=new S("tr",e),i.addClass(u.selectSection(r)),r.cells.forEach((function(e){var r,a,l,s=e.control;if(!o&&t)for(;(l=t[0])&&l.index<=e.beginCol;)n(l),t.shift();r=new S("td",i),a=e.endCol-e.beginCol,a>1&&r.addAttribute("colspan",a+""),e.endRow&&(a=e.endRow-e.beginRow,a>1&&r.addAttribute("rowspan",a+""),s.Visible&&(13!==s.ControlType?(r.addClass(u.selectControl(s)),s.Font.font&&r.addClass(u.selectFont(s.Font.font,s.defaultFontStyle))):r.addStyle("padding","0px"),s.generateInCell(r)))})),!o&&t&&t.forEach((function(e){n(e)}))}))},getRect:function(){var e=this;return new m(0,0,e.report.getReportWidth(),e.pxHeight)},getSingleHidableSR:function(){var t=this,r=t.Controls.items,o=r[0];return 1===r.length&&9===o.ControlType&&o.HideOnRecordsetEmpty?o:e},_runningNo:function(){return 0}},X(je,Ue);var qe=function(e){var t=this;je.call(t,e),t.Name=""};qe.prototype={},X(qe,je);var ze=function(e){var t=this;je.call(t,e),t.Name=""};ze.prototype={},X(ze,je);var Ye=function(e){var t=this;Ue.call(t,e),t.Height=t.report.cm2Size(.58)};Ye.prototype={defaultHeight:function(){return.58}},X(Ye,Ue);var Je=function(e){var t=this;Ye.call(t,e),t.ContentCells=new fe(t),t.AlternatingBackColor=t.BackColor};Je.prototype={afterLoad:function(e){var t=this;Ye.prototype.afterLoad.call(t,e),e[t.getJsonMember("AlternatingBackColor")]?E(t,"AlternatingBackColor",t.report.viewer.alpha.background):t.AlternatingBackColor=t.BackColor,t.ContentCells.loadFromJSON(e.ColumnContentCell)},prepare:function(){var e,t=this,r=t.report.viewer;Ye.prototype.prepare.call(t),t.defaultStyle=r.selectSectionItem(t),t.AlternatingBackColor!==t.BackColor&&(e=t.BackColor,t.BackColor=t.AlternatingBackColor,t.altSectionStyle=r.selectSectionItem(t),t.BackColor=e),t.ContentCells.prepare()},unprepare:function(){var e=this;Ye.prototype.unprepare.call(e),e.ContentCells.unprepare()},generate:function(e,t){var r=this;r.owner.Recordset.MoveTo(t),Ye.prototype.generate.call(r,e)},doGenerate:function(e){var t=this,r=t.report.viewer,o=t.owner,n=o.showingColumns,i=o.Recordset.RecordNo;e=new S("tr",e),t.addElementEventClass(e),e.addAttribute(a.ATTR_CONTENT_RECNO,i+""),t.altSectionStyle&&i%2?(t._BackColor=t.BackColor,t._defaultStyle=t.defaultStyle,t.BackColor=t.AlternatingBackColor,t.defaultStyle=t.altSectionStyle,e.addClass(r.selectSection(t)),t.BackColor=t._BackColor,t.defaultStyle=t._defaultStyle):e.addClass(r.selectSection(t)),o.hasMergedColumn?n.forEach((function(t){var r,o,n,a=t.ContentCell,i=t.mergedHeader;if(i){if(i.todoMerge){if(i.SameAsColumn)a.generate(e);else for(r=i.Controls,o=r.Count;o>0;)if(n=r.Item(o--),n.oAlignColumn===t){a.generateMerge(e,n);break}e.children&&(t.mergingElement=e.children[e.children.length-1])}}else a.generate(e)})):n.forEach((function(t){t.ContentCell.generate(e)})),o.hasMergedColumn&&o.Groups.forEach((function(e){e.Header.todoMerge&&(e.Header.todoMerge=0)}))},getSingleHidableSR:function(){for(var t,r,o=this,n=o.ContentCells.items,a=n.length,i=0,l=0,s=0;a>i&&(t=n[i++],t._freeCell);)if(s=t.Controls.Count,s>0)if(l+=s,1===l)r=t.Controls.Item(1);else if(l>1)break;return 1===l&&9===r.ControlType&&r.HideOnRecordsetEmpty?r:e},SetCellsBackColor:function(e){this.ContentCells.forEach((function(t){t.BackColor=e}))},SetCellsForeColor:function(e){this.ContentCells.forEach((function(t){t.setForeColor(e)}))}},X(Je,Ye);var Ke=function(e){var t=this;Ye.call(t,e),t.TitleCells=new he(t)};Ke.prototype={afterLoad:function(e){var t=this;Ye.prototype.afterLoad.call(t,e),t.TitleCells.loadFromJSON(e.ColumnTitleCell)},prepare:function(){function e(t){var n=1;return t.showingItems=[],t.forEach((function(a){var i,l,s;a.layer=o,a.GroupTitle?a.Visible&&(o++,i=e(a.SubTitles)+1,o--,l=a.SubTitles.showingItems,l.length>0&&(t.showingItems.push(a),i>n&&(n=i),a.colspan=0,l.forEach((function(e){a.colspan+=e.colspan})))):(s=a.Column,s.Visible&&s.pxWidth>0&&(t.showingItems.push(a),a.colspan=1,s.pxLeft=r.columnsTotalWidth,s.index=r.showingColumns.length,r.columnsTotalWidth+=s.pxWidth,r.showingColumns.push(s)))})),n}var t=this,r=t.owner,o=0;Ye.prototype.prepare.call(t),r.columnsTotalWidth=0,r.showingColumns=[],t.layerCount=e(t.TitleCells),t.pxHeight/=t.layerCount,t.TitleCells.prepare(),t.defaultStyle=t.report.viewer.selectSectionItem(t)},unprepare:function(){var e=this;Ye.prototype.unprepare.call(e),e.TitleCells.unprepare()},doGenerate:function(e){function t(e){e.forEach((function(e){e.layer===o.generatingLayer&&e.generate(r),e.GroupTitle&&t(e.SubTitles.showingItems)}))}var r,o=this,n=o.report.viewer;for(o.pxHeight/=o.layerCount,o.generatingLayer=0;o.generatingLayer<o.layerCount;)r=new S("tr",e),o.addElementEventClass(r),r.addClass(n.selectSection(o)),t(o.TitleCells.showingItems),o.generatingLayer++},FindColumnTitlesOfTitleCell:function(t){function r(t,o){var n,a,i,l=t.items.length;for(n=0;l>n;n++){if(a=t.items[n],a===o)return t;if(a.GroupTitle&&(i=r(a.SubTitles,o)))return i}return e}return r(this.TitleCells,t)},SetCellsBackColor:function(e){function t(r){r.forEach((function(r){r.BackColor=e,r.GroupTitle&&t(r.SubTitles)}))}t(this.TitleCells)},SetCellsForeColor:function(e){function t(r){r.forEach((function(r){r.setForeColor(e),r.GroupTitle&&t(r.SubTitles)}))}t(this.TitleCells)}},X(Ke,Ye);var Xe=function(e){var t=this;je.call(t,e),t.Height=t.report.cm2Size(1.2)};Xe.prototype={generate:function(e,t){var r=this,o=r.owner;o.recordset.MoveTo(t),o.owner.Recordset.MoveTo((r===o.Header?o.beginNoField:o.endNoField).Value),je.prototype.generate.call(r,e)},doGenerate:function(t){function r(e){var t=n.owner,r=n===t.Header?a.ATTR_GROUPH_INDEX:a.ATTR_GROUPF_INDEX;e.addAttribute(a.ATTR_GROUP_RECNO,t.recordset.recordNo),e.addAttribute(r,t.index)}var o,n=this,i=n.report.viewer,l=n.owner.owner,s=l.showingColumns,u=s.length;l.hasMergedColumn&&(o=[],s.forEach((function(e){e.mergedHeader&&e.mergedHeader.todoMerge&&(n.owner.Footer!==n||n.owner===l.Groups.Item(l.Groups.Count)&&e.mergedHeader!==n.owner.Header)&&o.push(e)})),o.length||(o=e)),n.tableRows&&!n.tableCols?(n.generateTableRows(t,o),t.children.slice(-n.tableRows.length).forEach((function(e){n.addElementEventClass(e),r(e)}))):(t=new S("tr",t),t.addClass(i.selectSection(n)),n.addElementEventClass(t),r(t),t=new S("td",t),u>1&&t.addAttribute("colspan",u),n.tableCols?(t=new S("table",t),t.addClass(i.selectSection(n)),t.addStyle("border-collapse","collapse"),n.generateTableRows(t)):(t.addStyle("position","relative"),n.Controls.generate(t)))},getTableColEdges:function(){var e,t=this.owner.owner.showingColumns;return e=t.map((function(e){return{pos:e.pxLeft,count:1}})),e.push({pos:t[t.length-1].pxRight,count:1}),e},getMergedColumns:function(){var e,t,r=this;return e=r.owner.index,t=r.owner.owner.showingColumns.filter((function(t){var o,n,a=t.mergedHeader;return a&&((n=(o=a.owner).index)<e||n===e&&r===o.Footer&&o.Header.IncludeFooter)})),0===t.length&&(t=0),t},getParentBackColor:function(e){return this.owner.owner.BackColor},getParentFont:function(){return this.owner.owner.Font},_runningNo:function(){return this.owner.recordset.RecordNo+1}},X(Xe,je);var Ze=function(e){var t=this;Xe.call(t,e),t.OccupiedColumns="",t.OccupyColumn=!1,t.SameAsColumn=!0,t.IncludeFooter=!1,t.VAlign=1};Ze.prototype={afterLoad:function(e){var t=this;Xe.prototype.afterLoad.call(t,e),F(t,"VAlign",n.OCGroupHeaderVAlign)},prepare:function(){var e,t=this;t.OccupiedColumns&&(e=t.owner.owner.Columns.decodeItems(t.OccupiedColumns),e=e.filter((function(e){return e.Visible})),e.length>0&&(t.groupMergedColumns=e,e.forEach((function(e){e.mergedHeader=t,t.owner.owner.hasMergedColumn=1})))),(!t.groupMergedColumns||!t.SameAsColumn)&&Xe.prototype.prepare.call(t)},unprepare:function(){},generate:function(e,t){var r=this;r.groupMergedColumns?(r.owner.recordset.MoveTo(t),r.curItemBegin=e.children?e.children.length:0,r.todoMerge=1):Xe.prototype.generate.call(r,e,t)},get Group(){return this.owner}},X(Ze,Xe);var Qe=function(e){Xe.call(this,e)};Qe.prototype={generate:function(e,t){var r,o=this,n=o.owner.Header,a=n.groupMergedColumns;Xe.prototype.generate.call(o,e,t),a&&e.children&&(r=e.children.length-n.curItemBegin,!n.IncludeFooter&&o.isToGenerate()&&r--,r>1&&a.forEach((function(e){e.mergingElement&&e.mergingElement.addAttribute("rowspan",r+"")})))},get Group(){return this.owner}},X(Qe,Xe);var $e=function(t){var r=this;Te.call(r,t),r.FieldType=1,r._name="",r._dbFieldName="",r._tableMember=e,r.Format="",r.Length=0,r.RTrimBlankChars=!1,r.GetDisplayTextScript=""};$e.prototype={afterLoad:function(e){var t,r=this;t=e[r.getJsonMember("Type")],t&&(r.FieldType=t),t=e[r.getJsonMember("Name")],t&&(r.Name=t),t=e[r.getJsonMember("DBFieldName")],t&&(r.DBFieldName=t),F(r,"FieldType",n.FieldType)},prepare:function(){var e=this,t=e.FieldType,r=e.Format;6===t?e.formater=new d(r):5===t?e.formater=new c(r):2!==t&&3!==t&&4!==t||(e.formater=new p(r))},unprepare:function(){var e=this;delete e.formater,delete e._fts},isNumeric:function(){var e=this.FieldType;return 2===e||3===e||4===e},valUeq:function(t){var r=this.Value,o=t.Value;return o>r||r>o||(r===e||o===e)&&r!==o},get Value(){var t=this,r=t.owner.curRecord;return r?r[t._tableMember]:e},set Value(t){var r=this,o=r.owner.curRecord;if(o){if(t!==e&&null!==t)switch(r.FieldType){case 2:case 3:case 4:t=+t;break;case 5:t=G(t);break;case 6:t=I(t);break;default:t+=""}else t=e;o[r._tableMember]=t}},get AsBoolean(){return G(this.Value)},set AsBoolean(e){this.Value=e},get AsCurrency(){return+this.Value},set AsCurrency(e){this.Value=e},get AsDateTime(){return N(this.Value)},set AsDateTime(e){this.Value=e},get AsFloat(){var e,t=this;if(t.IsNull)e=0;else if(6===t.FieldType){var r=new g;r.value=t.Value,e=r.AsFloat}else e=+t.Value;return isNaN(e)?0:e},set AsFloat(e){var t,r=this;6===r.FieldType&&(t=new g,t.AsFloat=e,e=t.value),r.Value=e},get AsInteger(){return Math.floor(this.AsFloat)},set AsInteger(e){this.AsFloat=Math.floor(+e)},get AsString(){var e=this;return e.IsNull?"":e.Value+""},set AsString(e){this.Value=e},get DisplayText(){var e=this,t=e.FieldType,r=e.Value;return e.displayTextAssigned=0,e.doingGetDisplayText||(e.doingGetDisplayText=1,e.report.fireFieldGetDisplayText(e),e.doingGetDisplayText=0),e.displayTextAssigned?e.assignedDisplayText:e.IsNull?"":1===t||7===t?r+"":e.formater.format(r)},set DisplayText(e){var t=this;t.assignedDisplayText=e+"",t.displayTextAssigned=1},get IsNull(){var t=this.Value;return t===e||null===t},get DataSize(){return 0},get DataBuffer(){return e},get Name(){return this._name},set Name(e){var t=this;t._tableMember&&t._tableMember!==t._name||(t._tableMember=e),t._name=e},get DBFieldName(){return this._name},set DBFieldName(e){var t=this;t._dbFieldName=e,e&&(t._tableMember=e)},get RunningDBField(){var e=this;return e._dbFieldName||e._name},Clear:function(){this.Value=e}},X($e,Te);var et=function(e){var t=this;Te.call(t,e),t.QuerySQL="",t.Fields=new ge(t),t.SortAsc=!0,t.SortCaseSensitive=!1,t.SortFields="",t.XmlTableName="",t.FetchRecordScript="",t.BeforePostRecordScript="",t.ProcessRecordScript="",t._dataTable=[],t.recordNo=0};et.prototype={children:["Fields"],afterLoad:function(e){this.Fields.loadFromJSON(e.Field)},attachDataTable:function(e){var t=this;t._dataTable=e,t.MoveTo(0)},appendRefRecord:function(e){this._dataTable.push(e)},prepareTableData:function(){function t(t,r){if(t.hasOwnProperty(r))return r;for(var o in r=r.toUpperCase(),t)if(r===o.toUpperCase())return o;return e}var r,o,n,a,i,l=this,s=l._dataTable,u=l.Fields.items,c=s.length,d=u.length;if(DEBUG)for(;d--;)o=u[d];for(;c--;)for(r=s[c],d=u.length;d--;){if(o=u[d],i=o._fts,a=o._tableMember,i===e&&(a=t(r,a))){switch(o.FieldType){case 1:i="string"!=typeof r[a];break;case 2:case 3:case 4:i="number"!=typeof r[a];break;case 5:i="boolean"!=typeof r[a];break;case 6:i=!Date.prototype.isPrototypeOf(r[a]);break;default:i=!1}o._fts=i,o._tableMember=a}if(a&&(n=r[a],null!==n&&""!==n||(n=e,r[a]=n),i&&n!==e))switch(o.FieldType){case 1:r[a]=n+"";break;case 2:case 3:case 4:r[a]=+n;break;case 5:r[a]=G(n);break;case 6:r[a]=L(n)}}l.SortFields&&l.Resort(l.SortFields,l.SortAsc,l.SortCaseSensitive)},prepare:function(){var e=this,t=e._dataTable.length,r=0;for(e.Fields.prepare(),e.prepareTableData();t>r;)e.MoveTo(r++),e.beforePost();e.MoveTo(0)},unprepare:function(){var e=this;e.Fields.unprepare(),e._dataTable=[]},beforePost:function(){var e=this,t=e.report,r=e.BeforePostRecordScript;r&&t.executeEventScript(r,"BeforePostRecordScript",e),e.isDetailGridRecordset()&&t.fireBeforePostRecord()},decodeFields:function(e){return this.Fields.decodeItems(e)},isDetailGridRecordset:function(){var e=this;return e.owner===e.report.DetailGrid},isAppendingRecord:function(){return 1===this.editStatus},keepValue:function(){var e=this;e.keepedRecord=e.curRecord},fieldsKeepedValueChanged:function(t){var r=this;return t.some((function(t){var o=t._tableMember,n=r.keepedRecord[o],a=r.curRecord[o];return a>n||n>a||(n===e||a===e)&&n!==a}))},sortRecords:function(t,r){for(var o=this,n=o._dataTable,a=n.length,i=0,l=[];a>i;)l.push(i++);return t.length>0&&(t.forEach((function(e){e.fieldName=e.field._tableMember})),l.sort((function(r,o){var a;return t.some((function(t){var i=n[r][t.fieldName],l=n[o][t.fieldName];return i!==e&&l!==e?1===t.field.FieldType?(t["case"]||(i=i.toUpperCase(),l=l.toUpperCase()),a=i.localeCompare(l)):a=l>i?-1:i>l?1:0:a=i===e&&l===e?0:i===e?-1:1,t.asc||(a=-a),a})),a}))),r?l:(i=[],l.forEach((function(e){i.push(n[e])})),o._dataTable=i,void o.MoveTo(0))},get RecordCount(){var e=this;return e._dataTable?e._dataTable.length:0},get RecordNo(){return this.recordNo},FieldByName:function(e){return this.Fields.itemByName(e)},FieldByDBName:function(t){var r,o=this.Fields.items,n=o.length;for(t=t.toUpperCase(),r=0;n>r;r++)if(o[r].RunningDBField.toUpperCase()===t)return o[r];return e},Append:function(){var e=this;e.editStatus=1,e.recordNo=e._dataTable.length,e.curRecord={}},Edit:function(){var t,r,o=this,n=o.Fields.items,a=n.length,i=o.curRecord,l={};if(o.recordNo>=0&&o.recordNo<o._dataTable.length){for(o.editStatus=2;a--;)t=n[a],r=t._tableMember,i[r]!==e&&(6===t.FieldType?l[r]=I(i[r]):l[r]=i[r]);o.curRecord=l}},Cancel:function(){var e=this;e.editStatus&&(1===e.editStatus?e.Last():e.curRecord=e._dataTable[e.recordNo],e.editStatus=0)},Post:function(){var e=this,t=e._dataTable;e.editStatus&&(e.beforePost(),1===e.editStatus?t.push(e.curRecord):t[e.recordNo]=e.curRecord,e.editStatus=0)},First:function(){this.MoveTo(0)},Next:function(){var e=this;e.MoveTo(e.recordNo+1)},Prior:function(){var e=this;e.MoveTo(e.recordNo-1)},Last:function(){var e=this;e.MoveTo(e._dataTable.length-1)},MoveBy:function(e){var t=this;t.MoveTo(t.recordNo+e)},Bof:function(){var e=this;return e.recordNo<0||!e._dataTable.length},Eof:function(){var e=this;return e.recordNo>=e._dataTable.length},MoveTo:function(e){var t=this,r=t._dataTable;t.recordNo=e,t.curRecord=r[Math.min(Math.max(0,e),r.length-1)]},Empty:function(){this.attachDataTable([])},AddField:function(e,t){var r=this.Fields.Add();return r.Name=e,r.FieldType=t,r},RemoveAllFields:function(){this.Fields.RemoveAll()},Resort:function(e,t,r){function o(){var o=[],n=e.split(";");return n.forEach((function(e){function n(e){e=e.trim().toUpperCase(),"ASC"===e?l.asc=!0:"DESC"===e?l.asc=!1:"CASE"===e?l["case"]=!0:"CASEIN"===e&&(l["case"]=!1)}var a,l={};e=e.trim(),a=e.split(" "),a[0]=a[0].trim(),l.field=i.Fields.Item(a[0]),l.field&&(l.asc=t,l["case"]=r,a.length>1&&n(a[1]),a.length>2&&n(a[2]),o.push(l))})),o}var n,a,i=this,l=[];e&&(n=o(),a=n.length,a>0&&(i.report.fireBeforeSort(e,i),i.isDetailGridRecordset()&&(i.owner.Groups.forEach((function(e){i.decodeFields(e.ByFields).forEach((function(e){l.indexOf(e)<0&&l.push(e)}))})),n.forEach((function(e){var t=l.indexOf(e.field);0>t?l.push(e):l[t]=e})),l.forEach((function(e,o){e.field||(l[o]={field:e,asc:t,case:r})})),n=l,a=n.length)),i.sortRecords(n,0))},FilterByStep:function(e,t){var r=this,o=r.RecordCount(),n=0;if(r._dataTable&&!r.isAppendingRecord()&&e>0){for(r.FilterBegin();o>n;)r.MoveTo(n),r.FilterSelect(),n+=e;t&&n-e+1!=o&&(r.Last(),r.FilterSelect()),r.FilterEnd()}},FilterByCount:function(e){var t,r,o=this,n=o.RecordCount(),a=0;if(o._dataTable&&!o.isAppendingRecord()&&e>1&n>e){for(t=(n-1)/(e-1),o.FilterBegin();n>a;)r=Math.round(a),o.MoveTo(r),o.FilterSelect(),a+=t;o.FilterEnd()}},FilterBegin:function(){this._dtf=[]},FilterEnd:function(){var e=this,t=e._dataTable;e._dtf&&(e._dataTable=e._dtf,e._dtf=t)},FilterSelect:function(){var e=this;e._dtf&&!e.isAppendingRecord()&&!e.Bof()&&!e.Eof()&&e._dtf.push(e.curRecord)},FilterReset:function(){var e=this;e._dtf&&(e._dataTable=e._dtf,delete e._dtf)}},X(et,Te);var tt=function(e){var t=this;Te.call(t,e),t.Name="",t.Visible=!0,t.FixedWidth=!1,t.Width=t.report.cm2Size(3)};tt.prototype={prepare:function(){var e=this;e.pxWidth=e.report.size2Pixel(e.Width)},get pxRight(){var e=this;return e.pxLeft+e.pxWidth}},X(tt,Te);var rt=function(e){var t=this;Te.call(t,e),t.Header=new Ze(t),t.Footer=new Qe(t),t.Name="",t.ByFields="",t.SortSummaryBox="",t.SortAsc=!1,t.GroupBeginScript="",t.GroupEndScript=""};rt.prototype={children:["Header","Footer"],afterLoad:function(e){var t=this;t.Header.loadFromJSON(e.GroupHeader),t.Footer.loadFromJSON(e.GroupFooter)},prepare:function(e){function t(e){e.forEach((function(e){function o(e){function n(e){var t,o,n,i=a.length+"",l="";a.push(e),e.SummaryFun?(e.value=0,28===e.SummaryFun&&(t=r.owner.Groups.indexOf(r),t>0&&(o=new h,o.SummaryFun=-1,o.init(),r.owner.Groups.items[t-1].summaryItems.push(o))),e.displayField?(n=e.displayField.FieldType,l=e.displayField.Format):(n=18===e.SummaryFun||19===e.SummaryFun?1:3,e.paramExp&&(o=e.paramExp.varItems,1===o.length&&(o=o[0].varField.object,o.Format&&(l=o.Format))))):e.oParameter?(n=e.oParameter.DataType,l=e.oParameter.Format):n=3,e.valueField=r.recordset.AddField(i,n),e.valueField.Format=l}var a=r.summaryItems,i=e.ControlType;5===i?n(e):8===i?Ee.prototype.getGroupVars.call(e).forEach((function(e){n(e)})):1===i?e.oParameter&&n(e):13===i&&e.cells.forEach((function(e){e.forEach((function(e){e.FreeCell?t(e.Controls):o(e)}))}))}o(e)}))}var r=this;r.index=e,r.Header.prepare(),r.Footer.prepare(),r.oByFields=r.owner.Recordset.decodeFields(r.ByFields),r.SortSummaryBox&&(r.sortSummaryBoxObj=r.Footer.Controls.itemByName(r.SortSummaryBox),r.sortSummaryBoxObj||(r.sortSummaryBoxObj=r.Header.Controls.itemByName(r.SortSummaryBox)),r.sortSummaryBoxObj&&5!==r.sortSummaryBoxObj.ControlType&&delete r.sortSummaryBoxObj),r.recordset=new et(r),r.beginNoField=r.recordset.AddField("b",2),r.endNoField=r.recordset.AddField("e",2),r.groupItemNo=0,r.summaryItems=[],t(r.Header.Controls),t(r.Footer.Controls),r.recordset.prepare()},unprepare:function(){},inphaseByDetail:function(e){var t=this,r=t.recordset;if(!r.isAppendingRecord()&&r.RecordCount){for(;t.beginNoField.Value>e&&!r.Bof();)r.Prior();for(;t.endNoField.Value<e&&!r.Eof();)r.Next()}},get Parent(){return this.owner}},X(rt,Te);var ot=function(e){var t=this;Te.call(t,e),t.FixCols=0,t.BackColor=e.BackColor,t.ShowColLine=!0,t.ShowRowLine=!0,t.Font=new T(e.Font),t.Border=new C(15),t.ColLinePen=new _,t.RowLinePen=new _,t.Recordset=new et(t),t.ColumnContent=new Je(t),t.ColumnTitle=new Ke(t),t.Columns=new pe(t),t.Groups=new me(t)};ot.prototype={children:["Border","ColLinePen","RowLinePen","Recordset","Groups"],afterLoad:function(e){var t=this,r=t.report.viewer.alpha,o=t.report.isWR;E(t,"BackColor",r.background),t.Border.loadFromJSON(e.Border,r.border,o),t.ColLinePen.loadFromJSON(e.ColLine,r.stroke,o),t.RowLinePen.loadFromJSON(e.RowLine,r.stroke,o),t.Font.loadFromJSON(e.Font,o),t.Recordset.loadFromJSON(e.Recordset),t.Groups.loadFromJSON(e.Group),t.Columns.loadFromJSON(e.Column),t.ColumnContent.loadFromJSON(e.ColumnContent),t.ColumnTitle.loadFromJSON(e.ColumnTitle),t.IsCrossTab=e[t.getJsonMember("IsCrossTab")],t.IsCrossTab&&t.CrossTab.loadFromJSON(e.CrossTab)},assign:function(e){function t(e,o){o.forEach((function(o){var n;o.GroupTitle?(n=e.AddGroup("",""),n.assign(o),t(n.SubTitles,o.SubTitles)):(n=r.Columns.addTo(e),n.assign(o.Column),n.TitleCell.assign(o),n.ContentCell.assign(o.Column.ContentCell))}))}var r=this;Te.prototype.assign.call(r,e),r.ColumnContent.assign(e.ColumnContent),r.ColumnTitle.assign(e.ColumnTitle),t(r.ColumnTitle.TitleCells,e.ColumnTitle.TitleCells),r.IsCrossTab=e.IsCrossTab,r.IsCrossTab&&r.CrossTab.assign(e.CrossTab)},attachData:function(){function e(t){t.forEach((function(t){t.attachData(),t.GroupTitle&&e(t.SubTitles)}))}var t=this;t.Recordset.prepare(),t.ColumnContent.ContentCells.forEach((function(e){e.attachData()})),e(t.ColumnTitle.TitleCells),t.Groups.forEach((function(e){e.Header.Controls.attachData(),e.Footer.Controls.attachData()}))},buildColumnsOrder:function(){function e(t){t.forEach((function(t){t.GroupTitle?e(t.SubTitles):(t.Column.orderNo=r.length,r.push(t.Column))}))}var t=this,r=[];e(t.ColumnTitle.TitleCells),t.Columns.items=r},beginGroupItem:function(e){var t=this;t.rows.push({header:e.Header,recordNo:e.groupItemNo}),e.recordset.Append(),e.beginNoField.Value=t.Recordset.recordNo,e.groupRecordCount=0,e.summaryItems.forEach((function(e){e.SummaryFun&&e.beginSummaryValue()})),t.report.fireGroupBegin(e)},endGroupItem:function(t){var r,o,n=this,a=n.report,i=t.summaryItems,l=i.length;for(n.rows.push({footer:t.Footer,recordNo:t.groupItemNo++}),a.fireGroupEnd(t),i.forEach((function(e){e.SummaryFun&&e.endSummaryValue()}));l-- >0;)r=i[l],o=r.SummaryFun,o?-1!==o&&r.value!==e&&(r.valueField.AsFloat=r.value):r.MathFun?r.valueField.Value=r.getAsFloat():r.valueField.Value=r.oParameter.Value;a.DetailGrid.CrossTab&&a.DetailGrid.CrossTab.GroupEndProcess(t),t.endNoField.Value=Math.min(n.Recordset.recordNo,n.Recordset.RecordCount-1),t.recordset.Post()},prepare:function(){function e(r){r.forEach((function(r){function o(r){var n=t.globalSummaryItems,a=r.ControlType;5===a?n.push(r):8===a?Ee.prototype.getGroupVars.call(r).forEach((function(e){e.SummaryFun&&n.push(e)})):13===a&&r.cells.forEach((function(t){t.forEach((function(t){t.FreeCell?e(t.Controls):o(t)}))}))}o(r)}))}var t=this,r=t.report;t.CrossTab?(t.buildColumnsOrder(),t.CrossTab.prepare()):(t.Columns.prepare(),t.ColumnContent.prepare(),t.ColumnTitle.prepare(),t.Groups.forEach((function(e,t){e.prepare(t)})),t.globalSummaryItems=[],r.ReportHeaders.items.concat(r.ReportFooters.items).forEach((function(t){e(t.Controls)})))},unprepare:function(){var e=this;e.CrossTab&&e.CrossTab.unprepare(),e.Recordset.unprepare(),e.ColumnContent.unprepare(),e.ColumnTitle.unprepare(),e.Groups.forEach((function(e,t){e.unprepare(t)}))},generate:function(e,t){function r(){var e=i.ownerReport,t=i.detailgridResize;return 1===t||2===t&&window.innerWidth&&n.width<window.innerWidth&&(!e||e.owner._singleSR)}var o,n=this,i=n.report,l=n.Recordset,s=n.Border,u=i.viewer,c=u._detailgrids,d="title"==t,p="content"==t,h=new S("table",e),f=new S("colgroup",h);h.addClass(a.CSS_DG),n.Font.font&&h.addClass(u.selectFont2(n.Font.font)),d&&(s=s.clone(),s.Styles&=-9),p&&(s=s.clone(),s.Styles&=-3),h.styles.addBorder(s),h.addStyle("border-collapse","collapse"),h.addStyle("width",r()?"100%":M(n.width)),n.toFillBack()&&h.addBackColorStyle(n.BackColor),n.showingColumns.forEach((function(e){var t=new S("col",f);t.skipend=1,t.addStyle("width",k(100*e.pxWidth/n.columnsTotalWidth))})),p||n.ColumnTitle.generate(new S("thead",h)),d||(h.addAttribute("id",u._getDetailGridID(c.length)),c.push(n),l._relTblIndex>=0&&h.addAttribute("_grrelTblIndex",l._relTblIndex),o=new S("tbody",h),n.generatingRowNo=1,n.rows.forEach((function(e,t){var r;e.header?(r=e.header,r.generate(o,e.recordNo)):e.footer?(r=e.footer,r.generate(o,e.recordNo)):(r=n.ColumnContent,r.generate(o,e)),r.Visible&&r.Height>0&&++n.generatingRowNo})))},buildRows:function(){function e(e){e.summaryItems.forEach((function(e){e.SummaryFun&&e.summaryCurRecord()})),e.groupRecordCount++}function t(e){function t(){var t,r=l.length,o=e.owner.rows,n=[];1>=r||(t=l[0].beginRowNo,l.forEach((function(t){e.recordset.MoveTo(t.groupItemNo),t.sortValue=e.sortSummaryBoxObj.valueField.AsFloat})),l.sort((function(t,r){return e.SortAsc?t.sortValue-r.sortValue:r.sortValue-t.sortValue})),l.forEach((function(e){n=n.concat(o.slice(e.beginRowNo,e.endRowNo))})),n.forEach((function(e){o[t++]=e})))}var r,o,n,a=e.owner.rows,i=a.length,l=[];for(r=0;i>r;){for(n={},o=a[r],o.footer&&o.footer.owner.index<e.index&&(t(),l=[],r++);i>r;)if(o=a[r++],o.header&&o.header.owner.index===e.index){n.beginRowNo=r-1,n.groupItemNo=o.recordNo;break}for(;i>r;)if(o=a[r++],o.footer&&o.footer.owner.index===e.index){n.endRowNo=r,l.push(n);break}}t()}var r,o,n,a=this,i=a.report,l=a.Recordset,s=a.Groups.items,u=s.length,c=0;for(a.rows=[],a.globalSummaryItems.forEach((function(e){e.beginSummaryValue()})),l.First(),l.keepValue(),s.forEach((function(e){a.beginGroupItem(e)}));!l.Eof();){for(r=0;u>r&&!l.fieldsKeepedValueChanged(s[r].oByFields);r++);if(u>r){for(l.Prior(),o=u-1;o>=r;o--)a.endGroupItem(s[o]);for(l.Next(),o=r;u>o;o++)a.beginGroupItem(s[o])}i.fireProcessRecord(l),s.forEach((function(t){e(t)})),a.globalSummaryItems.forEach((function(e){e.summaryCurRecord()})),a.rows.push(l.recordNo),l.keepValue(),l.Next()}for(i.fireProcessEnd(),o=u-1;o>=0;o--)a.endGroupItem(s[o]);a.globalSummaryItems.forEach((function(e){e.endSummaryValue()})),s.forEach((function(e){e.sortSummaryBoxObj&&(t(e),c=1)})),c&&(n=[],o=0,a.sortedTable=[],s.forEach((function(e){e.sortedTable=[],e.groupItemNo=0})),a.rows.forEach((function(e){var t;e.header?(t=e.header.owner,t.recordset.MoveTo(e.recordNo),t.recordset.Edit(),t.beginNoField.Value=o,e.recordNo=t.groupItemNo):e.footer?(t=e.footer.owner,t.endNoField.Value=o,t.recordset.Post(),t.sortedTable.push(t.recordset._dataTable[e.recordNo]),e.recordNo=t.groupItemNo++):(a.sortedTable.push(l._dataTable[e]),e=o++),n.push(e)})),a.rows=n,l.attachDataTable(a.sortedTable),delete a.sortedTable,s.forEach((function(e){e.recordset.attachDataTable(e.sortedTable),delete e.sortedTable})))},syncTRData:function(e){function t(t){var r=e.parentNode.parentNode;r.hasAttribute("_grrelTblIndex")&&i.report.ownerSR.attachRelationTable2(r.getAttribute("_grrelTblIndex")),i.Recordset.MoveTo(t)}var r,o,n,i=this,l=1,s={};return(o=e.getAttribute(a.ATTR_CONTENT_RECNO))?(t(o),s.content=i.ColumnContent):(o=e.getAttribute(a.ATTR_GROUP_RECNO))&&(n=e.getAttribute(a.ATTR_GROUPH_INDEX),n||(n=e.getAttribute(a.ATTR_GROUPF_INDEX),l=0),r=s.group=i.Groups.items[n],r.recordset.MoveTo(o),t((l?r.beginNoField:r.endNoField).Value)),s},syncElementData:function(e,t){function r(e,t){var r,o=e.tagName.toUpperCase();if("TH"===o||"TABLE"===o)return 0;do{if(r&&(e=r.parentNode,o=e.tagName.toUpperCase(),"TH"===o))return 0;for(;"TD"!==o;){if(e=e.parentNode,!e)return 0;if(o=e.tagName.toUpperCase(),"TH"===o)return 0}if(r=e.parentNode.parentNode.parentNode,!t&&r.classList.contains(a.CSS_DG))break}while(t!==r);return e}var o=this,n=r(e,t);n&&o.syncTRData(n.parentNode)},onmousedown:function(e){function t(){var t,r,o,n=e.target;if("TABLE"===n.tagName.toUpperCase())return 0;for(;!o;){if(r&&(n=r.parentNode.parentNode.parentNode),t=n.tagName.toUpperCase(),"TH"===t)return 0;for(;"TD"!==t;)if(n=n.parentNode,t=n.tagName.toUpperCase(),"TH"===t)return 0;r=n.parentNode,o=r.hasAttribute(a.ATTR_CONTENT_RECNO)||r.hasAttribute(a.ATTR_GROUP_RECNO)}return n}function r(t){var r=o.curSelObj,n=o.report.viewer.options,i=t.parentNode,l=n.selectionCell?t:i;i.parentNode.parentNode===e.currentTarget&&n.selectionHighlight&&(r===l?l.classList.toggle(a.CSS_SH):(r&&r.classList.remove(a.CSS_SH),l.classList.add(a.CSS_SH),o.curSelObj=l)),o.clickedCell=t}var o=this,n=t();n&&r(n),o.syncElementData(e.target,e.currentTarget)},getClickedRow:function(){var e,t,r,o=this,n=o.clickedCell,i={};return n&&(e=n.parentNode,(r=e.getAttribute(a.ATTR_CONTENT_RECNO))?(i.type="content",i.recordNo=r):(r=e.getAttribute(a.ATTR_GROUP_RECNO))&&(t=e.hasAttribute(a.ATTR_GROUPH_INDEX),i.type=t?"groupheader":"groupfooter",i.groupIndex=+e.getAttribute(t?a.ATTR_GROUPH_INDEX:a.ATTR_GROUPF_INDEX))),i},clearColumns:function(){var e=this;e.ColumnContent.ContentCells.RemoveAll(),e.ColumnTitle.TitleCells.RemoveAll(),e.Columns.RemoveAll()},get width(){var e=this,t=e.Border;return e.columnsTotalWidth+t.getLeftWidth()+t.getRightWidth()},_ColumnMoveTo:function(e,t){var r=this,o=r.ColumnTitle.FindColumnTitlesOfTitleCell(e.TitleCell),n=t?t.SubTitles:r.ColumnTitle.TitleCells;r.MoveTitleTo(e.TitleCell,o,n,-1)},MoveTitleTo:function(e,t,r,o){t.items.splice(t.items.indexOf(e),1),0>o?r.items.push(e):r.items.splice(o,0,e)},get IsCrossTab(){return!!this.CrossTab},set IsCrossTab(e){var t=this;e?t.CrossTab||(t.CrossTab=new xt(t)):delete t.CrossTab},AddColumn:function(e,t,r,o){var n=this.Columns.Add();return n.Name=e,n.Width=o,n.ContentCell.DataField=r,n.TitleCell.Text=t,n},ClearColumns:function(){this.Columns.RemoveAll()},FindGroupTitleCell:function(e){function t(r){var o,n=r.items.length,a=r.itemByName(e);if(!a)for(o=0;n>o;o++)if(a=r.items[o],a.GroupTitle&&(a=t(a.SubTitles,e)))return a;return a}return t(this.ColumnTitle.TitleCells,e)},AddGroupTitle:function(e,t){return this.ColumnTitle.TitleCells.AddGroup(e,t)},ClearGroupTitles:function(){var e,t,r=this,o=r.Columns.Count,n=r.ColumnTitle.TitleCells,a=[];for(e=1;o>=e;e++)ColumnMoveToEnd(e);for(o=n.Count,e=0;o>e;e++)t=n.items[e],!t.GroupTitle&&a.push(t);n.items=a},ColumnMoveToEnd:function(t){var r=this,o=r.Columns.Item(t);o&&sel._ColumnMoveTo(o,e)},ColumnMoveTo:function(t,r,o){var n,a=this,i=a.Columns.Item(t),l=i?i.TitleCell:a.FindGroupTitleCell(t),s=r?a.FindGroupTitleCell(r):e,u=r?s?s.SubTitles:e:a.ColumnTitle.TitleCells;l&&u&&(n=a.ColumnTitle.FindColumnTitlesOfTitleCell(l),a.MoveTitleTo(l,n,u,o))},StartNewGroup:function(e){var t,r=this,o=r.Recordset,n=r.Groups.items,a=n.length,i=r.Groups.Item(e);if(i){for(o.Prior(),t=a-1;t>=i.index;t--)r.endGroupItem(n[t]);for(o.Next(),t=i.index;a>t;t++)r.beginGroupItem(n[t])}},ColumnByShowOrder:function(t){function r(t,o,n){var a,i,l=t.Count;for(a=0;l>a;a++)if(i=t.items[a],i.GroupTitle){if(i=r(i.SubTitles,o,n))return i}else{if(o==n)return i;o++}return e}var o=0;return r(this.ColumnTitle.TitleCells,o,t)}},X(ot,Te);var nt=function(t){var r=this;Te.call(r,t),r.DataType=1,r.Name="",r.Format="",r.Value=e};nt.prototype={afterLoad:function(t){var r=this;F(r,"DataType",n.ParameterDataType),r.Value!==e&&r.setValue(r.Value)},prepare:function(){var e=this,t=e.DataType,r=e.Format;2===t||3===t?e.formater=new p(r):6===t?e.formater=new d(r):5===t&&(e.formater=new c(r))},unprepare:function(){delete this.formater},setValue:function(t){var r=this;if(null!==t&&t!==e)switch(r.DataType){case 2:t=Math.floor(+t);break;case 3:t=+t;break;case 5:t=G(t);break;case 6:t=L(t);break;default:t+=""}else t=e;r.Value=t},get AsBoolean(){return!!this.Value},set AsBoolean(e){this.setValue(e)},get AsDateTime(){return I(this.Value)},set AsDateTime(e){this.setValue(e)},get AsFloat(){var e=this,t=e.Value;if(6===e.DataType){var r=new g;r.value=t,t=r.AsFloat}else t=+t;return isNaN(t)?0:t},set AsFloat(e){var t,r=this;6===r.DataType&&(t=new g,t.AsFloat=e,e=t.value),r.setValue(e)},get AsInteger(){return Math.floor(this.AsFloat)},set AsInteger(e){this.AsFloat=Math.floor(+e)},get AsString(){var t=this.Value;return t===e?"":t+""},set AsString(e){this.setValue(e)},get DisplayText(){var t=this,r=t.Value;if(r===e)return"";switch(t.DataType){case 1:return r+"";default:return t.formater.format(r)}},get IsNull(){return this.Value===e},Clear:function(){this.Value=e}},X(nt,Te);var at=function(t,r){var o=this;t=t||{alpha:{background:1}},o.viewer=t,o.report=o,r&&(o.ownerSR=r),o.Font=new T(e),o.Font.font=new v,o.Parameters=new ve(o),o.ReportHeaders=new _e(o),o.ReportFooters=new Ce(o),o.XmlTableName="",o.Unit=1,o.CodePage=65001,o.BackColor=16777215|t.alpha.background<<24,o.QuerySQL="",o.Title="",o.Author="",o.Description="",o.GlobalScript="",o.InitializeScript="",o.ProcessBeginScript="",o.ProcessEndScript="",o.BeforeSortScript="",o.Printer={DesignPaperWidth:21,DesignPaperLength:29.7,DesignPaperLeftMargin:2.5,DesignPaperRightMargin:2.5,DesignPaperOrientation:1}};at.prototype={load:function(e){var t=this;"string"==typeof e&&(t.isWR="_WR_"===e.substr(0,4),t.isWR&&(e=gr.wr.decodeWR(e)),e=JSON.parse(e)),t.loadFromJSON(e)},loadFromJSON:function(t){function r(e){return l[a?ae(e):e]}var o,n=this,a=n.isWR,i=n.Printer,l=t.Printer;n.Clear(),D(n,t),E(n,"BackColor",n.viewer.alpha.background),n.Font.loadFromJSON(t.Font,a),n.Parameters.loadFromJSON(t.Parameter),n.ReportHeaders.loadFromJSON(t.ReportHeader),n.ReportFooters.loadFromJSON(t.ReportFooter),t.DetailGrid&&n.InsertDetailGrid().loadFromJSON(t.DetailGrid),l&&(o=r("Width"),o&&(i.DesignPaperWidth=o),o=r("Height"),o&&(i.DesignPaperLength=o),o=r("LeftMargin"),o!==e&&(i.DesignPaperLeftMargin=o),o=r("RightMargin"),o!==e&&(i.DesignPaperRightMargin=o),o=r("Oriention"),o&&(i.DesignPaperOrientation=2),n.Printer=i)},generateHtml:function(){function e(t,r){r&&(t.push(r.beginText()),r.children?r.children.forEach((function(r){e(t,r)})):t.push(r.innerText),t.push(r.endText()),DEBUG&&t.push("\r\n"))}var t=this,r=[],o={htmlElements:[],addChild:function(e){o.htmlElements.push(e)}};return t.generate(o),o.htmlElements.forEach((function(t){e(r,t)})),r.join("")},generate:function(e){var t,r,o,n,a,i=this,l=i.viewer,s=i.fixedHeaderFooter,u=i.ReportHeaders,c=i.ReportFooters;s&&(r=new y,r.add("padding-right","17px"),o=l.addCustomStyle(r),l.fixedDivClass=o,r=new y,r.add("overflow-y","scroll"),n=l.addCustomStyle(r),l.bodyDivClass=n),i.fireInitialize(),!i.ownerSR&&i.matchTables(),i.DetailGrid&&i.fireFetchRecord(),i.fireProcessBegin(),!i.ownerSR&&i.prepare(),i.singleChart?i.singleChart.generateContent(e):(t=i.RunningDetailGrid,i.reportFitHeight&&ue(u.items.concat(c.items)),t&&t.buildRows(i),s?(a=new S("div",e),a.addClass(l._getCSSName(o)),u.generate(a),t.generate(a,"title"),a=new S("div",e),a.addClass(l._getCSSName(n)),t.generate(a,"content"),c.Count&&(a=new S("div",e),a.addClass(l._getCSSName(o)),c.generate(a))):(u.generate(e),t&&t.generate(e),c.generate(e))),!t&&i.fireProcessEnd()},matchTables:function(){function e(e,t){function r(e){function t(e,t){var r=this;r.isRecordset=e,r.tableName=t.XmlTableName,r.object=t}var o,n,a;if(e)for(T.push(new t(!1,e)),e.DetailGrid&&T.push(new t(!0,e.DetailGrid.Recordset)),n=e.FindFirstControl();n;)a=n.ControlType,11===a?(o=n.Recordset,o.Fields.Count>0&&T.push(new t(!0,o))):9===a&&r(n.Report),n=e.FindNextControl()}function o(e,t,r){function o(e,t){var r,o=e.length,n=0;for(r=0;o>r;r++)t.indexOf(e[r])>=0&&n++;return 100*n/o}var n=t.recordCount,a=t.fieldNames,i=0;if(e.length&&t.fieldNames.length){if(i=o(e,a),!i)return 0;100===i&&e.length===a.length?i=200:i+=o(a,e),i+=r&&n>1||!r&&1===n?5:-5}return i}function n(e){return e>=200}function a(e){var t,r,o,n=[];for(t=e.Parameters.items.length;t--;)n.push(e.Parameters.items[t].Name.toUpperCase());for(r=e.FindFirstControl();r;)o=r.ControlType,1===o||8===o||7===o||12===o?n.push(r.Name.toUpperCase()):13===o&&r.cells.forEach((function(e){e.forEach((function(e){e.DataName&&n.push(e.DataName.toUpperCase())}))})),r=e.FindNextControl();return n}function i(e,t){for(var r,o,n=0,a=e.length;a>n;)o=e[n++],(!r||o.weight>r.weight)&&o.dataTableInfo.matchWeight<50&&(r=o);r&&l(r.weight,t,r.dataTableInfo)}function l(e,t,r){r.matchWeight<e&&(r.matchWeight=e,r.reportTableInfo=t)}var s,u,c,d,p,h,f,g,m,_,C,v,T=[];for(r(e),c=T.length,d=t.length,s=0;c>s;++s){if(p=T[s],f=p.tableName){for(u=0;d>u&&t[u].tableName!=f;)++u;if(d>u){t[u].turnToFullMatched(p);continue}p.tableName=""}if(p.isRecordset){for(C=p.object.Fields.items,v=[],u=0,d=C.length;d>u;)v.push(C[u++].RunningDBField.toUpperCase());for(m=[],d=t.length,u=0;d>u;)if(g=t[u++],!g.isFullMatched()){if(_=o(v,g,!0),n(_)){l(_,p,g),m=[];break}_>0&&m.push({dataTableInfo:g,weight:_})}m.length&&i(m,p)}}if(t.some((function(e){return!e.isMatched()})))for(c=T.length,s=0;c>s;++s)if(p=T[s],!p.isRecordset&&!p.tableName){for(v=a(p.object),m=[],d=t.length,u=0;d>u;)if(g=t[u++],!g.isFullMatched()){if(_=o(v,g,!1),n(_)){l(_,p,g),m=[];break}h=g.reportTableInfo,_>0&&(!h||h.isRecordset&&h.weight+50<_||!h.isRecordset&&h.weight<_)&&m.push({dataTableInfo:g,weight:_})}m.length&&i(m,p)}for(c=t.length,s=0;c>s;)g=t[s++],p=g.reportTableInfo,p&&p.object.attachDataTable(g.table)}var t=this,r=t.viewer.tables,o=[],n=function(e,t){var r,o=this,n=o.fieldNames=[],a=Math.min(t.length,50);for(o.tableName=e,o.table=t,o.matchWeight=0;a--;)for(var i in r=t[a],r)i=i.toUpperCase(),n.indexOf(i)<0&&n.push(i)};for(var a in n.prototype={isFullMatched:function(){return this.matchWeight>=200},turnToFullMatched:function(e){var t=this;t.matchWeight=200,t.reportTableInfo=e},isMatched:function(){return this.matchWeight>=40},get recordCount(){return this.table.length}},r){var i=r[a];i&&i instanceof Array&&o.push(new n(a,i))}1===o.length&&o[0].recordCount>1&&t.DetailGrid?t.DetailGrid.Recordset.attachDataTable(o[0].table):e(t,o)},attachDataTable:function(e){var t,r,o=this,n=e[0];for(var a in n)t=n[a],r=o.ParameterByName(a),r?r.setValue(t):(r=o.ControlByName(a),r&&(r.hasOwnProperty("Text")||7===r.ControlType)&&(r.Text=t+""))},prepare:function(){var e=this,t=e.Printer,r=e.ReportHeaders,o=e.ReportFooters;e._scriptFailed=0,e.designWidth=e.size2Pixel((1===t.DesignPaperOrientation?t.DesignPaperWidth:t.DesignPaperLength)-t.DesignPaperLeftMargin-t.DesignPaperRightMargin),e.DetailGrid&&e.DetailGrid.attachData(),r.attachData(),o.attachData(),e.Parameters.prepare(),e.DetailGrid&&e.DetailGrid.prepare(),r.prepare(),o.prepare(),e._srChildren&&e._srChildren.forEach((function(e){e.Report.prepare()})),e.ownerSR||!e.viewer.options.singleChartFill||e.DetailGrid||r.Count+o.Count!==1||1!==(r.items[0]||o.items[0]).Controls.Count||(e.singleChart=(r.items[0]||o.items[0]).Controls.items[0],11!==e.singleChart.ControlType&&delete e.singleChart)},unprepare:function(){var e=this;e.Parameters.unprepare(),e.DetailGrid&&(e.DetailGrid.unprepare(),e.RunningDetailGrid=e.DetailGrid),e.ReportHeaders.unprepare(),e.ReportFooters.unprepare(),delete e._srChildren,delete e._has_cb,delete e.singleChart,delete e.canvasControls},getUsingFont:function(){return this.Font.font},getRunningColumn:function(e){var t,r,o=this.RunningDetailGrid;return e&&o&&(t=o.Columns,r=t.itemByName(e),r||("(GridLeft)"===e?r=t.Item(1):"(GridRight)"===e&&(r=t.Item(t.Count)))),r},getReportWidth:function(){var e=this,t=e.designWidth,r=this.RunningDetailGrid,o=r?r.width:0;return 2*o>t?o:t},get reportFitHeight(){var e=this;return!e.RunningDetailGrid&&e.viewer.options.reportFitHeight},get reportFitWidth(){var e=this.viewer.options;return e.reportFitWidth||e.fixedHeaderFooter},get detailgridResize(){var e=this.viewer.options;return e.fixedHeaderFooter?gr.enum_.detailgridResize.fitWidth:e.detailgridResize},get fixedHeaderFooter(){var e=this;return e.DetailGrid&&e.viewer.options.fixedHeaderFooter},get toFillHolder(){var e=this;return e.reportFitHeight||e.singleChart},get isDynamicSize(){var e=this;return e.toFillHolder||e.reportFitWidth||e.detailgridResize},pixel2Size:function(e){return e/=96,1===this.Unit&&(e*=2.54),e},size2Pixel:function(e){return 1===this.Unit&&(e/=2.54),96*e},cm2Size:function(e){return 1===this.Unit?e:e/2.54},registerCanvas:function(e,t){var r=this,o=new S("canvas",t),n=se();o.addAttribute("id",n),r.isDynamicSize||!e.pxRect?(o.addStyle("width","100%"),o.addStyle("height","100%"),o.addStyle("display","block")):(o.addAttribute("width",Math.round(e.pxRect.Width())+""),o.addAttribute("height",Math.round(e.pxRect.Height())+"")),e.canvasID=n,r.canvasControls||(r.canvasControls=[]),r.canvasControls.push(e)},prepareCanvas:function(){for(var e,t=this,r=t.canvasControls,o=r.length;o-- >0;)e=r[o],e.canvas=document.getElementById(e.canvasID),e.prepareCanvas&&e.prepareCanvas()},resizeCanvas:function(){for(var e=this,t=e.canvasControls,r=t.length;r-- >0;)t[r].resizeCanvas()},renderCanvas:function(){for(var e=this,t=e.canvasControls,r=t.length;r-- >0;)t[r].drawCanvas(1)},startCanvas:function(){var e=this;e.canvasControls&&(e.prepareCanvas(),e.isDynamicSize?(oe(window,"resize",(function(t){e.resizeCanvas()})),e.resizeCanvas()):e.renderCanvas()),e._srChildren&&e._srChildren.forEach((function(e){e.Report.startCanvas()}))},executeEventScript:function(e,t,r){gr.script.execEvent(e,t,r,this)},fireInitialize:function(){var e=this;e.InitializeScript&&e.executeEventScript(e.InitializeScript,"InitializeScript",e),e.OnInitialize&&e.OnInitialize()},fireFetchRecord:function(){var e=this;e.FetchRecordScript&&e.executeEventScript(e.FetchRecordScript,"FetchRecordScript",e.DetailGrid.Recordset),e.OnFetchRecord&&e.OnFetchRecord()},fireBeforePostRecord:function(){var e=this;e.OnBeforePostRecord&&e.OnBeforePostRecord()},fireBeforeSort:function(e,t){var r=this;r.BeforeSortScript&&r.executeEventScript(r.BeforeSortScript,"BeforeSortScript",t),r.OnBeforeSort&&t.isDetailGridRecordset()&&r.OnBeforeSort()},fireProcessBegin:function(){var e=this;e.ProcessBeginScript&&e.executeEventScript(e.ProcessBeginScript,"ProcessBeginScript",e),e.OnProcessBegin&&e.OnProcessBegin()},fireProcessEnd:function(){var e=this;e.ProcessEndScript&&e.executeEventScript(e.ProcessEndScript,"ProcessEndScript",e),e.OnProcessEnd&&e.OnProcessEnd()},fireProcessRecord:function(e){var t=this;e.ProcessRecordScript&&t.executeEventScript(e.ProcessRecordScript,"ProcessRecordScript",e),t.OnProcessRecord&&t.OnProcessRecord()},fireGroupBegin:function(e){var t=this;e.GroupBeginScript&&t.executeEventScript(e.GroupBeginScript,"GroupBeginScript",e),t.OnGroupBegin&&t.OnGroupBegin(e)},fireGroupEnd:function(e){var t=this;e.GroupEndScript&&t.executeEventScript(e.GroupEndScript,"GroupEndScript",e),t.OnGroupEnd&&t.OnGroupEnd(e)},fireSectionFormat:function(e){var t=this;e.FormatScript&&t.executeEventScript(e.FormatScript,"FormatScript",e),t.OnSectionFormat&&t.OnSectionFormat(e)},fireFieldGetDisplayText:function(e){var t=this;e.GetDisplayTextScript&&t.executeEventScript(e.GetDisplayTextScript,"FieldGetDisplayTextScript",e),t.OnFieldGetDisplayText&&t.DetailGrid&&t.RunningDetailGrid.Recordset===e.owner&&t.OnFieldGetDisplayText(e)},fireTextBoxGetDisplayText:function(e){var t=this;e.GetDisplayTextScript&&t.executeEventScript(e.GetDisplayTextScript,"TextBoxGetDisplayTextScript",e),t.OnTextBoxGetDisplayText&&t.OnTextBoxGetDisplayText(e)},fireControlCustomDraw:function(e){var t=this,r=t.Graphics,o=e.Font,n=o?o.UsingFont():0,a=new b(e.canvas.getContext("2d"));!r&&(r=t.Graphics=new w(t)),r.attach(a),n&&a.selectFont(n),e.CustomDrawScript&&t.executeEventScript(e.CustomDrawScript,"CustomDrawScript",e),t.OnControlCustomDraw&&t.OnControlCustomDraw(e,r),n&&a.restoreFont()},fireChartRequestData:function(e){var t=this;t.OnChartRequestData&&t.OnChartRequestData(e)},onCheckBoxClick:function(e){var t,r,o,n,i,l,s,u,c,d,p=this,h=p.DetailGrid,f=h.Recordset,g=e.target,m=g.id,_=g.checked,C=_?-1:-2,v=g.parentNode.parentNode;if(h&&(t=h.syncTRData(v),i=g.getAttribute(a.ATTR_FIELD),i?(f.Edit(),f.FieldByName(i).AsInteger=C,f.Post()):(u=p.report.ControlByName(m),u&&(u.ImageIndex=C)),r=t.group))for(o=r.beginNoField.AsInteger,n=r.endNoField.AsInteger,s=document.querySelectorAll("."+a.CSS_CB),l=s.length;l-- >0;)u=s[l],m=u.id,c="CBC"===m.substr(0,3),c&&(d=+m.substr(3),d>=o&&n>=d&&(u.checked=_,i=u.getAttribute(a.ATTR_FIELD),i&&(f.MoveTo(d),f.Edit(),f.FieldByName(i).AsInteger=C,f.Post())))},get root(){for(var e=this;e.ownerSR;)e=e.ownerSR.report;return e},get Version(){return a.VERSION},get FloatControls(){var e=this;return e._floatControls||(e._floatControls=new de(e)),e._floatControls},get ImageList(){return{}},get ParentReport(){var t=this,r=t.ownerSR;return r?r.report:e},get Utility(){return gr.utility},get Running(){return!!this.viewer.running},get DisplayMode(){return 1},get IsBlank(){var e=this;return e.DetailGrid&&e.PageHeader&&e.PageFooter&&!e.ReportHeaders.Count&&!e.ReportFooters.Count},ControlByName:function(t){function r(o){function n(o){function n(o){return o.FreeCell?r(o.Controls):o.DataName.toUpperCase()===t?o:e}for(var a,i,l,s,u=o.length;u--;)if(l=o[u])for(a=l.length;a--;)if(s=l[a],i=s?n(s):0)return i;return e}for(var a,i=o.items,l=i.length;l--;){if(a=i[l],a.Name.toUpperCase()===t)return a;if(13===a.ControlType&&(a=n(a.cells)))return a}return e}function o(t){return t.FreeCell?r(t.Controls):e}function n(t){for(var r,a,i=t.items.length;i--;)if(r=t.items[i],a=o(r),r.GroupTitle&&!a&&(a=n(r.SubTitles)),a)return a;return e}function a(e){for(var t=e.length;t--;)if(u=r(e[t].Controls))return u}var i,l,s,u,c=this;if(t=t.toUpperCase(),u=a(c.ReportHeaders.items)||a(c.ReportFooters.items))return u;if(c.DetailGrid){for(i=c.DetailGrid.Groups.items,l=i.length;l--;)if(s=i[l],u=r(s.Header.Controls)||r(s.Footer.Controls))return u;for(i=c.DetailGrid.ColumnContent.ContentCells.items,l=i.length;l--;)if(u=o(i[l]))return u;return n(c.DetailGrid.ColumnTitle.TitleCells)}return e},ColumnByName:function(t){var r=this;return r.DetailGrid?r.DetailGrid.Columns.itemByName(t):e},FieldByName:function(e){return this.RunningFieldByName(e)},FieldByDBName:function(t){var r=this.RunningDetailGrid;return r?r.Recordset.FieldByDBName(t):e},ParameterByName:function(e){return this.Parameters.itemByName(e)},FindFirstControl:function(){function e(e){e.FreeCell&&(l=l.concat(e.Controls.items))}function t(r){r.forEach((function(r){e(r),r.GroupTitle&&t(r.SubTitles)}))}var r,o,n,a=this,i=a.DetailGrid,l=[];for(o=a.ReportHeaders.Count,r=0;o>r;r++)l=l.concat(a.ReportHeaders.items[r].Controls.items);for(o=a.ReportFooters.Count,r=0;o>r;r++)l=l.concat(a.ReportFooters.items[r].Controls.items);if(i){for(o=i.Groups.Count,r=0;o>r;r++)n=i.Groups.items[r],l=l.concat(n.Header.Controls.items),l=l.concat(n.Footer.Controls.items);i.ColumnContent.ContentCells.forEach((function(t){e(t)})),t(i.ColumnTitle.TitleCells)}return l.length>0&&(a.findControls=l,a.findControlIndex=-1),a.FindNextControl()},FindNextControl:function(){var t=this;return t.findControls&&(++t.findControlIndex,t.findControlIndex>=t.findControls.length&&(delete t.findControls,delete t.findControlIndex)),t.findControls?t.findControls[t.findControlIndex]:e},RunningFieldByName:function(t){var r=this.RunningDetailGrid;return r?r.Recordset.FieldByName(t):e},PixelsToUnit:function(e){return this.pixel2Size(e)},UnitToPixels:function(e){return this.size2Pixel(e)},SystemVarValue:function(e){return this.SystemVarValue2(e,0)},SystemVarValue2:function(e,t){var r,o,n,a=this,i=a.RunningDetailGrid;if(1===e)r=new Date;else if(i)switch(o=i.Recordset,e){case 4:r=o.RecordNo+1;break;case 19:r=o.RecordCount;break;case 8:r=i.generatingRowNo;break;default:n=i.Groups.items[t-1],n&&(21===e?r=n.recordset.RecordCount:(n.inphaseByDetail(o.RecordNo),r=20===e?n.recordset.isAppendingRecord()?n.recordset.RecordCount:n.recordset.RecordNo:22===e?o.RecordNo-n.beginNoField.Value:n.endNoField.Value-n.beginNoField.Value,r++))}return r},AddParameter:function(e,t){var r=this.Parameters.Add();return r.Name=e,r.DataType=t,r},InsertDetailGrid:function(){var e=this;return e.DetailGrid||(e.DetailGrid=new ot(e),e.RunningDetailGrid=e.DetailGrid),e.DetailGrid},InsertPageHeader:function(){return new qe(this)},InsertPageFooter:function(){return new qe(this)},Clear:function(){var e=this;at.call(e,e.viewer,e.ownerSR),e.DeleteDetailGrid()},DeleteDetailGrid:function(){var t=this;t.DetailGrid=e,t.RunningDetailGrid=e},DeletePageHeader:function(){},DeletePageFooter:function(){}};var it="",lt="_hta",st="_htaa",ut="_htc",ct="_htca",dt="_htn",pt="_htx",ht="_hp",ft="_vp",gt="_htp",mt="_vtp",_t=function(){this.Flag=0};_t.prototype={get CalcHTotal(){return 1&this.Flag},set CalcHTotal(e){var t=this;e?t.Flag|=1:t.Flag&=-2},get CalcHAverage(){return 2&this.Flag},set CalcHAverage(e){var t=this;e?t.Flag|=2:t.Flag&=-3},get CalcHAverageA(){return 4&this.Flag},set CalcHAverageA(e){var t=this;e?t.Flag|=4:t.Flag&=-5},get CalcHCount(){return 8&this.Flag},set CalcHCount(e){var t=this;e?t.Flag|=8:t.Flag&=-9},get CalcHCountA(){return 16&this.Flag},set CalcHCountA(e){var t=this;e?t.Flag|=16:t.Flag&=-17},get CalcHMin(){return 32&this.Flag},set CalcHMin(e){var t=this;e?t.Flag|=32:t.Flag&=-33},get CalcHMax(){return 64&self.Flag},set CalcHMax(e){var t=this;e?t.Flag|=64:t.Flag&=-65},onBySummaryFun:function(e){var t=this;t.CalcHTotal=!0,2===e?t.CalcHAverage=!0:15===e?t.CalcHAverageA=!0:3===e?t.CalcHCount=!0:13===e?t.CalcHCountA=!0:4===e?t.CalcHMin=!0:5===e&&(t.CalcHMax=!0)}};var Ct=function(t){var r=this;r.originObject=e,r.HTotalFlag=new _t,r.HSubtotalFlag=new _t,r.MiscFlag=0,r.DatafieldIndex=-1,r.TotalValue=0,r.EntireTotalValue=0,t&&Q(r,t,0)};Ct.prototype={CopyAddField:function(e,t){var r=this,o=e.Fields.Add();return r.originObject.FieldType?(o.assign(r.originObject),r.originObject.isNumeric()&&(o.FieldType=3)):r.NumericField&&(o.FieldType=3,o.Format=r.originObject.textBuilder.items[0].format),o.Name=t,o.DBFieldName="",o._tableMember=t,o},CombineCalcFlag:function(e){var t=this;t.HTotalFlag.Flag|=e.HTotalFlag.Flag,t.HSubtotalFlag.Flag|=e.HSubtotalFlag.Flag,t.MiscFlag|=e.MiscFlag},SetFlagBySummaryFun:function(e,t){var r=this;3===t?r.HSubtotalFlag.onBySummaryFun(e):r.HTotalFlag.onBySummaryFun(e)},get CalcHPercent(){return 1&this.MiscFlag},set CalcHPercent(e){var t=this;e?t.MiscFlag|=1:t.MiscFlag&=-2},get CalcVPercent(){return 2&this.MiscFlag},set CalcVPercent(e){var t=this;e?t.MiscFlag|=2:t.MiscFlag&=-3},get CalcTotalHPercent(){return 4&this.MiscFlag},set CalcTotalHPercent(e){var t=this;e?t.MiscFlag|=4:t.MiscFlag&=-5},get CalcTotalVPercent(){return 8&this.MiscFlag},set CalcTotalVPercent(e){var t=this;e?t.MiscFlag|=8:t.MiscFlag&=-9},get CalcHTotalExclude(){return 16&this.MiscFlag},set CalcHTotalExclude(e){var t=this;e?t.MiscFlag|=16:t.MiscFlag&=-17},get NumericField(){return 32&this.MiscFlag},set NumericField(e){var t=this;e?t.MiscFlag|=32:t.MiscFlag&=-33}};var vt=function(e,t){var r=this;r.Group=e,r.DataFieldInfo=t,r.DataSumBoxes=[]},Tt=function(t){var r=this;r.PriorCrossTitleCell=e,r.OriginTextBox=t,r.PriorTitleText=""},xt=function(e){var t=this;Te.call(t,e),t.HCrossFields="",t.VCrossFields="",t.ListCols=1,t.TotalCols=0,t.SubtotalCols=0,t.HResort=!0,t.HSortAsc=!0,t.VResort=!0,t.VSortAsc=!0,t.HTotalAtFirst=!1,t.HPercentColumns="",t.VPercentColumns="",t.TotalExcludeColumns="",t.TotalHPercentColumns="",t.TotalVPercentColumns="",t.DisabledSumFields="",t.PercentFormat="0.##%",t.HCrossPeriodType=0,t.BeginDateParameter="",t.EndDateParameter="",t.GroupAutoSum=!0};xt.prototype={loadFromJSON:function(e){var t=this;e&&(Te.prototype.loadFromJSON.call(t,e),F(t,"HCrossPeriodType",n.PeriodType))},prepare:function(){function r(){var e=d.ParameterByName(c.BeginDateParameter),t=d.ParameterByName(c.EndDateParameter),r={};return e&&(r.begin=e.AsDateTime),t?(r.end=t.AsDateTime,e||(r.begin=N(r.end))):r.end=N(r.begin),r.end<r.begin&&(e=r.begin,r.begin=r.end,r.end=e),r}function o(){function o(){function e(e){var t=e.orderNo;return ae>t?1:ie>t?2:le>t?3:4}function t(t,r){function o(e){ve.indexOf(e.originObject)<0&&(D.some((function(t){return t.originObject===e.originObject&&(t.CombineCalcFlag(e),!0)}))||(e.NumericField=e.originObject.isNumeric(),D.push(e)))}function n(e,t){e?e.varItems.forEach((function(e){var r=e.varField;1===r.type&&(t.originObject=r.object,o(t))})):(t.originObject=D[0].originObject,o(t))}var a,i=new Ct,l=e(r),s=1!==l,u=t.ControlType;4===l?(i.HTotalFlag.CalcHTotal=1,Ce.indexOf(r)>=0&&(i.CalcHTotalExclude=1),me.indexOf(r)>=0&&(i.CalcTotalHPercent=1),_e.indexOf(r)>=0&&(i.CalcTotalVPercent=1)):3===l?i.HSubtotalFlag.CalcHTotal=1:2===l&&(fe.indexOf(r)>=0&&(i.CalcHPercent=1),ge.indexOf(r)>=0&&(i.CalcVPercent=1),i.CalcHPercent&&(i.HTotalFlag.CalcHTotal=1)),4===u||7===u?s&&(i.originObject=t.oDataField,i.originObject&&o(i)):5===u?(i.SetFlagBySummaryFun(t.SummaryFun,l),n(t.paramExp,i)):12===u?s&&(i.originObject=t,D.push(i)):8===u&&(a=!1,t.textBuilder.forEach((function(e){e.varItems&&e.varItems.forEach((function(e){var t,r=e.varField;4===r.type?(t=new Ct(i),t.SetFlagBySummaryFun(r.SummaryFun,l),n(r.paramExp,t),a=!0):1===r.type&&s&&(t=new Ct(i),t.originObject=r.object,o(t))})),!a&&s&&(i.originObject=t,i.NumericField=t.isPureNumericExpression(),D.push(i))})))}function r(e){e.forEach((function(e){e.GroupTitle?r(e.SubTitles.items):e.Column.ContentCell.getControls().forEach((function(r){t(r,e.Column)}))}))}function o(r){r.Controls.forEach((function(r){var o=T.itemByName(r.AlignColumn)||T.itemByName(r.AlignColumnEx);o&&1!==e(o)&&t(r,o)}))}r(b),x.forEach((function(e){o(e.Footer),o(e.Header)})),u=0,D.forEach((function(e){e.DatafieldIndex=u,++u,e.CalcHPercent&&++u,e.CalcVPercent&&++u}))}function a(){D.forEach((function(e){e.originObject.FieldType&&f.Fields.Remove(e.originObject.Name)}))}function M(e){var t=f.Fields.Add();return t.Name=e,t.FieldType=3,t}function k(){function e(e){e.Controls.items=e.Controls.items.filter((function(e){var t=_.itemByName(e.AlignColumn)||_.itemByName(e.AlignColumnEx);return!t||t.orderNo<c.ListCols}))}h.buildColumnsOrder(),s.forEach((function(t){e(t.Footer),e(t.Header)}))}function N(r,o,a,i,l,u,v){function T(e,t){var r,o;e.FreeCell?(t.setFreeCell(!0),ee(t,e),e.Controls.forEach((function(e){function n(){return 2===c.HCrossPeriodType||3===c.HCrossPeriodType||4===c.HCrossPeriodType||6===c.HCrossPeriodType||7===c.HCrossPeriodType}function a(){function e(e){var t=new g;return t.value=e,Math.floor(t.AsFloat)}var t,r=c.curPeriod.begin.getFullYear(),o=c.curPeriod.begin.getMonth()+1,n=c.curPeriod.begin.getDate();switch(c.HCrossPeriodType){case 2:t="第"+Math.floor((e(c.curPeriod.begin)-e(re.begin))/7+1)+"周";break;case 3:t=11>n?"上":21>n?"中":"下",t=o+"月"+t+"旬";break;case 4:t=16>n?"上":"下",t=o+"月"+t+"半月";break;case 6:t=B(r,2)+"-"+(o+2)/3+"季度";break;case 7:t=7>o?"上":"下",t=B(r,"00")+"-"+t+"半年"}return t}var i,l;r=e.ControlType,e.TextFormat?(o=t.Controls.Add(1),o.assign(e),i=n()&&4===r&&e.DataField===c.HCrossFields?a():e.getDisplayText(),o.Text=i):(o=t.Controls.Add(r),o.assign(e),7===r?e.DataField&&(o.DataField="",l=d.FieldByName(e.DataField),l&&(7===l.FieldType?o.Picture=l.Value:(i=l.DisplayText,o.ImageIndex=parseInt(i),isNaN(o.ImageIndex)&&(o.ImageIndex=0,o.ImageFile=i)))):12===r&&(o.Text=e.get_DisplayText()))}))):(t.assign(e),t.Text=e.getDisplayText())}function b(){var t,n,s,c=0;2===a?(t=Te[v-se],n=t?t[l]:0,c=n&&n.PriorCrossTitleCell&&n.PriorTitleText===n.OriginTextBox.getDisplayText()&&!u):3===a?(c=ue==ce,n=Te[Te.length-1],n=l<n.length?n[l]:e,c?c=n&&!!n.PriorCrossTitleCell:0==l&&(s=r.Controls,c=s&&1===s.Count&&s.Item(1).getDisplayText&&s.Item(1).getDisplayText()===n.PriorTitleText)):4===a&&(n=Te[Te.length-1][l],c=de==he,c&&(c=!!n.PriorCrossTitleCell)),c?o=n.PriorCrossTitleCell:(o=(o?o.SubTitles:m).AddGroup("",""),T(r,o),o.Name=F,n&&(n.PriorCrossTitleCell=o,n.PriorTitleText=n.OriginTextBox.getDisplayText())),r.SubTitles.forEach((function(e){N(e,o,a,i,l+1,!c,v)}))}function w(){function e(e){var t;return D.some((function(r){return r.originObject.Name===e&&(t=r,!0)})),t}function i(e,t){var r;return c.HPercentSums.some((function(o){return o.Group===e&&o.DataFieldInfo===t&&(r=o,!0)})),r}function l(e,r){var o,n=t(e);return 4===a||1===a?n?(r+=it+n,o=r):k.CalcHPercent?(o=r+it,r+=gt):k.CalcVPercent?(r+=mt,o=r):(r+=it,o=r):3===a?(r+=y+n,o=r):(r+=y,o=r,k.CalcHPercent?r+=ht:k.CalcVPercent&&(r+=ft,o=r)),o=H(o),{DataField:r,SummaryDataField:o}}function u(e,t){var r,o=0,n="";return e.varItems.forEach((function(a){o<a.beginIndex&&(n+=e.expText.substring(o,a.beginIndex)),1===a.varField.type?(r=l(t,a.varField.object.Name),n+=r.SummaryDataField):n+=a.varField.getExpText(),o=a.endIndex})),n+=e.expText.substr(o)}function g(e,t){return e="[#"+e,t&&(e+=":"+t),e+"#]"}function m(e,t){var r,o=0,a="";return e.varItems.forEach((function(i){var l=i.varField,s=l.type;o<i.beginIndex&&(a+=e.expText.substring(o,i.beginIndex)),4===s?(r=u(l.paramExp,l.SummaryFun),a+=t?U(n.SummaryFun,l.SummaryFun)+"("+r+(l.RankNo?","+l.RankNo:"")+")":r):a+=l.getExpText(),o=i.endIndex})),a+=e.expText.substr(o)}function v(){s.forEach((function(t,r){function o(e,t){t.isToGenerate()&&e.Controls.forEach((function(e){var r,o,n,i=e.ControlType,s=e.AlignColumn||e.AlignColumnEx;s===B.Name&&(r=t.Controls.Add(i),r.assign(e),r.AlignColumn=b.Name,r.AlignColumnEx="",5===i?e.DataField&&(r.DataField=u(e.paramExp,e.SummaryFun),r.Tag=e.DataField,a.push(r)):8===i?(o="",e.textBuilder.forEach((function(e){o+=e.varItems?g(m(e,!0),e.format):e.text})),r.Text=o):4===i&&(n=d.FieldByName(r.DataField),n&&(r.DataField=l(0,originFieldName).SummaryDataField)))}))}var n,a=[];n=x[r],o(n.Footer,t.Footer),o(n.Header,t.Header),a.forEach((function(r){var o,n;k.CalcHPercent&&(r.Format=c.PercentFormat,o=e(r.Tag),n=i(t,o),n||(n=new vt(t,o),c.HPercentSums.push(n)),A?n.TotalSumBox=r:n.DataSumBoxes.push(r))}))}))}var b,w,P,E=1!==a,A=4===a,R=c.GroupAutoSum&&E,B=r.Column,M=B.orderNo,k=new Ct;ue===ce&&(2==a&&M>=ie||3==a&&ie>M)||de===he&&(3==a&&M>=le||4==a&&le>M)||(b=_.addTo(o?o.SubTitles:h.ColumnTitle.TitleCells),b.assign(B),b.Name=F,2!==a&&3!==a||(b._crossOrderNo=S),T(r,b.TitleCell),b.ContentCell.assign(B.ContentCell),w=b.ContentCell.getControls(),P=1===w.length,A?(me.indexOf(B)>=0&&(k.CalcHPercent=1),_e.indexOf(B)>=0&&(k.CalcVPercent=1)):(fe.indexOf(B)>=0&&(k.CalcHPercent=1),ge.indexOf(B)>=0&&(k.CalcVPercent=1)),w.forEach((function(t,r){function o(r){s.forEach((function(o,n){function a(e,t){return e.isToGenerate()&&e.Controls.items.some((function(e){return e.AlignColumn===t.Name||e.AlignColumnEx===t.Name}))}function l(e){var o,n,a,i;return e.isToGenerate()&&(o=e.Controls.Add(5),o.assign(t),o.Dock=0,o.TextAlign=t.TextAlign,o.AlignColumn=b.Name,o.DataField=r.summaryDataField,C.ShowColLine&&(n=o.Border,n.Styles|=4,a=C.ColLinePen.Width,i=t.Border,i&&4&i.Styles&&i.Pen.Width>0?a+=i.Pen.Width:n.Pen.Color=C.ColLinePen.Color,n.Pen.Width=a),P?(o.Top=0,o.Height=e.Height,16777215!==b.ContentCell.BackColor&&16777215===e.BackColor&&(o.BackStyle=1,o.BackColor=b.ContentCell.BackColor)):(o.Top=t.Top,o.Height=t.Height,1===t.BackStyle()&&(o.BackStyle=1,o.BackColor=t.BackColor))),o}var s,u,d,p=x[n];a(p.Footer,B)||a(p.Header,B)||(s=l(o.Footer),s||(s=l(o.Header)),s&&(s.Format=r.format,k.CalcHPercent&&(s.Format=c.PercentFormat,u=e(r.originDataField),d=i(o,u),d||(d=new vt(o,u),c.HPercentSums.push(d)),A?d.TotalSumBox=s:d.DataSumBoxes.push(s))))}))}function n(){var e,n,a=t.DataField,i=t.SummaryFun;5===h&&(a||(a=D[0].originObject.Name),n=t.Format,b.ContentCell.Controls?(t=new Ae(b.ContentCell),t.assign(w[r]),b.ContentCell.Controls.items[r]=t):b.ContentCell.assign(w[r])),d=l(i,a),t.DataField=d.DataField,7!==h&&(n&&(e=f.Fields.Item(d.DataField),e&&(e.Format=n)),R&&o({summaryDataField:d.SummaryDataField,originDataField:a,format:""}))}function u(){var e,n,a,i,s=!1;s=p&&X(t,y),s||(n=B.ContentCell.getControls()[r],e=(a=n.textBuilder.items[0])&&a.varItems&&a.varItems.some((function(e){return 4===e.varField.type})),e?(i=m(a,!1),t.Text=g(i,a.format),R&&o({summaryDataField:H(i),originDataField:"",format:a.format})):E&&(d=l(0,t.Name),t.Text="[#"+d.DataField+"#]",R&&o({summaryDataField:d.SummaryDataField,originDataField:t.Name,format:""})))}var d,h=t.ControlType;4===h||5===h||7===h?n():12===h?1!==a&&(d=l(t.Name,0),t.Text="[#"+d.DataField+"#]"):8===h&&u()})),E&&v())}var y=i?(2===a?"_":"_S")+i:"",F=r.Name+y;r.GroupTitle?b():r.Column.Visible&&w()}function L(){var e=v.Fields;f.Fields.forEach((function(t){F.push({crossField:t,originField:e.itemByName(t.Name)})}))}function I(){D.forEach((function(e){function t(e,t,o){r=e.CopyAddField(f,t+o),r.GetDisplayTextScript="",P.push(r)}var r,o=e.HTotalFlag,n=e.originObject.Name;o.CalcHTotal&&t(e,n,it),o.CalcHAverage&&t(e,n,lt),o.CalcHAverageA&&t(e,n,st),o.CalcHCount&&t(e,n,ut),o.CalcHCountA&&t(e,n,ct),o.CalcHMin&&t(e,n,dt),o.CalcHMax&&t(e,n,pt),e.CalcTotalHPercent&&(r=M(n+gt),r.Format=c.PercentFormat,P.push(r)),e.CalcTotalVPercent&&(r=M(n+mt),r.Format=c.PercentFormat,P.push(r))}))}function G(){var t=b.length;for(i=he;t>i;i++)N(b[i],e,4,e,0,!0,-1)}function W(e){var t,r=e.getControls();e.GroupTitle&&1===r.length&&(t=r[0],t.TextFormat&&(Te[Te.length-1].push(new Tt(t)),e.SubTitles.items.length>=1&&W(e.SubTitles.items[0])))}function j(){var e=[];c.HResort&&w.forEach((function(t){e.push({field:t,asc:c.HSortAsc,case:1})})),$=v.sortRecords(e,1)}function q(t){var r,o;for(r="_"+t,w.forEach((function(e){o=f.Fields.Add(),o.assign(e),o._tableMember="",o.DBFieldName="",o.Name+=r,o._hfval=e.Value,E.push(o)})),D.forEach((function(e){var t=e.originObject.Name+r;P.push(e.CopyAddField(f,t)),e.CalcHPercent&&(o=M(t+ht),o.Format=c.PercentFormat,P.push(o)),e.CalcVPercent&&(o=M(t+ft),o.Format=c.PercentFormat,P.push(o))})),i=se;ue>=i;i++)N(b[i],e,2,t,0,!1,i)}function z(){function t(){var e,t,r=!0,o=Te[Te.length-1],n=b[se],a=0;if(Te.length>1)return!1;for(;n.GroupTitle&&!(a>=o.length)&&(e=o[a],r=!!e.PriorCrossTitleCell&&e.PriorTitleText==e.OriginTextBox.getDisplayText())&&(t=n.SubTitles,!(t.Count<=0))&&!(++a>=pe);)n=t.Item(1);return!r}function r(){var t,r,o;for(A.push(S),t=A.length,r="_S"+t,D.forEach((function(e){o=e.originObject.Name+r,R.push(e.CopyAddField(f,o+it)),e.HSubtotalFlag.CalcHAverage&&R.push(e.CopyAddField(f,o+lt)),e.HSubtotalFlag.CalcHAverageA&&R.push(e.CopyAddField(f,o+st)),e.HSubtotalFlag.CalcHCount&&R.push(e.CopyAddField(f,o+ut)),e.HSubtotalFlag.CalcHCountA&&R.push(e.CopyAddField(f,o+ct)),e.HSubtotalFlag.CalcHMin&&R.push(e.CopyAddField(f,o+dt)),e.HSubtotalFlag.IsCalcHMax&&R.push(e.CopyAddField(f,o+pt))})),i=ce;de>=i;i++)N(b[i],e,3,t,0,!1,-1)}$.forEach((function(e,o){(e<c.VAddedItemRecordOffsetBegin||e>=c.VAddedItemRecordOffsetEnd)&&(v.MoveTo(e),o&&!v.fieldsKeepedValueChanged(w)||(c.SubtotalCols>0&&o&&t()&&(v.MoveTo($[o-1]),r(),v.MoveTo(e)),v.keepValue(),q(++S)),v.curRecord._CrossNo_=S)})),c.SubtotalCols>0&&r()}function Y(){function e(){return re?c.curPeriod=l.periodRangeNext(c.curPeriod,c.HCrossPeriodType):(re=r(),O(re.begin),O(re.end),V(re.end),c.curPeriod=l.periodRangeBy(re.begin,c.HCrossPeriodType)),c.curPeriod.begin<re.end}for(var t,o,n=$.length,a=0;e();)for(t=w[0].AsDateTime,w[0].AsDateTime=c.curPeriod.begin,q(++S),w[0].AsDateTime=t;n>a&&(v.MoveTo($[a]),o=w[0].AsDateTime,!(o<c.curPeriod.begin||o>=c.curPeriod.end));)v.curRecord._CrossNo_=S,a++}function J(){c.HPercentSums.forEach((function(e){function t(e){e.isToGenerate()&&(r=e.Controls.Add(5),r.DataField=o)}var r,o;e.TotalSumBox||(o=e.DataFieldInfo.originObject.Name+it,t(e.Group.Footer),!r&&t(e.Group.Header),r.Visible=!1,e.TotalSumBox=r)}))}function K(){var e=P.splice(0,Q);P=P.concat(e)}function X(e,t){var r,o=e.Text,n=o.indexOf(":");return n>0&&o.substring(2,n)===w[0].Name?(r="G"===t?"[#"+ne:o.substr(0,n)+t,r+=o.substr(n),e.Text=r,1):0}function Z(){function e(){var e,t=w[0],r=new Date(2009,7,30),o=t.AsDateTime;for(e=0;7>e;++e)t&&(t.AsDateTime=r),q(++S),V(r);t.AsDateTime=o}function t(e){var t=w[0];e.Controls.forEach((function(e){4===e.ControlType?t.Name===e.DataField&&(e.DataField=ne):8===e.ControlType&&X(e,"G")}))}var r,o,n=h.Groups.items[0];e(),n&&(r=f.Fields.Add(),r.FieldType=2,r.Name=oe,y.push(r),n.ByFields=oe,r=f.Fields.Add(),r.FieldType=6,r.Format=w[0].Format,r.Name=ne,y.push(r),t(n.Header),t(n.Footer)),T.Count>1&&(o=T.items[1].ContentCell.BackColor,_.Item(1).ContentCell.BackColor=o,_.Item(7).ContentCell.BackColor=o)}var Q,$,te,re,oe="_Month_",ne="_Date_",ae=0,ie=1,le=1,se=-1,ue=-1,ce=-1,de=-1,pe=0,he=-1,fe=[],ge=[],me=[],_e=[],Ce=[],ve=[],Te=[];if(p){if(c.GroupAutoSum=!1,v.Fields.forEach((function(e){6===e.FieldType&&w.push(e)})),!w.length)throw new Error("None date field!")}else{if(fe=T.decodeItems(c.HPercentColumns),ge=T.decodeItems(c.VPercentColumns),me=T.decodeItems(c.TotalHPercentColumns),_e=T.decodeItems(c.TotalVPercentColumns),Ce=T.decodeItems(c.TotalExcludeColumns),w=v.decodeFields(c.HCrossFields),!w.length)throw new Error("生成交叉表不成功，没有定义'横向交叉数据字段'！");y=v.decodeFields(c.VCrossFields),ve=v.decodeFields(c.DisabledSumFields),ae=c.ListCols,le=T.Count-c.TotalCols,ie=le-c.SubtotalCols}if(b.forEach((function(e,t){var r,o=e.findLastColumn();o&&(r=o.orderNo,0>se&&r>=ae&&(se=t),0>ue&&r+1>=ie&&(ue=t),0>ce&&r>=ie&&(ce=t),0>de&&r+1>=le&&(de=t),0>he&&r>=le&&(he=t))})),0>ce&&(ce=ue+1),0>he&&(he=de+1),le>ie&&ue>=ce)for(te=T.items[ie].TitleCell;te.SupCell;)++pe,te=te.SupCell;if(o(),a(),k(),h.clearColumns(),p)Z();else{if(!D.length)throw new Error("生成交叉表不成功，不存在交叉数据项！");if(0>=se)throw new Error("生成交叉表不成功，不存在交叉数据列！");for(j(),i=0;se>i;++i)N(b[i],e,1,e,0,!0,-1);for(L(),I(),Q=P.length,c.HTotalAtFirst&&G(),i=se;ue>=i;i++)Te.push([]),W(b[i]);0===c.HCrossPeriodType?z():Y(),!c.HTotalAtFirst&&G(),Q>0&&K(),J()}}function a(){function t(){var e=[];c.VResort&&(y.forEach((function(t){e.push({field:t,asc:c.VSortAsc,case:1})})),w.forEach((function(t){e.push({field:t,asc:c.HSortAsc,case:1})}))),s=v.sortRecords(e,1)}function o(e,t){D.forEach((function(r,o){var n,a=u*e+r.DatafieldIndex;r.NumericField?(n=r.originObject.AsFloat,P[a].AsFloat+=n,r.CalcHTotalExclude&&r.TotalValue||(r.TotalValue+=n,t&&(t[e*D.length+o]+=n))):P[a].IsNull&&(P[a].Value=r.originObject.Value)}))}function n(){f.Append(),F.forEach((function(e){e.crossField.Value=e.originField.Value})),E.forEach((function(e){e.Value=e._hfval})),D.forEach((function(e){e.TotalValue=0}))}function a(){function e(e,t,a,i,l){function s(){var l,s,c=Number.MAX_VALUE,d=-Number.MAX_VALUE;for(r=e;t>r;++r)l=P[u*r+a.DatafieldIndex],l.IsNull||(s=l.AsFloat,isNaN(s)||(c>s&&(c=s),s>d&&(d=s)));i.CalcHMin&&(c<Number.MAX_VALUE&&(n[o].AsFloat=c),o++),i.CalcHMax&&(d>-Number.MAX_VALUE&&(n[o].AsFloat=d),o++)}var c=t-e,d=c;if(i.CalcHAverageA||i.CalcHCountA)for(r=e;t>r;r++)P[u*r+a.DatafieldIndex].IsNull&&--d;n[o].AsFloat=l,o++,i.CalcHAverage&&(c>0&&(n[o].AsFloat=l/c),o++),i.CalcHAverageA&&(d>0&&(n[o].AsFloat=l/d),o++),i.CalcHCount&&(n[o].AsFloat=c,o++),i.CalcHCountA&&(n[o].AsFloat=d,o++),(i.CalcHMin||i.CalcHMax)&&s()}function t(){var t=R.length/A.length,a=0;A.forEach((function(i,l){var s=Z(D.length,0);for(r=a;i>r;++r)D.forEach((function(e,t){s[t]+=P[u*r+e.DatafieldIndex].AsFloat}));n=R,o=t*l,D.forEach((function(t,r){e(a,i,t,t.HSubtotalFlag,s[r])})),a=i}))}var r,o=u*S,n=P;for(D.forEach((function(t){t.HTotalFlag.Flag&&(e(0,S,t,t.HTotalFlag,t.TotalValue,P),t.CalcTotalHPercent&&(n[o].AsFloat=1,o++),t.CalcTotalVPercent&&o++,t.EntireTotalValue+=t.TotalValue)})),r=0;S>r;++r)D.forEach((function(e){e.CalcHPercent&&(o=u*r+e.DatafieldIndex,0!=e.TotalValue?P[o+1].AsFloat=P[o].AsFloat/e.TotalValue:P[o+1].Clear())}));A.length&&t(),f.Post()}function i(){var e,t,r,o,n,a,i;for(f.First();!f.Eof();){for(f.Edit(),e=0,t=0,r=0,o=0;S>o;++o)D.forEach((function(r,l){r.CalcVPercent&&(n=u*o+r.DatafieldIndex,a=P[n].AsFloat,i=d[o*D.length+l],r.CalcHPercent&&++n,++n,i&&(P[n].AsFloat=a/i),e+=a,t+=i)})),o===A[r]&&(D.forEach((function(o){o.CalcVPercent&&(n=u*r+o.DatafieldIndex+1+(o.CalcHPercent?1:0),t&&(R[n].AsFloat=e/t))})),r++);n=u*S,D.forEach((function(e){var t=e.HTotalFlag;n<P.length&&(a=P[n].AsFloat,t.CalcHTotal&&++n,t.CalcHAverage&&++n,t.CalcHAverageA&&++n,t.CalcHCount&&++n,t.CalcHCountA&&++n,t.CalcHMin&&++n,t.CalcHMax&&++n,e.CalcTotalHPercent&&++n,e.CalcTotalVPercent&&(e.EntireTotalValue&&(P[n].AsFloat=a/e.EntireTotalValue),++n))})),f.Post(),f.Next()}}function l(){var t,i,l,u,c=r(),d=[],p=0;for(d.push({field:w[0],asc:1,case:1}),s=v.sortRecords(d,1),t=s.length;c.begin<=c.end;){for(;t>p&&(v.MoveTo(s[p]),!(w[0].AsDateTime>=c.begin));)p++;for(i=c.begin.getDay(),l=c.begin.getMonth(),n(),y.length&&(y[0].AsInteger=l+1,y[1].AsDateTime=c.begin),u=i;7>u;++u){for(E[u].AsDateTime=c.begin;t>p&&(v.MoveTo(s[p]),!(w[0].AsDateTime>c.begin));)o(u,e),p++;if(V(c.begin),c.begin>c.end||y.length&&l!==c.begin.getMonth())break}a()}}var s,d=Z(S*D.length,0);p?l():(t(),s.forEach((function(e,t){(e<c.HAddedItemRecordOffsetBegin||e>=c.HAddedItemRecordOffsetEnd)&&(v.MoveTo(e),t&&!v.fieldsKeepedValueChanged(y)||(v.keepValue(),t&&a(),n())),v.curRecord._CrossNo_&&o(v.curRecord._CrossNo_-1,d)})),a(),D.some((function(e){return e.CalcVPercent||e.CalcTotalVPercent}))&&i())}var i,s,u,c=this,d=c.report,p=9===c.HCrossPeriodType,h=new ot(d),f=h.Recordset,m=h.ColumnTitle.TitleCells,_=h.Columns,C=c.owner,v=C.Recordset,T=C.Columns,x=C.Groups.items,b=C.ColumnTitle.TitleCells.items,w=[],y=[],S=0,D=[],F=[],P=[],E=[],A=[],R=[];c.HAddedItemRecordOffsetBegin=-1,c.HAddedItemRecordOffsetEnd=-1,c.VAddedItemRecordOffsetBegin=-1,c.VAddedItemRecordOffsetEnd=-1,c.HPercentSums=[],h.assign(C),h.IsCrossTab=0,h.Recordset.BeforePostRecordScript="",s=h.Groups.items,o(),a(),d.RunningDetailGrid=h,h.attachData(),h.prepare()},unprepare:function(){},GroupEndProcess:function(e){var t=this;t.HPercentSums.forEach((function(t){var r;t.Group===e&&(r=t.TotalSumBox.Value,t.DataSumBoxes.forEach((function(e){r?e.Value/=r:e.Value=0})),t.TotalSumBox.Value=1)}))},getClickedCellHCrossFieldValue:function(e){var t,r,o=this.report.RunningDetailGrid,n=o.clickedCell,a=n?n.getAttribute("_grcrossno"):0;return a&&(t=o.Recordset.Fields.Item(e+"_"+a),t&&(r=t.Value)),r},getClickedCellHCrossPeriod:function(){var e,t=this,r=t.report.RunningDetailGrid,o=r.clickedCell,n=o?"_"+o.getAttribute("_grcrossno"):0;return n&&(e=l.periodRangeBy(r.Recordset.Fields.Item(t.HCrossFields+n).AsDateTime,t.HCrossPeriodType)),e},get Recordset(){var t=this.report,r=t.RunningDetailGrid;return r!=t.DetailGrid?r.Recordset:e},HBeginAddItem:function(){var e=this;e.HAddedItemRecordOffsetBegin=e.report.RunningDetailGrid.Recordset.RecordCount},HEndAddItem:function(){var e=this;e.HAddedItemRecordOffsetEnd=e.report.RunningDetailGrid.Recordset.RecordCount},VBeginAddItem:function(){var e=this;e.VAddedItemRecordOffsetBegin=e.report.RunningDetailGrid.Recordset.RecordCount},VEndAddItem:function(){var e=this;e.VAddedItemRecordOffsetEnd=e.report.RunningDetailGrid.Recordset.RecordCount},GetCurPeriodBeginDate:function(){return this.curPeriod.begin},GetCurPeriodEndDate:function(){return this.curPeriod.end}},X(xt,Te);var bt=.25,wt=96/2.54,yt=[3381606,39423,16737996,3394764,10079232,6737100,10040319,3407718,16737843,13421568,6723993,14535833,3342489,8965273,13369497,14535833,13395507,10092424,10066278,14522879],St=yt.length,Dt=4,Ft=8,Pt=4,Et=function(e,t){var r,o,n=0;for(e>=1&&(t=0),r=0;t>r;r++)e*=10;for(o=e;o>1;)++n,o/=10;if(o=.15>o?.1:.3>o?.2:.75>o?.5:1,t>0&&(n-=t),n>0)for(r=0;n>r;r++)o*=10;else for(r=n;0>r;r++)o/=10;return o},At=function(e){ce.call(this,e)};K(At,ce),At.prototype._createItem=function(){return new Lt(this.owner)};var Rt=function(e,t){var r=this;r.series=e,r.group=t},Bt=function(e,t,r){var o=this;Rt.call(o,e,t),o.rect=r};Bt.prototype={inRange:function(e,t){var r=this.rect,o=r.Width(),n=r.Height();return(4>o||4>n)&&(r=r.clone(),4>o&&(r.left-=2,r.right+=2),4>n&&(r.top-=2,r.bottom+=2)),r.PtInRect(e,t)},tooltipPos:function(){var e=this.rect;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}};var Mt=function(e,t,r,o,n,a,i){var l=this;Rt.call(l,e,t),l.x=r,l.y=o,l.r=n,l.beginAngle=a,l.endAngle=i};Mt.prototype={inRange:function(e,t){function r(){var r=e-o.x,n=t-o.y,a=Math.sqrt(r*r+n*n),i=Math.atan2(n,r);return 0>n&&(i+=2*Math.PI),{angle:360-ie(i),distance:a}}var o=this,n=r();return o.beginAngle<=n.angle&&n.angle<o.endAngle&&n.distance<o.r},tooltipPos:function(){var e=this,t=-le(e.beginAngle+e.endAngle)/2,r=e.r/2;return{x:e.x+Math.cos(t)*r,y:e.y+Math.sin(t)*r}}};var kt=function(e,t,r,o,n){var a=this;Rt.call(a,e,t),a.x=r,a.y=o,a.r=n};kt.prototype={inRange:function(e,t){var r=this,o=e-r.x,n=t-r.y;return Math.sqrt(o*o+n*n)<=r.r},tooltipPos:function(){var e=this;return{x:e.x+4,y:e.y-4-It.prototype.options.tooltipFontSize}}};var Nt=function(e){var t=this;Te.call(t,e),t.LinePen=new _,t.CoordLinePen=new _,t.Label="",t.Max=0,t.Min=0,t.Space=0,t.TextAngle=0,t.TextVisible=!0,t.TextFormat="0.##",t.LineVisible=!0,t.CoordLineVisible=!1,t.MarginBeginWeight=25,t.MarginEndWeight=25,t.Scales=[],t.CustomCoordLines=[]};Nt.prototype={children:["LinePen","CoordLinePen"],afterLoad:function(e){var t=this,r=t.report.viewer.alpha.chartStroke,o=t.report.isWR;t.LinePen.loadFromJSON(e.LinePen,r,o),t.CoordLinePen.loadFromJSON(e.CoordLinePen,r,o)},CalcLabelHeight:function(){var e=this;return e.Used&&e.Label?e.owner.fontHeight+Pt/2:0},CalcHorzAxisHeight:function(e){return this.DoCalcAxisSize(!0,e)},CalcVertAxisWidth:function(){return this.DoCalcAxisSize(!1,!1)},DoCalcAxisSize:function(e,t){var r,o=this,n=o.owner,a=[],i=o.owner.fontHeight,l=0;if(o.Used){if(o.TextVisible&&(!e||!n.IsDrawNegativeGraph())){if(t)a.push("1Agf");else if(o.IsValueAxis)if(o.Scales.length)o.Scales.forEach((function(e){a.push(e.Text)}));else for(r=o.DrawMin;r<o.DrawMax+o.GetScaleTiny();r+=o.DrawSpace)a.push(o.ScaleFormatParser.format(r));else for(r=0;r<n.GroupCount;r++)a.push(n.GroupLabels[r]);-270===o.TextAngle?(a.forEach((function(e){l=Math.max(l,e.length)})),l*=i):(a.forEach((function(e){l=Math.max(l,n.context.measureTextWidth(e))})),e&&(l=Math.abs(Math.sin(le(o.TextAngle))*l)+1+i))}n.Chart3DReal&&n.IsHorzGraph()&&n.YAxis===o&&(l+=n.yView3DDepth),o.LineVisible&&(l+=Dt),l&&(l+=Pt)}return l},CalcGroupPos:function(e,t){var r=this,o=r.owner,n=o.IsHorzGraph()?o.CalcColumnBarCount():o.CalcBarCount(),a=r.MarginBeginWeight+r.MarginEndWeight+100*(o.GroupCount-1)+(n>0?o.BarWidthPercent:0),i=a?e*r.MarginBeginWeight/a:0,l=a?e*r.MarginEndWeight/a:0,s=e-i-l,u=n>0?o.BarWidthPercent:0,c=100*t,d=c+u,p={};return a-=r.MarginBeginWeight+r.MarginEndWeight,p.BeginPos=i,p.EndPos=i,a>0&&(p.BeginPos+=s*c/a,p.EndPos+=s*d/a),p.LabelMiddlePos=(p.BeginPos+p.EndPos)/2,p},DrawHorzAxisLabel:function(e){var t=this,r=t.owner.context;!e.IsRectEmpty()&&t.Label&&r.drawText(t.Label,(e.left+e.right-r.measureTextWidth(t.Label))/2,(e.top+e.bottom-t.owner.fontHeight)/2)},DrawVertAxisLabel:function(e){var t=this,r=t.owner.context;!e.IsRectEmpty()&&t.Label&&r.drawTextRotate(t.Label,(e.left+e.right-t.owner.fontHeight)/2,(e.top+e.bottom+r.measureTextWidth(t.Label))/2,90)},DrawAxisTextsPrepare:function(e){var t,r=this,o=r.owner,n=[];if(r.IsValueAxis)if(r.Scales.length)r.Scales.forEach((function(t){n.push({Text:t.Text,PosVal:r.CalcValuePos(t.PosVal,e)})}));else for(t=r.DrawMin;t<r.DrawMax+r.GetScaleTiny();t+=r.DrawSpace)n.push({Text:r.ScaleFormatParser.format(t),PosVal:r.CalcValuePos(t,e)});else for(t=0;t<o.GroupCount;t++)n.push({Text:o.GroupLabels[t]||"",PosVal:r.CalcGroupPos(e,t).LabelMiddlePos});return n},DrawHorzAxis:function(e,t,r){function o(e,t,r,o,n){var a,i,l,s,u=p.owner.context,c=r.length,d=p.owner.fontHeight;if(o?(i=e.bottom-1,p.LineVisible&&(i-=Dt),h.Chart3DReal&&(i-=h.yView3DDepth),t+=h.xView3DDepth):(i=e.top+1,p.LineVisible&&(i+=Dt)),-270===p.TextAngle)for(s=u.measureTextWidth("A"),a=e.left+t-s,o&&(i-=d*c),l=0;c>l;l++)u.drawText(r.charAt(l),a,i),i+=d;else s=u.measureTextWidth(r),a=e.left+t-Math.abs(s/2*Math.cos(le(p.TextAngle)))+Math.abs(d/2*Math.sin(le(p.TextAngle))),o&&(i-=d),n||(i-=d+2*Dt-1),u.drawTextRotate(r,a,i,p.TextAngle)}var n,a,i,l,s,u,c,d,p=this,h=p.owner,f=h.context,g=e.Width()-h.xView3DDepth,m=h.IsDrawNegativeGraph(),_=p.IsValueAxis,C=p.LinePen,v=C.clone(),T=C.clone();p.Used&&!e.IsRectEmpty()&&(v.Width=.5,T.Width=.5,T.Color=Y(C.Color),p.LineVisible&&(f.selectPen(C),a=e.left,i=a+h.xView3DDepth,l=a+g,s=l+h.xView3DDepth,u=r?e.bottom:e.top,c=u-h.yView3DDepth,d=r?t.bottom-2*h.yView3DDepth:t.top,f.DrawHorzLine(u,a,l),h.Chart3DReal&&(h.YAxis.Used||!h.Y2Axis.Used||h.IsHorzGraph()?(f.drawPolyLine([l,u,s,c,i,c],0),f.drawPolyLine([s,c,s,d,i,d],0)):(f.drawPolyLine([s,c,i,c,a,u],0),f.drawPolyLine([s,d,i,d,i,c],0))),f.restorePen()),n=p.DrawAxisTextsPrepare(g),f.selectPen(v),n.forEach((function(n,a){var i,l,s=h.IsScatterGraph()||!m||(p.IsValueAxis?n.PosVal>=0:h.Value(0,a)>=0),u=e.left+n.PosVal;p.LineVisible&&(r?(u+=h.xView3DDepth,l=e.bottom-h.yView3DDepth,i=l-Dt):(i=e.top+1,l=s?e.top+1+Dt:e.top+1-Dt),f.DrawVertLine(u,i,l),h.Chart3DReal&&!_&&(r&&(u-=h.xView3DDepth,i+=h.yView3DDepth+Dt),f.selectPen(T),f.drawLine(u,i,u+h.xView3DDepth,i-h.yView3DDepth),f.restorePen())),p.TextVisible&&o(e,n.PosVal,n.Text,r,s),p.CoordLineVisible&&!_&&p.IsValueAxis&&(f.selectPen(p.CoordLinePen),i=t.top+1,l=t.bottom-h.yView3DDepth,r&&(i-=h.yView3DDepth,l-=h.yView3DDepth),f.DrawVertLine(u+h.xView3DDepth,i,l),f.restorePen()),_=!1})),f.restorePen(),p.CustomCoordLines.forEach((function(n){var a=p.CalcValuePos(n.PosVal,g);n.Text&&o(e,a,n.Text,r,!0),f.selectPen(n.LinePen),f.DrawVertLine(e.left+a,t.top+1,t.bottom),f.restorePen()})))},DrawVertAxis:function(e,t,r,o){function n(e,t,r,o){var n=d.owner.context;n.drawText(r,o?e.left+(d.LineVisible?Dt:0):e.right-n.measureTextWidth(r)-(d.LineVisible?Dt:0),t-d.owner.fontHeight/2)}var a,i,l,s,u,c,d=this,p=d.owner,h=p.context,f=e.Height()-p.yView3DDepth,g=d.LinePen,m=g.clone(),_=g.clone();!e.IsRectEmpty()&&d.Used&&(m.Width=.5,_.Width=.5,_.Color=Y(g.Color),d.LineVisible&&(h.selectPen(g),a=r?e.left-p.xView3DDepth:e.right,i=e.bottom,o&&(i-=p.yView3DDepth),l=i-f,h.DrawVertLine(a,l,i+1),p.Chart3DReal&&(s=a+p.xView3DDepth,u=i-p.yView3DDepth,h.drawPolyLine([a,i,s,u,s,u-f,a,l],0)),h.restorePen()),h.selectPen(m),c=d.DrawAxisTextsPrepare(f),c.forEach((function(a,i){var l,s,u=d.IsValueAxis?e.bottom-a.PosVal:e.top+a.PosVal+(o?0:p.yView3DDepth),c=u;d.LineVisible&&a.PosVal!=d.DrawMin&&(l=e.right-Dt,s=e.right,r&&(l=e.left,s=e.left+Dt),h.DrawHorzLine(c,l,s),p.Chart3DReal&&(h.selectPen(_),r?(l=e.left-p.xView3DDepth,c+=p.yView3DDepth):l=e.right,h.drawLine(l,c,l+p.xView3DDepth,c-p.yView3DDepth),h.restorePen())),d.TextVisible&&n(e,u,a.Text,r),d.CoordLineVisible&&d.IsValueAxis&&(h.selectPen(d.CoordLinePen),c-=p.yView3DDepth,h.DrawHorzLine(c,t.left+p.xView3DDepth+g.Width,t.right),h.restorePen())})),h.restorePen(),d.CustomCoordLines.forEach((function(o){var a=e.bottom-d.CalcValuePos(o.PosVal,f);o.Text&&n(e,a,o.Text,r),h.selectPen(o.LinePen),h.DrawHorzLine(a-p.yView3DDepth,t.left+p.xView3DDepth+g.Width,t.right),h.restorePen()})))},PrepareDraw:function(){var e=this;e.Used=!1,e.IsValueAxis=!1,e.DrawMax=-Number.MAX_VALUE,e.DrawMin=Number.MAX_VALUE,e.DrawSpace=0,e.ScaleFormatParser=new p(e.TextFormat)},PrepareDrawRange:function(){var e=this;e.Max?e.DrawMax=e.Max:e.Scales.forEach((function(t){e.DrawMax=Math.max(e.DrawMax,t.PosVal)})),e.Min?e.DrawMin=e.Min:e.DrawMin>0&&e.DrawMax>0?e.DrawMin=0:e.DrawMin<0&&e.DrawMax<0?e.DrawMax=0:e.owner.NegativeAsZero&&(e.DrawMin=0),e.DrawMax<=e.DrawMin&&(e.DrawMin=0,e.DrawMax=100)},PrepareDrawSpace:function(e,t,r){var o,n=this;n.Space?n.DrawSpace=n.Space:(o=n.owner.fontHeight*t,n.DrawSpace=(n.DrawMax-n.DrawMin)*o/e,n.DrawSpace=Et(n.DrawSpace,n.ScaleFormatParser.positiveAnalyser.precision)),n.DrawMax<=n.DrawMin&&(n.DrawMax=n.DrawMin+1,n.DrawSpace=.2),n.DrawSpace<2*n.GetScaleTiny()&&(n.DrawSpace=2*n.GetScaleTiny()),n.Max||n.Min||r||(n.DrawMax>0&&(n.DrawMax=n.DrawSpace*Math.ceil(n.DrawMax/n.DrawSpace)),n.DrawMin<0&&(n.DrawMin=n.DrawSpace*Math.floor(n.DrawMin/n.DrawSpace)))},GetScaleTiny:function(){var e=this;return(e.DrawMax-e.DrawMin)/1e4},CalcValuePos:function(e,t){var r=this;return(e-r.DrawMin)*t/(r.DrawMax-r.DrawMin)},get ScaleCount(){return this.Scales.length},AddCustomScale:function(e,t){this.Scales.push({PosVal:e,Text:t})},EmptyCustomScale:function(){this.Scales=[]},GetScaleText:function(e){return this.Scales[e].Text},GetScaleValue:function(e){return this.Scales[e].PosVal},AddCustomCoordLine:function(e,t,r,o,n){var a=new _;a.Width=r,a.Style=n,a.Color=o,this.CustomCoordLines.push({PosVal:e,Text:t,LinePen:a})},EmptyCustomCoordLine:function(){this.CustomCoordLines=[]}},X(Nt,Te);var Lt=function(e){var t=this;Te.call(t,e),t.ChartType=1,t.ByY2Axis=!1,t.SeriesName="",t.XValueField="",t.YValueField="",t.ZValueField="",t.FillColor=0,t.FillColorAuto=!0,t.LabelText="",t.LabelAsGroup=!1,t.LabelInBar=!1,t.LabelTextAngle=0,t.TooltipText="",t.ValueFormat="0.##",t.MarkerStyle=3,t.MarkerSize=4,t.MarkerColor=16777215,t.MarkerColorAuto=!0,t.MarkerLegendShow=!0,t.BorderPen=new _,t.MarkerPen=new _};Lt.prototype={afterLoad:function(e){var t=this,r=t.report.viewer.alpha,o=r.chartGraph,a=r.chartStroke,i=t.report.isWR;"StepBarChart"===t.ChartType?t.ChartType=4:F(t,"ChartType",n.ChartType),F(t,"MarkerStyle",n.PointMarkerStyle),E(t,"FillColor",o),E(t,"MarkerColor",o),t.BorderPen.loadFromJSON(e.BorderPen,a,i),t.MarkerPen.loadFromJSON(e.MarkerPen,a,i)},PrepareDraw:function(){var e=this;e.ValueFormatParser=new p(e.ValueFormat)},IsHorzGraph:function(){var e=this;return 11===e.ChartType||12===e.ChartType||13===e.ChartType},IsPercent100Graph:function(){var e=this;return 2===e.ChartType||10===e.ChartType||13===e.ChartType},IsBarChart:function(){var e=this;return 1===e.ChartType||4===e.ChartType||10===e.ChartType||11===e.ChartType||12===e.ChartType||13===e.ChartType},IsScatterGraph:function(){var e=this;return 5===e.ChartType||6===e.ChartType||8===e.ChartType||9===e.ChartType},CanGroupLabelChart:function(){var e=this;return 1===e.ChartType||11===e.ChartType},HasPointMarker:function(){var e=this;return 3===e.ChartType||7===e.ChartType||5===e.ChartType||6===e.ChartType||8===e.ChartType||9===e.ChartType},Support3D:function(){var e=this;return 1===e.ChartType||4===e.ChartType||10===e.ChartType||11===e.ChartType||12===e.ChartType||13===e.ChartType||2===e.ChartType}},X(Lt,Te);var It=function(e){var t=this;Me.call(t,e),t.XAxis=new Nt(t),t.YAxis=new Nt(t),t.Y2Axis=new Nt(t),t.Series=new At(t),t.Recordset=new et(t),t.TitleFont=new T(t.Font),t.ValueFont=new T(t.Font),t.Title="",t.Chart3D=!1,t.Chart3DViewAngle=35,t.LegendVisible=!0,t.LegendValueVisible=!1,t.LegendShowSum=!1,t.LegendAtBottom=!1,t.LegendColumnCount=0,t.LegendSumLabel="",t.SeriesField="",t.SeriesAuto=!0,t.GroupField="",t.GroupAuto=!0,t.GroupCount=5,t.SeriesCount=2,t.AbsNegativeValue=!1,t.NegativeBarColor=255,t.BarWidthPercent=70,t.NegativeAsZero=!1,t.SingleSeriesColored=!0,t.Bar3DAxisDepth=25,t.Pie3DHeightDepth=25,t.BubbleScalePerCm=0,t.SeriesLabels=[],t.GroupLabels=[],t.values=[]};It.prototype={ControlType:11,children:["Border","XAxis","YAxis","Y2Axis","Series"],options:{tooltipBoxColor:"rgba(0,0,0,.8)",tooltipBoxCorner:4,tooltipFontSize:14,tooltipFontStyle:"normal",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontColor:"#fff"},afterLoad:function(e){var t,r,o=this,n=o.report.viewer.alpha,a=n.chartGraph,i=n.chartStroke,l=o.report.isWR;if(Me.prototype.afterLoad.call(o,e),E(o,"NegativeBarColor",a),o.XAxis.loadFromJSON(e.XAxis,i),o.YAxis.loadFromJSON(e.YAxis,i),o.Y2Axis.loadFromJSON(e.Y2Axis,i),o.Series.loadFromJSON(e.ChartSeries),o.Recordset.loadFromJSON(e.Recordset),o.TitleFont.loadFromJSON(e.TitleFont,l),o.ValueFont.loadFromJSON(e.ValueFont,l),o.prepareValues(),t=e[o.getJsonMember("GroupLabel")],t&&(o.GroupLabels=t.split("\r")),t=e[o.getJsonMember("SeriesLabel")],t&&(o.SeriesLabels=t.split("\r")),t=e[o.getJsonMember("Value")]){for(t=t.split(","),r=t.length;r-- >0;)t[r]=+t[r];for(o.values=[],r=0;r<o.SeriesCount;)o.values.push(t.slice(r++*o.GroupCount,r*o.GroupCount))}},assign:function(e){var t=this;Me.prototype.assign.call(t,e),t.TitleFont.assign(e.TitleFont),t.ValueFont.assign(e.ValueFont),t.XAxis.assign(e.XAxis),t.YAxis.assign(e.YAxis),t.Y2Axis.assign(e.Y2Axis),t.Series.assign(e.Series),t.Recordset.assign(e.Recordset)},bindRecordset:function(){var e=this,t=e.Recordset;t.prepare(),e.oSeriesField=t.FieldByName(e.SeriesField),e.oGroupField=t.FieldByName(e.GroupField),e.Series.forEach((function(e){e.oYValueField=t.FieldByName(e.YValueField),e.IsScatterGraph()&&(e.oXValueField=t.FieldByName(e.XValueField),9===e.ChartType&&(e.oZValueField=t.FieldByName(e.ZValueField)))}))},unprepare:function(){var e=this;Me.prototype.unprepare.call(e),e.Recordset.unprepare()},loadDrawingData:function(){function e(){return s.Series.items.every((function(e){return e.oYValueField&&(!e.IsScatterGraph()||e.oXValueField&&(9!==e.ChartType||e.oZValueField))}))}function t(e,t,r){var o=0,n=e.RecordCount;for(t&&(t.recordset.MoveTo(r-1),o=t.beginNoField.AsInteger,n=t.endNoField.AsInteger+1);n>o;)e.MoveTo(o++),c.appendRefRecord(e.curRecord)}function r(e,t){var r,n=f.Groups.items,a=[],l="",s=[];for(e.recordset.MoveTo(t-1),i.MoveTo(e.beginNoField.AsInteger),r=e.index;r>=0;r--)l&&(l+=";"),l+=n[r].ByFields;for(o.decodeFields(l).forEach((function(e){a.indexOf(e)<0&&a.push(e)})),a.forEach((function(e){var t=i.Fields.itemByName(e.Name);t&&s.push({origin:e,detail:t})})),o.First();!o.Eof();)s.every((function(e){return!e.detail.valUeq(e.origin)}))&&c.appendRefRecord(o.curRecord),o.Next()}var o,n,a,i,l,s=this,u=s.origin,c=s.Recordset,d=s.owner.owner,p=s.runningNo,h=s.report,f=h.DetailGrid;s.bindRecordset(),e()?(c.RecordCount||(f&&(i=f.Recordset),d.ByFields&&(l=d),p>=1e4&&(p=Math.floor(p/1e4),n=h.ownerSR,d=n.owner.owner,h=d.report,l||f?n._relations&&(--p,d.ByFields&&(d.recordset.MoveTo(p),p=d.beginNoField.AsInteger),h.DetailGrid.Recordset.MoveTo(p),a=1,n.attachRelationTable()):(d.ByFields&&(l=d),f=h.DetailGrid,f&&(i=f.Recordset))),u&&(o=u.Recordset),o&&o.RecordCount?l?r(l,p):c._dataTable=u._dataTable:t(i,l,p),a&&n.detachRelationTable()),s.applyDataFromRecordset()):s.values||s.EmptyValues()},applyDataFromRecordset:function(){var t,r,o,n,a,i,l=this,s=l.Recordset,u=l.Series.items,c=u[0].IsScatterGraph();for(l.SeriesAuto&&l.oSeriesField&&(l.SeriesCount=0,l.SeriesLabels=[]),!c&&l.GroupAuto&&l.oGroupField&&(l.GroupCount=0,l.GroupLabels=[]),l.EmptyValues(),s.First();!s.Eof();)t=0,l.oSeriesField&&(r=l.oSeriesField.DisplayText,t=l.GetSeriesIndexByLabel(r,!1),0>t&&l.SeriesAuto&&(t=l.SeriesCount,l.SeriesLabels.push(r),++l.SeriesCount)),o=0,l.oGroupField&&!c&&(n=l.oGroupField.DisplayText,o=l.GetGroupIndexByLabel(n,!1),0>o&&l.GroupAuto&&(o=l.GroupCount,l.GroupLabels.push(n),++l.GroupCount)),u.forEach((function(r,n){n&&(t=n),c?l.AddXYZValue(t,r.oXValueField.AsFloat,r.oYValueField.AsFloat,r.oZValueField?r.oZValueField.AsFloat:e):(a=r.oYValueField.AsFloat,i=l.Value(t,o),i&&(a+=i),l.SetValue(t,o,a))})),s.Next()},showTooltip:function(t,r){var o=this,n=o.options,a=o.context;if(t||(t=e),o.activeShape!==t&&(o.activeShape=t,a.ctx.clearRect(0,0,o.canvas.width,o.canvas.height),o.draw(),t)){var i=o.graphSerieses[t.series];if(i.TooltipTextBuilder){var l,s=a.ctx.font,u=i.TooltipTextBuilder.generateChartDisplayText(t.series,t.group),c=t.tooltipPos(),d=n.tooltipFontSize+2,p=0;if(a.ctx.font=A(n.tooltipFontSize,n.tooltipFontStyle,n.tooltipTitleFontFamily),i.tooltipLines>1){l=[];for(var h,f,g=0;(h=u.indexOf("\n",g))>=0;)f=u.substring(g,h-("\r"===u.charAt(h-1)?1:0)),l.push(f),p=Math.max(p,a.measureTextWidth(f)),g=h+1;f=u.substr(g),l.push(f),p=Math.max(p,a.measureTextWidth(f))}else p=a.measureTextWidth(u);var _=new m(c.x,c.y,c.x+p,c.y+d*i.tooltipLines-2);if(_.InflateRect(n.tooltipBoxCorner,n.tooltipBoxCorner),_.OffsetRect(Math.min(o.canvas.width-_.right,0),Math.min(o.canvas.height-_.bottom,0)),a.selectFillStyle(n.tooltipBoxColor),a.roundRectangle(_.left,_.top,_.Width(),_.Height(),n.tooltipBoxCorner,n.tooltipBoxCorner,1),a.restoreFillStyle(),a.selectFillStyle(n.tooltipFontColor),l){var C=_.left+n.tooltipBoxCorner,v=_.top+n.tooltipBoxCorner;l.forEach((function(e){a.drawText(e,C,v),v+=d}))}else a.drawTextCenter(u,(_.left+_.right)/2,(_.top+_.bottom-n.tooltipFontSize)/2);a.restoreFillStyle(),a.ctx.font=s}}},prepareCanvas:function(){function e(){var e,t,r=a.Series.items,o=r.length;for(e=0;o>e;e++)if(t=r[e],t.LabelText&&(t.LabelTextBuilder=new f(a,t.LabelText)),t.TooltipText){t.TooltipTextBuilder=new f(a,t.TooltipText),t.tooltipLines=1;for(var n=0;(n=t.TooltipText.indexOf("\n",n))>=0;)++n,++t.tooltipLines;c=1}}function t(){var e=le(a.Chart3DViewAngle);a.xView3DDepth=Math.cos(e)*a.Bar3DAxisDepth,a.yView3DDepth=Math.sin(e)*a.Bar3DAxisDepth}function r(){var e,t,r=a.Series.items,o=a.graphs=[],n=a.graphSerieses=[];for(e=0;e<a.SeriesCount;e++){t=e<r.length?r[e]:r[0],n.push(t);for(var i=0;i<o.length;i++)if(t.ChartType===n[o[i][0]].ChartType){o[i].push(e);break}i===o.length&&o.push([e])}}function o(e){var t,r,o=a.shapes.length;if(a.graphs.length>1)for(t=0;o>t;t++)if(r=a.shapes[t],!r.rect&&r.inRange(e.x,e.y))return r;for(t=0;o>t;t++)if(r=a.shapes[t],r.inRange(e.x,e.y))return r;return 0}function n(e){for(var t,r=a.shapesL.length;r-- >0;)if(t=a.shapesL[r],t.inRange(e.x,e.y))return t;return 0}var a=this,i=a.onclickGraph,l=a.onclickLegend,s=a.ondblclickGraph,u=a.ondblclickLegend,c=0;a.Chart3DReal=a.Chart3D&&a.Support3D(),a.xView3DDepth=0,a.yView3DDepth=0,a.Chart3DReal&&t(),a.loadDrawingData(),e(),r(),c&&ne(a,["mousemove","touchstart","touchmove","mouseout"],(function(e){var t,r;"mouseout"!==e.type&&(t=re(e),r=o(t)),a.showTooltip(r,t)})),(i||l)&&oe(a.canvas,"click",(function(e){var t,r=re(e);i&&(t=o(r),t&&i(e,a,t.series,t.group)),l&&(t=n(r),t&&l(e,a,t.series,t.group))})),(s||u)&&oe(a.canvas,"dblclick",(function(e){var t,r=re(e);s&&(t=o(r),t&&s(e,a,t.series,t.group)),u&&(t=n(r),t&&u(e,a,t.series,t.group))}))},draw:function(t){function r(){function e(){var e,o,n;c.DrawBubbleScalePerCm=c.BubbleScalePerCm,c.DrawBubbleScalePerCm<=0&&(e=r*t*bt,o=e/(wt*wt),c.DrawBubbleScalePerCm=f/o),n=Math.sqrt(d/c.DrawBubbleScalePerCm)*wt,0===x.Max&&(x.DrawMax+=(x.DrawMax-x.DrawMin)*(n/2)/t),0==T.Max&&(T.DrawMax+=(T.DrawMax-T.DrawMin)*(n/2)/r)}var t,r,o=c.IsScatterGraph(),n=c.Series.items,a=n[0].ChartType,i=10===a||13===a,d=0,f=0;for(T.PrepareDraw(),x.PrepareDraw(),w.PrepareDraw(),s=n.length,l=0;s>l;l++)n[l].PrepareDraw(this);T.Used=!0,T.IsValueAxis=!1,x.IsValueAxis=!0,w.IsValueAxis=!0,c.Title&&(y=R(c.getUsingTitleFont())+Ft),o?(T.IsValueAxis=!0,C.forEach((function(e){e.forEach((function(e){var t,r=c.values[e],o=r?r.length:0,n=T,a=c.YAxisOfSeries(v[e]);for(a.Used=!0,l=0;o>l;l++)t=r[l],t.y<a.DrawMin&&(a.DrawMin=t.y),t.y>a.DrawMax&&(a.DrawMax=t.y),t.x<n.DrawMin&&(n.DrawMin=t.x),t.x>n.DrawMax&&(n.DrawMax=t.x),d<t.z&&(d=t.z),f+=t.z}))})),T.PrepareDrawRange()):C.forEach((function(e){var t,r,o=v[e[0]].ChartType,n=4===o||10===o||12===o||13===o;for(t=0;t<c.GroupCount;t++)if(r=0,e.forEach((function(e){var o=c.Value(e,t),a=c.YAxisOfSeries(v[e]);n?r+=o:(a.Used=!0,c.AbsNegativeValue&&(o=Math.abs(o)),o<a.DrawMin&&(a.DrawMin=o),o>a.DrawMax&&(a.DrawMax=o))})),n){var a=v[e[0]],l=c.YAxisOfSeries(a);l.Used=!0,i?(l.DrawMin=0,l.DrawMax=100):(r<l.DrawMin&&(l.DrawMin=r),r>l.DrawMax&&(l.DrawMax=r))}})),x.Used||w.Used||(x.Used=!0),x.Used&&(u=x.DrawMax),w.Used&&u<w.DrawMax&&(u=w.DrawMax),x.PrepareDrawRange(),w.PrepareDrawRange(),t=h-y-T.CalcLabelHeight()-T.CalcHorzAxisHeight(!0),t=Math.max(t,1),x.PrepareDrawSpace(t,3,i),w.PrepareDrawSpace(t,3,i),o&&(r=p-x.CalcLabelHeight()-x.CalcVertAxisWidth()-w.CalcLabelHeight()-w.CalcVertAxisWidth(),r=Math.max(r,1),T.PrepareDrawSpace(r,6,!1),t=h-y-T.CalcLabelHeight()-T.CalcHorzAxisHeight(!1),t=Math.max(t,1),9===n[0].ChartType&&e())}function o(t){function r(){var e=t.Series.items[0].ChartType;return 1===t.SeriesCount&&t.SingleSeriesColored&&(1===e||3===e||7===e||11===e)}function o(){return t.LegendValueVisible&&(!t.IsScatterGraph()||9===t.Series.items[0].ChartType)}function n(){return t.LegendShowSum&&o()}function a(){return(r()?t.GroupCount:t.SeriesCount)+(n()?1:0)}function i(e){return r()?e===t.GroupCount:e===t.SeriesCount}function l(e){return i(e)?t.LegendSumLabel||"合计":r()?t.GroupLabels[e]:t.getSeriesShowLabel(e)}function s(o){var n,a=t.graphSerieses[0];return i(o)?n=t.GetTotalValue():r()?n=t.Value(0,o):(n=t.GetSeriesTotalValue(o),a=t.graphSerieses[o]),n===e?"":a.ValueFormatParser.format(n)}function u(e){var t={series:-1,group:-1};return i(e)||(r()?t.group=e:t.series=e),t}function c(e,o){var n,a,i=t.context,l=t.GetGraphFillColor(e);r()||(a=t.graphSerieses[e],n=a.HasPointMarker()&&a.MarkerLegendShow,n&&i.DrawPointMarker(o,a.MarkerStyle,a.MarkerPen,l)),n||(i.selectFillColor(l),i.rectangle2(o,1),i.restoreFillStyle())}function d(e){var r,n,d,p,h,f,g,_,C=t.context,v=o(),T=t.LegendColumnCount,x=T>0?T:999,b=e.Width(),w=2*t.fontHeight,y=3*w/4,S=a(),D=b,F=[],P={Count:0,Width:0};if(!S)return 0;for(n=0;S>n;++n)r=Ft+y+Pt,r+=C.measureTextWidth(l(n)),v&&(r+=Pt+C.measureTextWidth(s(n))),(r>D||P.Count>=x)&&P.Width>0&&(F.push(P),P={Count:0,Width:0},D=b),P.Count++,P.Width+=r,D-=r;for(P.Count>0&&F.push(P),p=Pt+F.length*w,d=0,P=F[d],n=e.bottom-p+Pt,h=new m((e.left+e.right-P.Width)/2,e.bottom-p+Pt,0,n+w),n=0;S>n;++n)P.Count<=0&&(d++,P=F[d],h.left=(e.left+e.right-P.Width)/2,h.top=h.bottom,h.bottom+=w),P.Count--,h.left+=Ft,b=h.left,(S-1>n||!i(n))&&(r=(h.top+h.bottom-y)/2,f=new m(h.left,r,h.left+y,r+y),c(n,f)),h.left+=y,g=(h.top+h.bottom-t.fontHeight)/2,_=l(n),h.left+=Pt,h.right=h.left+C.measureTextWidth(_),C.drawText(_,h.left,g),h.left=h.right,v&&(_=s(n),h.left+=Pt,h.right=h.left+C.measureTextWidth(_),C.drawText(_,h.left,g),h.left=h.right),t.toUpdateShapes&&(x=u(n),t.shapesL.push(new Bt(x.series,x.group,new m(b,h.top,h.right,h.bottom))));return p}function p(e){var r,i,d,p,h,f,g,C,v,T,x,b,w,y,S=t.context,D=o(),F=n(),P=a(),E=t.LegendColumnCount,A=2*t.fontHeight,R=3*A/4,B=e.Height()-2*Pt,M=0,k=0,N=2*Pt,L=[],I=[];if(!P)return 0;for(p=0;P>p;++p)f=S.measureTextWidth(l(p)),f>M&&(M=f),g=A,N+=g,L.push(g),D&&(f=S.measureTextWidth(s(p)),f>k&&(k=f));if(r=M+Pt,k>0&&(r+=k+Pt),0>=E&&(E=1,N>e.Height()))for(f=0,p=0;P>p;++p)f>B&&(E++,f=L[p]);if(B<L[0])return 0;for(p=0,f=0;E>f;f++)for(g=B;P>p&&g>L[p];)g-=L[p++];for(i=P>p,i&&(f=P,F&&(p--,f--),L.splice(p,f-p)),f=L.length,g=E,C=Math.ceil(f/E),I=Z(E,0),F&&(I[E-1]=C,f-=C,g--,g>0&&(C=Math.ceil(f/g))),p=0;g>p;p++)I[p]=Math.min(C,f),f-=I[p];for(g=0,p=0,f=0;E>f;f++){for(C=0,h=0;h<I[f];h++)C+=L[p++];C>g&&(g=C)}for(N=Math.min(e.Height(),g+2*Pt),v=Pt+R+Pt+r,T=v*E+Pt,T>2*e.Width()/3&&(T=2*e.Width()/3,g=v,v=(T-Pt)/E,M-=g-v),f=e.right-T,g=(e.top+e.bottom-N)/2,x=new m(f,g,f+T,g+N),S.rectangle2(x),f=x.left+Pt,g=v-Pt,b=new m(f,0,f+R,0),f+=b.Width()+Pt,g-=b.Width()+Pt,w=new m(f,x.top+Pt,f+Math.min(g,M+Pt),0),f+=w.Width()+Pt,g-=w.Width()+Pt,y=new m(f,0,f+g,0),f=L.length-1,F&&f--,g=0,p=0;E>p;p++){for(w.top=x.top+Pt,h=0;h<I[p];++h)w.bottom=w.top+L[g],C=(w.top+w.bottom-t.fontHeight)/2,i&&f===g?S.drawText("... ...",b.left,C):(b.top=(w.top+w.bottom-R)/2,b.bottom=b.top+R,d=F&&g===L.length-1,d?g=P-1:c(g,b),S.drawText(l(g),w.left,C),D&&S.drawTextAlign(s(g),y.left,C,y.Width(),t.fontHeight,20),d&&(S.selectPen(new _(.5,0,0)),S.DrawHorzLine(w.top,b.left,y.right),S.restorePen())),t.toUpdateShapes&&(M=u(g),t.shapesL.push(new Bt(M.series,M.group,new m(b.left,b.top,y.right,b.bottom)))),w.top+=L[g++];b.left+=v,b.right+=v,w.left+=v,w.right+=v,y.left+=v,y.right+=v}return T}var h;t.LegendAtBottom?(h=d(g),g.bottom-=h+Ft):(h=p(g),g.right-=h+Ft)}function n(){f.selectFont(c.getUsingTitleFont()),f.drawTextCenter(c.Title,(g.left+g.right)/2,g.top+Ft/2),f.restoreFont()}function a(e){var t,r,o,n,a,i,l,s,d=c.Series.items,p=T.CalcLabelHeight(),h=T.CalcHorzAxisHeight(!1),g=x.CalcLabelHeight(),_=x.CalcVertAxisWidth(),b=w.CalcLabelHeight(),y=w.CalcVertAxisWidth(),S=0,D=0,F=!1;for(r=d.length,t=0;r>t;t++)if(o=d[t],o.LabelTextBuilder&&!o.LabelInBar){F=!0;break}if(!F&&c.Title||(S=R(c.getUsingValueFont())/(o.LabelTextBuilder?1:2),c.IsDrawNegativeGraph()&&(D=S),o.LabelTextAngle&&(f.selectFont(c.getUsingValueFont()),S=Math.max(Math.abs(f.measureTextWidth(o.ValueFormatParser.format(u))*Math.sin(le(o.LabelTextAngle))),S),f.restoreFont())),a=new m(e.left+g+_,e.top+S,e.right-b-y,e.bottom-p-h-D),l=new m(e.left,e.top+S,e.left+g,e.bottom-p-h-D),x.DrawVertAxisLabel(l),s=new m(e.right-b,l.top,e.right,l.bottom),w.DrawVertAxisLabel(s),l.left=l.right,l.right+=_,x.DrawVertAxis(l,a,!1),s.right=s.left,s.left-=y,w.DrawVertAxis(s,a,!0),i=new m(e.left+g+_,e.bottom-p,e.right-b-y,e.bottom),T.DrawHorzAxisLabel(i),c.IsDrawNegativeGraph()?(i.top=l.bottom-x.CalcValuePos(0,l.Height()),i.bottom=i.top+h):(i.top=a.bottom,i.bottom=i.top+h),c.Chart3D&&T.DrawHorzAxis(i,a,!1),!a.IsRectEmpty()&&(c.IsScatterGraph()||c.GroupCount)){for(f.selectFont(c.getUsingValueFont()),r=C.length,t=0;r>t;t++)switch(o=C[t],n=v[o[0]].ChartType){case 1:c.DrawBar(o,a);break;case 4:case 10:c.DrawStackedBar(o,n,a);break;case 3:case 7:c.DrawLine(o,n,a);break;case 9:c.DrawBubble(o,a);break;default:c.DrawXYScatterGraph(o,n,a)}f.restoreFont()}!c.Chart3D&&T.DrawHorzAxis(i,a,!1)}function i(e){var t,r,o,n,a,i,l,s,d=c.Series.items,p=T.CalcLabelHeight(),h=T.CalcVertAxisWidth(),g=x.CalcLabelHeight(),_=x.CalcHorzAxisHeight(!1),b=w.CalcLabelHeight(),y=w.CalcHorzAxisHeight(!1),S=0,D=0,F=!1;for(r=d.length,t=0;r>t;t++)if(o=d[t],o.LabelTextBuilder&&!o.LabelInBar){F=!0;break}if(F&&(f.selectFont(c.getUsingValueFont()),S=f.measureTextWidth(o.ValueFormatParser.format(u)),c.IsDrawNegativeGraph()&&(D=S),f.restoreFont()),a=new m(e.left+p+h+D,e.top+g+_,e.right-S,e.bottom-b-y),l=new m(a.left,e.top,a.right,e.top+g),x.DrawHorzAxisLabel(l),s=new m(l.left,e.bottom-b,l.right,e.bottom),w.DrawHorzAxisLabel(s),l.top=l.bottom,l.bottom+=_,x.DrawHorzAxis(l,a,!0),s.bottom=s.top,s.top-=y,w.DrawHorzAxis(s,a,!1),i=new m(e.left,a.top,e.left+p,a.bottom),T.DrawVertAxisLabel(i),i.left=i.right,i.right+=h,c.Chart3D&&T.DrawVertAxis(i,a,!1,x.Used),!a.IsRectEmpty()&&c.GroupCount){for(f.selectFont(c.getUsingValueFont()),r=C.length,t=0;r>t;t++)switch(o=C[t],n=v[o[0]].ChartType){case 11:c.DrawColumnBar(o,a);break;case 12:case 13:c.DrawStackedColumnBar(o,n,a)}f.restoreFont()}!c.Chart3D&&T.DrawVertAxis(i,a,!1)}var l,s,u,c=this,d=c.canvas,p=d.width,h=d.height,f=c.context=new b(d.getContext("2d")),g=new m(0,0,p,h),C=c.graphs,v=c.graphSerieses,T=c.XAxis,x=c.YAxis,w=c.Y2Axis,y=0;c.fontHeight=R(c.getUsingFont()),c.valueFontHeight=R(c.getUsingValueFont()),f.selectFont(c.getUsingFont()),f.selectFillColor(c.ForeColor),c.report.singleChart&&(g.left+=c.PaddingLeft,g.top+=c.PaddingTop,g.right-=c.PaddingRight,g.bottom-=c.PaddingBottom),c.toUpdateShapes=t,t&&(c.shapes=[],c.shapesL=[]),r(),c.LegendVisible&&c.SeriesCount&&o(c),c.Title&&n(),g.top+=y,g.IsRectEmpty()||(2===c.Series.items[0].ChartType?c.DrawPie(g):c.IsHorzGraph()?i(g):a(g)),f.restoreFillStyle(),f.restoreFont()},DrawPie:function(e){var t,r,o,n,a=this,i=a.context,l=0,s=0,u=e.Height(),c=e.Width(),d=c*u,p=Number.MAX_VALUE,h=-1,f=-1;for(t=0;t<a.GroupCount;t++){for(r=0;r<a.SeriesCount;r++)i.selectFont(a.getUsingValueFont()),a.graphSerieses[r].LabelTextBuilder&&(l=Math.max(l,i.measureTextWidth(a.GetDrawValueText(r,t)))),i.restoreFont();s=Math.max(s,i.measureTextWidth(a.GroupLabel(t)))}for(t=1;t<=a.GroupCount;t++)r=Math.floor((a.GroupCount+t-1)/t),o=Math.min(c/r,u/t),o=d-o*o*a.GroupCount,p>o&&(p=o,h=r,f=t);for(i.selectFont(a.getUsingValueFont()),o=0;o<a.GroupCount;o++)t=Math.floor(o/h),r=o%h,n=new m(e.left+c*r/h,e.top+u*t/f,e.left+c*(r+1)/h,e.top+u*(t+1)/f),a.Chart3DReal?i.drawTextCenter("三维饼图暂不支持!!!",(n.left+n.right)/2,(n.top+n.bottom-16)/2):a.DrawOne2DPie(o,n,l,s);i.restoreFont()},DrawOne2DPie:function(e,t,r){function o(){var r,o,f,_,v,T,x=c.getUsingValueFont(),b=x.Italic?p(x):0,w=new m(0,0,0,0);for(u=0,n=0;g>n;n++)s=le(C[n]),o=i+Math.cos(s)*a,f=l-Math.sin(s)*a,T=c.GetDrawValueText(n,e),v=d.measureTextWidth(T)+b,r=new m(o,f,o+v,f+h),s<Math.PI/2?(r.OffsetRect(2,-h),1===u&&r.top<w.bottom&&(_=w.right-r.left+2,r.right+_<t.right?r.OffsetRect(_,0):r.OffsetRect(0,w.bottom-r.top),d.drawLine(o,f,r.left,r.bottom-v.cy/3)),u=1):s<Math.PI?(r.OffsetRect(-v-2,-h),2===u&&r.top<w.bottom&&(_=r.right-w.left+2,r.left-_>t.left?r.OffsetRect(-_,0):r.OffsetRect(0,w.bottom-r.top),d.drawLine(o,f,r.right,r.bottom-v.cy/3)),u=2):s<1.5*Math.PI?(r.OffsetRect(-v-2,0),3===u&&r.bottom>w.top&&(_=r.right-w.left+2,r.left-_>t.left?r.OffsetRect(-_,0):r.OffsetRect(0,r.bottom-w.top),d.drawLine(o,f,r.right,r.top+v.cy/3)),u=3):(r.OffsetRect(2,0),4===u&&r.bottom>w.top&&(_=w.right-r.left+2,r.right-_<t.right?r.OffsetRect(_,0):r.OffsetRect(0,r.bottom-w.top),d.drawLine(o,f,r.left,r.top+v.cy/3)),u=4),c.DrawLabelText(T,(r.left+r.right)/2,r.top),w=r}var n,a,i,l,s,u,c=this,d=c.context,p=c.fontHeight,h=c.valueFontHeight,f=!1,g=c.SeriesCount,_=0,C=[];for(n=0;g>n;n++)_+=c.Value(n,e),c.graphSerieses[n].LabelTextBuilder&&(f=!0);if(!(0>=_||(i=t.Width()-2*r-2*Pt,l=t.Height()-p-2*h-2*Pt,0>=i||0>=l||(a=Math.min(i,l)/2,f?t.InflateRect(-Pt,-Pt):t.InflateRect(a-i/2,a-l/2),t.bottom-=p,t.IsRectEmpty())))){for(c.DrawLabelText(c.GroupLabel(e),(t.left+t.right)/2,t.bottom),i=(t.left+t.right)/2,l=(t.top+t.bottom)/2,s=0,n=0;g>n;n++)u=s+360*c.Value(n,e)/_,c.toUpdateShapes&&c.shapes.push(new Mt(n,e,i,l,a,s,u)),d.selectFillColor(c.GetGraphFillColor(n)),d.pie(i,l,a,s,u,1),d.restoreFillStyle(),f&&C.push((s+u)/2),s=u;f&&o()}},DrawColumnBar:function(e,t){var r,o,n,a,i,l,s,u,c,d,p,h,f,g=this,_=g.context,C=g.graphSerieses,v=g.CalcColumnBarCount(),T=g.CalcFirtColumnBarIndex(e),x=t.Width()-g.xView3DDepth,b=t.Height()-g.yView3DDepth,w=g.IsDrawNegativeGraph()?g.YAxis.CalcValuePos(0,x):t.left+1,y=e.length,S=g.IsDrawNegativeGraph(),D=[];for(a=0;a<g.GroupCount;a++)for(u=g.XAxis.CalcGroupPos(b,a),c=u.EndPos-u.BeginPos,r=t.top+u.BeginPos,g.Y2Axis.Used&&(r+=g.yView3DDepth),o=y;o-- >0;)i=e[o],l=C[i],n=g.Value(i,a),d=g.AbsNegativeValue&&0>n,d&&(n=-n),f=new m(0,r+c*(T+o)/v,0,r+c*(T+o+1)/v),h=g.YAxisOfSeries(l).CalcValuePos(n,x),S?(f.left=t.left+w,f.right=Math.min(t.left+h,t.right),w>h&&(h=f.left,f.left=f.right,f.right=h)):(f.left=t.left,f.right=Math.min(t.left+Math.max(0,h),t.right)),D.push(f),g.toUpdateShapes&&g.shapes.push(new Bt(i,a,f)),p=d?g.NegativeBarColor:g.GetGraphFillColor(g.IsColorSingleBar()?a:i),g.DrawRectBar(f,p,l.BorderPen,!0,!0,n>=0);for(a=0;a<g.GroupCount;a++)if(l=C[e[0]],l.LabelAsGroup){for(s=g.GetDrawValueText(e[0],a),h=-9999,o=0;y>o;o++)f=D[a*y+o],h<f.right&&(h=f.right);g.DrawValueText(l,s,h+Pt+_.measureTextWidth(s)/2,(D[a*y].top+D[a*y+y-1].bottom+g.valueFontHeight)/2)}else for(o=0;y>o;o++)i=e[o],l=C[i],l.LabelTextBuilder&&(s=g.GetDrawValueText(i,a),f=D[a*y+o],l.LabelInBar?g.DrawHorzBarText(s,f):g.DrawValueText(l,s,f.right+Pt+_.measureTextWidth(s)/2,(f.top+f.bottom+g.valueFontHeight)/2))},DrawStackedColumnBar:function(e,t,r){var o,n,a,i,l,s,u,c,d,p,h,f,g,_,C=this,v=C.context,T=C.graphSerieses,x=C.CalcColumnBarCount(),b=C.CalcFirtColumnBarIndex(e),w=r.Width()-C.xView3DDepth,y=r.Height()-C.yView3DDepth,S=e.length,D=[];for(a=0;a<C.GroupCount;a++){for(s=C.XAxis.CalcGroupPos(y,a),u=s.EndPos-s.BeginPos,d=r.top+s.BeginPos,C.Y2Axis.Used&&(d+=C.yView3DDepth),f=d+u*b/x,g=d+u*(b+1)/x,p=r.left,o=0;S>o;o++)i=e[o],l=T[i],n=C.Value(i,a),13===t&&(n*=100/C.CalcGroupTotalValue(e,a)),h=Math.max(0,C.YAxisOfSeries(l).CalcValuePos(n,w)),_=new m(p,f,Math.min(r.right,p+h),g),D.push(_),C.toUpdateShapes&&C.shapes.push(new Bt(i,a,_)),c=C.GetGraphFillColor(i),C.DrawRectBar(_,c,l.BorderPen,!0,o===S-1,!0),p+=h;if(l.LabelInBar)for(o=0;S>o;o++)i=e[o],l=T[i],l.LabelTextBuilder&&C.DrawHorzBarText(C.GetDrawValueText(i,a),D[a*S+o]);else i=e[0],l=T[i],n=C.GetDrawValueText(i,a),C.DrawValueText(l,n,p+Pt+v.measureTextWidth(n)/2,(f+g+C.valueFontHeight)/2)}},DrawBar:function(e,t){var r,o,n,a,i,l,s,u,c,d,p,h,f,g=this,_=g.graphSerieses,C=g.CalcBarCount(),v=g.CalcFirtBarIndex(e),T=g.IsDrawNegativeGraph(),x=t.Height()-g.yView3DDepth,b=T?g.YAxis.CalcValuePos(0,x):t.bottom+1,w=e.length,y=[];for(a=0;a<g.GroupCount;a++)for(u=g.XAxis.CalcGroupPos(t.Width()-g.xView3DDepth,a),c=u.EndPos-u.BeginPos,n=v,r=0;w>r;r++)i=e[r],l=_[i],o=g.Value(i,a),d=g.AbsNegativeValue&&0>o,d&&(o=-o),f=new m(t.left+u.BeginPos+c*n/C,0,t.left+u.BeginPos+c*(n+1)/C,0),h=g.YAxisOfSeries(l).CalcValuePos(o,x),T?(f.top=Math.max(t.bottom-h,t.top),f.bottom=t.bottom-b,b>h&&(h=f.top,f.top=f.bottom,f.bottom=h)):(f.top=t.bottom-h,f.bottom=t.bottom),y.push(f),g.toUpdateShapes&&g.shapes.push(new Bt(i,a,f)),p=d?g.NegativeBarColor:g.GetGraphFillColor(g.IsColorSingleBar()?a:i),g.DrawRectBar(f,p,l.BorderPen,!1,!0,o>=0),++n;for(a=0;a<g.GroupCount;a++)if(i=e[0],l=_[i],l.LabelAsGroup){for(s=g.GetDrawValueText(i,a),h=9999,r=0;w>r;r++)f=y[a*w+r],h>f.top&&(h=f.top);g.DrawValueText(l,s,(y[a*w].left+y[a*w+w-1].right+g.xView3DDepth)/2,h-Pt/2-g.yView3DDepth)}else for(r=0;w>r;r++)i=e[r],l=_[i],l.LabelTextBuilder&&(s=g.GetDrawValueText(i,a),f=y[a*w+r],l.LabelInBar?g.DrawVertBarText(s,f):(h=f.top-Pt/2-g.yView3DDepth,g.IsDrawNegativeGraph()&&t.bottom-b<f.bottom&&(h=f.bottom+g.valueFontHeight),g.DrawValueText(l,s,(f.left+f.right+g.xView3DDepth)/2,h)))},DrawStackedBar:function(e,t,r){var o,n,a,i,l,s,u,c,d,p,h,f,g,_=this,C=_.graphSerieses,v=_.CalcBarCount(),T=_.CalcFirtBarIndex(e),x=r.Width()-_.xView3DDepth,b=r.Height()-_.yView3DDepth,w=e.length,y=[];for(a=0;a<_.GroupCount;a++){for(s=_.XAxis.CalcGroupPos(x,a),u=s.EndPos-s.BeginPos,p=r.left+s.BeginPos+u*T/v,h=r.left+s.BeginPos+u*(T+1)/v,f=r.bottom,o=0;w>o;o++)i=e[o],l=C[i],n=_.Value(i,a),10===t&&(n*=100/_.CalcGroupTotalValue(e,a)),d=_.YAxisOfSeries(l).CalcValuePos(n,b),g=new m(p,Math.min(Math.max(f-d,r.top),f),h,f),y.push(g),_.toUpdateShapes&&_.shapes.push(new Bt(i,a,g)),c=_.GetGraphFillColor(i),_.DrawRectBar(g,c,l.BorderPen,!1,o===w-1,!0),f-=d;if(l.LabelInBar)for(o=0;w>o;o++)i=e[o],l=C[i],l.LabelTextBuilder&&_.DrawVertBarText(_.GetDrawValueText(i,a),y[a*w+o]);else i=e[0],l=C[i],_.DrawValueText(l,_.GetDrawValueText(i,a),(p+h+_.xView3DDepth)/2,f-Pt/2-_.yView3DDepth)}},DrawRectBar:function(e,t,r,o,n,a){function i(e,t){s.selectFillColor(e),s.selectPen(new _(1,e,1)),s.drawPolyLine(t,1,1),s.restorePen(),s.restoreFillStyle()}var l=this,s=l.context,u=Y(t),c=J(t),d=[];l.Chart3DReal&&(d.length=8,d[0]=e.right-1,d[1]=e.top,d[2]=d[0]+l.xView3DDepth,d[3]=d[1]-l.yView3DDepth,(n||o)&&(d[4]=d[2]-e.Width(),d[5]=d[3],d[6]=e.left,d[7]=d[1],i(u,d)),!n&&o||(d[4]=d[2],d[5]=e.bottom-l.yView3DDepth,d[6]=e.right-1,d[7]=e.bottom,i(c,d))),l.Chart3DReal?(s.selectFillColor(t),s.rectangle2(e,1),s.restoreFillStyle()):s.drawBar(e,r,t,o?a?1:3:a?0:2)},DrawLine:function(e,t,r){var o,n,a,i,l,s,u,c,d=this,p=d.context,h=e.length,f=[];for(o=0;h>o;o++)f.push([]);for(n=0;n<d.GroupCount;n++)for(u=r.left+d.XAxis.CalcGroupPos(r.Width()-d.xView3DDepth,n).LabelMiddlePos,o=0;h>o;o++){a=e[o],i=d.graphSerieses[a];var g={x:u,y:r.bottom-d.YAxisOfSeries(i).CalcValuePos(d.Value(a,n),r.Height())};f[o].push(g),d.toUpdateShapes&&d.shapes.push(new kt(a,n,g.x,g.y,i.MarkerSize))}for(o=0;h>o;o++)(7===t?d.DrawCurveLine:d.DrawPolyLine).call(d,f[o],e[o]);for(o=0;h>o;o++)d.DrawPointsMarker(f[o],e[o]);for(n=0;n<d.GroupCount;n++)for(o=0;h>o;o++)a=e[o],i=d.graphSerieses[a],i.LabelTextBuilder&&(c=r.bottom-d.YAxisOfSeries(i).CalcValuePos(d.Value(a,n),r.Height()),-1!==i.MarkerStyle&&(c-=i.MarkerSize/2),l=d.GetDrawValueText(a,n),s=p.measureTextWidth(l),u=f[o][n].x+s/2,d.GroupCount>1&&(u-=s*n/(d.GroupCount-1)),d.DrawValueText(i,l,u,c))},DrawBubble:function(e,t){var r,o,n,a,i,l,s,u,c,d=this,p=e.length,h=[],f=[];for(r=0;p>r;r++)for(a=e[r],i=d.graphSerieses[a],u=[],c=[],h.push(u),f.push(c),s=d.ValueCount(a),n=0;s>n;n++){o=d.Value(a,n),l=Math.sqrt(o.z/d.DrawBubbleScalePerCm)*wt/2;var g={x:t.left+d.XAxis.CalcValuePos(o.x,t.Width()),y:t.bottom-d.YAxisOfSeries(i).CalcValuePos(o.y,t.Height())};u.push(g),c.push(l),d.toUpdateShapes&&d.shapes.push(new kt(a,n,g.x,g.y,l)),i.LabelTextBuilder&&d.DrawValueText(i,d.GetDrawValueText(a,n),g.x,g.y-l)}for(r=0;p>r;r++)a=e[r],d.DrawPointsMarker(h[a],a,f[a])},DrawXYScatterGraph:function(e,t,r){var o,n,a,i,l,s,u,c=this,d=e.length,p=[];for(o=0;d>o;o++)for(i=e[o],l=c.graphSerieses[i],u=[],p.push(u),s=c.ValueCount(i),a=0;s>a;a++){n=c.Value(i,a);var h={x:r.left+c.XAxis.CalcValuePos(n.x,r.Width()),y:r.bottom-c.YAxisOfSeries(l).CalcValuePos(n.y,r.Height())};u.push(h),c.toUpdateShapes&&c.shapes.push(new kt(i,a,h.x,h.y,l.MarkerSize)),l.LabelTextBuilder&&c.DrawValueText(l,c.GetDrawValueText(i,a),h.x,h.y-l.MarkerSize)}if(6===t||8===t)for(o=0;d>o;o++)i=e[o],l=c.graphSerieses[i],(8===t?c.DrawCurveLine:c.DrawPolyLine).call(c,p[i],i);for(o=0;d>o;o++)i=e[o],c.DrawPointsMarker(p[i],i)},DrawPolyLine:function(e,t){var r,o,n=this,a=n.context,i=e.length,l=[];for(r=0;i>r;r++)l.push(e[r].x,e[r].y);o=n.graphSerieses[t].BorderPen.clone(),o.Color=n.GetGraphFillColor(t),a.selectPen(o),a.drawPolyLine(l),a.restorePen()},DrawCurveLine:function(e,t){function r(e,t,r){var o=.4,n=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2)),i=n+a,l=i>0?o*n/i:1,s=i>0?o*a/i:1;return{inner:{x:t.x-l*(r.x-e.x),y:t.y-l*(r.y-e.y)},outer:{x:t.x+s*(r.x-e.x),y:t.y+s*(r.y-e.y)}}}var o,n,a,i,l=this,s=l.context,u=e.length,c=[];if(u>1){for(a=e[0],i=r(a,a,e[1]),c.push(a,i.outer),o=1;u-1>o;o++)a=e[o],i=r(e[o-1],a,e[o+1]),c.push(i.inner,a,i.outer);a=e[o],i=r(e[o-1],a,a),c.push(i.inner,a),n=l.graphSerieses[t].BorderPen.clone(),n.Color=l.GetGraphFillColor(t),s.selectPen(n),s.polyBezier(c),s.restorePen()}},DrawPointsMarker:function(e,t,o){var n,a=this,i=a.context,l=a.graphSerieses[t],s=e.length;if(-1!==l.MarkerStyle)for(n=0;s>n;n++)i.DrawPointMarker(r(e[n].x,e[n].y,o?o[n]:l.MarkerSize),l.MarkerStyle,l.MarkerPen,l.MarkerColorAuto?a.GetGraphFillColor(t):l.MarkerColor)},DrawValueText:function(e,t,r,o){var n,a=this,i=a.context,l=a.valueFontHeight;e.LabelTextAngle?(n=le(e.LabelTextAngle),r-=(i.measureTextWidth(t)*Math.cos(n)+Math.abs(l*Math.sin(n)))/2,o-=Math.abs(l*Math.cos(n)),i.drawTextRotate(t,r,o,e.LabelTextAngle)):i.drawTextCenter(t,r,o-l)},DrawLabelText:function(e,t,r){var o=this.context;o.drawTextCenter(e,t,r)},DrawVertBarText:function(e,t){var r=this,o=r.context;o.drawTextRotate(e,(t.left+t.right-r.fontHeight)/2,(t.top+t.bottom+o.measureTextWidth(e))/2,90)},DrawHorzBarText:function(e,t){var r=this,o=r.context,n=o.measureTextWidth(e),a=r.fontHeight,i=(t.left+t.right-n)/2,l=(t.top+t.bottom-a)/2;o.drawText(e,i,l)},CalcBarCount:function(){var e,t,r,o=this,n=o.graphs.length,a=0;for(e=0;n>e;e++)t=o.graphs[e],r=o.graphSerieses[t[0]].ChartType,1===r?a+=t.length:4!==r&&10!==r||a++;return a},CalcColumnBarCount:function(){var e,t,r,o=this,n=o.graphs.length,a=0;for(e=0;n>e;e++)t=o.graphs[e],r=o.graphSerieses[t[0]].ChartType,11===r?a+=t.length:12!==r&&13!==r||a++;return a},CalcFirtBarIndex:function(e){var t,r,o,n=this,a=n.graphs,i=a.length,l=0;for(t=0;i>t&&(r=a[t],r!==e);t++)o=n.graphSerieses[r[0]].ChartType,1===o?l+=r.length:4!==o&&10!==o||++l;return l},CalcFirtColumnBarIndex:function(e){var t,r,o,n=this,a=n.graphs,i=a.length,l=0;for(t=0;i>t&&(r=a[t],r!==e);t++)o=n.graphSerieses[r[0]].ChartType,11===o?l+=r.length:12!==o&&13!==o||++l;return l},CalcGroupTotalValue:function(e,t){var r,o=this,n=e.length,a=0;for(r=0;n>r;r++)a+=o.Value(e[r],t);return a},IsScatterGraph:function(){return this.Series.items[0].IsScatterGraph()},IsHorzGraph:function(){return this.Series.items[0].IsHorzGraph()},IsColorSingleBar:function(){var e=this;return 1==e.SeriesCount&&e.SingleSeriesColored},IsDrawNegativeGraph:function(){var e=this;return!e.Series.items.some((function(e){return e.ByY2Axis}))&&e.YAxis.DrawMax>=0&&e.YAxis.DrawMin<0&&!e.AbsNegativeValue},Support3D:function(){return this.Series.items.every((function(e){return e.Support3D()}))},YAxisOfSeries:function(e){var t=this;return e.ByY2Axis?t.Y2Axis:t.YAxis},getSeriesShowLabel:function(e){var t=this;return t.SeriesLabels[e]||(t.graphSerieses[e]?t.graphSerieses[e].SeriesName:"")},getUsingTitleFont:function(){return this.TitleFont.UsingFont()},getUsingValueFont:function(){return this.ValueFont.UsingFont()},GetGraphFillColor:function(e){var t,r,o,n,a=this,i=a.graphSerieses[e],l=a.FillColors?a.FillColors.length:St;return a.IsColorSingleBar()||i.FillColorAuto?(t=Math.floor(e/l),r=e%l,o=a.FillColors?a.FillColors[r]:q(yt[r],a.report.viewer.alpha.chartGraph),t>0&&(n=z(o),o=j((n.r+73*r+196*t)%255,(n.g+197*r+120*t)%255,(n.b+117*r+90*t)%255,n.a)),o):i.FillColor},GetSeriesIndexByLabel:function(e,t){var r=this,o=r.SeriesLabels.indexOf(e);return 0>o&&t&&(o=+e,(!isNaN(o)||o>=r.SeriesCount)&&(o=-1)),o},GetGroupIndexByLabel:function(e,t){var r=this,o=r.GroupLabels.indexOf(e);return 0>o&&t&&(o=+e,(!isNaN(o)||o>=r.GroupCount)&&(o=-1)),o},GetDrawValueText:function(e,t){var r=this.graphSerieses[e];return r.LabelTextBuilder?r.LabelTextBuilder.generateChartDisplayText(e,t):""},GetGroupTotalValue:function(e,t){var r,o=this,n=e.length,a=0;if(!o.IsScatterGraph())for(r=0;n>r;r++)a+=o.Value(e[r],t);return a},GetSeriesTotalValue:function(e){var t,r,o=this,n=0;if(o.IsScatterGraph())for(r=o.ValueCount(e),t=0;r>t;t++)n+=o.Value(e,t).z;else for(t=0;t<o.GroupCount;t++)n+=o.Value(e,t);return n},GetTotalValue:function(){var e,t=this,r=0;for(e=0;e<t.SeriesCount;e++)r+=t.GetSeriesTotalValue(e);return r},prepareValues:function(){for(var e=this,t=e.values.length;t++<e.SeriesCount;)e.values.push([])},get AsChart(){return this},GroupLabel:function(e){return this.GroupLabels[e]},SetGroupLabel:function(e,t){this.GroupLabels[e]=t},SeriesLabel:function(e){return this.SeriesLabels[e]},SetSeriesLabel:function(e,t){this.SeriesLabels[e]=t},Value:function(t,r){var o,n=this;return n.prepareValues(),o=n.values[t][r],o===e&&(o=0),o},SetValue:function(e,t,r){var o=this;o.prepareValues(),o.values[e][t]=r},ValueCount:function(e){var t=this;return t.prepareValues(),t.values[e].length},get FillColorCount(){var e=this;return e.FillColors?e.FillColors.length:0},getFillColor:function(t){var r=this;return r.FillColors?r.FillColors[t]:e},AddFillColor:function(e){var t=this;t.FillColors||(t.FillColors=[]),t.FillColors.push(e)},EmptyFillColors:function(){delete self.FillColors},LoadDataFromXML:function(e,t,r,o){function n(){return l?i.text:i.textContent}var a,i,l,s,u,c,d=this,p=1,h=te(e);if(!dom)return 0;for(o&&(d.GroupCount=0,d.GroupLabels=[]),r&&(d.SeriesCount=0,d.SeriesLabels=[]),d.values=[],a=h.childNodes[0].firstChild,nodeText=a.hasOwnProperty("text");a;){if(i=a.firstChild,t&&(s=n(),i=i.nextSibling,u=d.GetSeriesIndexByLabel(s,!r),0>u&&r&&(u=d.SeriesCount,d.SeriesCount++,d.SeriesLabels.push(s)),0>u))throw 0;if(s=n(),i=i.nextSibling,c=d.GetGroupIndexByLabel(s,!o),0>c&&o&&(c=d.GroupCount,d.GroupCount++,d.GroupLabels.push(s)),0>c)throw 0;if(t)d.SetValue(u,c,+n()+d.Value(u,c));else for(u=0;i;)d.SetValue(u,c,+n()+d.Value(u,c)),u++,i=i.nextSibling;a=a.nextSibling}return p},DoLoadXYZDataFromXML:function(e,t,r){function o(){return i?a.text:a.textContent}var n,a,i,l,s,u,c,d,p=this,h=1,f=te(e);if(!dom)return 0;for(t&&(p.SeriesCount=0,p.SeriesLabels=[]),p.values=[],n=f.childNodes[0].firstChild,nodeText=n.hasOwnProperty("text");n;){if(a=n.firstChild,FirstSeries?(l=o(),d=p.GetSeriesIndexByLabel(l,!t),0>d&&t&&(d=m_SeriesCount,++m_SeriesCount,m_SeriesLabels[d]=l),a=a.nextSibling):d=0,0>d)throw 0;s=+o(),a=a.nextSibling,u=+o(),r||(a=a.nextSibling,c=+o()),p.AddXYZValue(d,s,u,c),n=n.nextSibling}return h},LoadXYDataFromXML:function(e,t){return this.DoLoadXYZDataFromXML(e,t,1)},LoadXYZDataFromXML:function(e,t){return DoLoadXYZDataFromXML(e,t,0)},AddXYZValue:function(e,t,r,o){var n=this;n.prepareValues(),n.values[e].push({x:t,y:r,z:o})},EmptyValues:function(){var e=this;e.values=[],e.prepareValues()}},X(It,Me),gr.dom.Report=at}(),function(e,t){"use strict";var r=gr.helper,o=gr.common,n=(gr.enum_,gr.const_),a=r.penStyleText,i=r.fontCSSText,l=r.pixelsToHtml,s=r.colorValue2Html,u=r.assignObject,c=r.compareObject,d=r.parseXML,p=r.xmlToReportDataJSON,h=r.addEvent,f=o.HtmlStyles,g=function(e){var t,r,o=this;o.obj=e,e.FreeCell?e.isSingleDockControl()&&(r=e.Controls.items[0],r.TextFormat&&(o.TextFormat={},o.TextFormat.ForeColor=r.ForeColor,u(o.TextFormat,r.TextFormat)),t=o.padding={},t.Left=r.PaddingLeft,t.Right=r.PaddingRight,t.Top=r.PaddingTop,t.Bottom=r.PaddingBottom):(o.TextFormat={},u(o.TextFormat,e.TextFormat),o.TextFormat.ForeColor=e.ForeColor,t=o.padding={},t.Left=e.PaddingLeft,t.Right=e.PaddingRight,t.Top=e.PaddingTop,t.Bottom=e.PaddingBottom),e.BorderCustom?(o.border={},u(o.border,e.Border)):o.ownerGrid=e.getOwnerGrid(),o.toFillBack=e.toFillBack(),o.toFillBack&&(o.BackColor=e.BackColor)};g.prototype={compare:function(e){var t=this,r=new g(e);return c(t.padding,r.padding)&&c(t.TextFormat,r.TextFormat)&&c(t.border,r.border)&&t.toFillBack===r.toFillBack&&t.BackColor===r.BackColor&&t.ownerGrid===r.ownerGrid},getStyleName:function(){return"-gr-cell"+this.index},getStyles:function(){var e=this,t=new f,r=e.TextFormat;return r&&(t.addTextFormat(e,1),t.addObjectPadding(e)),e.border?t.addBorder(e.border):t.addCellBorder(e.ownerGrid),e.toFillBack&&t.addBackColor(e.BackColor),t}};var m=function(e){var t=this,r=t.padding={},o=e.getUsingFont();t.obj=e,t.asCell=!!e.cell,e.TextFormat&&(t.TextFormat={},t.TextFormat.ForeColor=e.ForeColor,u(t.TextFormat,e.TextFormat)),r.Left=e.PaddingLeft,r.Right=e.PaddingRight,r.Top=e.PaddingTop,r.Bottom=e.PaddingBottom,t.border={},u(t.border,e.Border),t.toFillBack=e.toFillBack(),t.toFillBack&&(t.BackColor=e.BackColor),t.textdecoration={Underline:o.Underline,Strikethrough:o.Strikethrough}};m.prototype={compare:function(e){var t=this,r=new m(e);return c(t.padding,r.padding)&&c(t.TextFormat,r.TextFormat)&&c(t.border,r.border)&&c(t.textdecoration,r.textdecoration)&&t.toFillBack===r.toFillBack&&t.BackColor===r.BackColor&&t.asCell===r.asCell},getStyleName:function(){return"-gr-ctrl"+this.index},getStyles:function(){var e=this,t=new f,r=e.textdecoration;return!e.asCell&&t.add("position","absolute"),t.addObjectPadding(e),t.addBorder(e.border),e.TextFormat&&t.addTextFormat(e,e.asCell),e.toFillBack&&t.addBackColor(e.BackColor),(r.Underline||r.Strikethrough)&&t.add("text-decoration",(r.Underline?"underline":"")+(r.Underline&&r.Strikethrough?" ":"")+(r.Strikethrough?"line-through":"")),t}};var _=function(e){var t=this;t.Left=e.pxRect.left,t.Top=e.pxRect.top,t.Width=e.getContentWidth(),t.Height=e.getContentHeight()};_.prototype={compare:function(e){var t=this;return t.Left===e.pxRect.left&&t.Top===e.pxRect.top&&t.Width===e.getContentWidth()&&t.Height===e.getContentHeight()},getStyleName:function(){return"-gr-pos"+this.index},getStyles:function(){var e=this,t=new f;return t.add("left",l(e.Left)),t.add("top",l(e.Top)),t.add("width",l(e.Width)),t.add("height",l(e.Height)),t}};var C=function(e){var t=this,r=e.cells?e:0;t.section=e,t.isLastRow=1,t.Height=e.CanShrink?0:e.pxHeight,r&&(e=r.section,t.isLastRow=e.tableRows[e.tableRows.length-1]===r),e.Font.font&&(t.Font={},u(t.Font,e.Font.font)),e.owner.Header&&(t.detailgrid=e.owner.owner),!e.toFillBack()||r&&!t.detailgrid||(t.BackColor=e.BackColor)};C.prototype={compare:function(e){var t,r,o=this,n=e.cells?e:0,a=e.CanShrink?0:e.pxHeight,i=1;return n&&(e=e.section,i=e.tableRows[e.tableRows.length-1]===n),t=e.toFillBack()&&(!n||e.owner.Header),r=e.Font.font,o.Height===a&&(r&&o.Font&&c(r,o.Font)||!r&&!o.Font)&&(t&&o.BackColor&&o.BackColor===e.BackColor||!t&&!o.BackColor)&&(e.owner.Header&&e.owner.owner===o.detailgrid||!e.owner.Header&&!o.detailgrid)&&o.isLastRow===i},getStyleName:function(){return"-gr-section"+this.index},getStyles:function(){var e=this,t=e.section,r=t.pctHeight,o=e.Height,n=new f,i=e.detailgrid;return(r||o)&&n.add("height",r?r+"%":l(o)),(r||!t.cells&&t.report.viewer.options.reportFitWidth)&&n.add("width","100%"),e.Font&&(n.items=n.items.concat(v.prototype.getStyles.call(e.Font).items)),e.BackColor&&n.addBackColor(e.BackColor),e.isLastRow&&i&&i.ShowRowLine&&n.add("border-bottom",a(i.ColLinePen)),n}};var v=function(e){var t=this;t.Size=e.Size,t.Bold=e.Bold,t.Italic=e.Italic,t.Name=e.Name};v.prototype={compare:function(e){var t=this;return t.Size===e.Size&&t.Bold===e.Bold&&t.Italic===e.Italic&&t.Name===e.Name},getStyleName:function(){return"-gr-fs"+this.index},getStyles:function(){var e=new f;return e.add("font",i(this)),e}};var T=function(e){this.htmlStyles=e};T.prototype={getStyleName:function(){return"-gr-cs"+this.index},getStyles:function(){return this.htmlStyles}};var x=function(e,t){var r=this;r.items=[],r.viewer=e,r.classStyle=t};x.prototype={toString:function(){for(var e,t=this,r=t.items,o=r.length,n="";o-- >0;)e=r[o],n+="."+t.viewer._getCSSName(e)+"{"+e.getStyles().getText()+"}",DEBUG&&(n+="\r\n");return n},select:function(e,t){var r=this;return r.viewer._getCSSName(r.selectItem(e,t))},selectItem:function(e,t){var r,o,n=this,a=n.items.length;if(t&&t.compare(e))return t;for(r=0;a>r;r++)if(o=n.items[r],o.compare(e))return o;return o=new n.classStyle(e),o.index=a,n.items.push(o),o}};var b=function(e){var t,r=0,o=e.length;if("string"!=typeof e)return 0;for(;o>r&&(t=e[r],/\s/g.test(t));)r++;return o>r&&"{"!==t&&"<"!==t},w=function(e){return"string"==typeof e&&"_WR_"==e.substr(0,4)?0:b(e)},y=function(e,t,r,o,n){var a=this;a.running=!1,a.generated=!1,a.events={},a.viewerNo=e,a.viewerHolderID=t,a.reportSource=r,a.dataSource=o,a.alpha={background:1,border:.8,stroke:.8,pen:.8,text:.8,chartGraph:0,chartStroke:1},a.options={controlPosition:gr.enum_.controlLayout.auto,reportFitWidth:!1,reportFitHeight:!1,detailgridResize:gr.enum_.detailgridResize.asDesign,singleChartFill:!0,fixedHeaderFooter:!1,fixedFitTo:"window",selectionHighlight:!0,selectionCell:!1,selectionTextColor:"rgba(255,255,255,1)",selectionBackColor:"rgba(20,20,127,1)",hoverEnabled:!0,hoverBackColor:"#eee",hoverTextColor:"#000"},a.attachOptions(n),a.report=new gr.dom.Report(a)};y.prototype={attachOptions:function(e){var t=this;t.stop(),e&&u(t.options,e)},loadReport:function(e,r,o){var n,a=this,i=a.report,l=e;if(r=r||r===t,o=o||o===t){try{l.responseText!==t&&(l=l.responseText),a._rawReport=l,i.load(l),a.events.onReportLoaded&&a.events.onReportLoaded(a)}catch(s){o=0,n="解析报表模板"}o&&(a.reportPrepared=!0,r&&!a.waitData&&a.generate())}else n="获取报表模板";!o&&a.displayError(n,e,1)},loadData:function(e,r,o){var n,a=this,i=e;if(r=r||r===t,o=o||o===t){try{if(i.responseText!==t&&(i=i.responseText),a._rawData=i,"string"==typeof i)if(""===i)i={};else if("{"===i.charAt(0))i=JSON.parse(i);else{if(i=i.replace(/\r\n/g,""),i=d(i),!i)throw 0;i=p(i)}a.tables=i}catch(l){o=0,n="解析报表数据"}o&&(a.dataPrepared=!0,r&&a.generate())}else n="获取报表数据";!o&&a.displayError(n,e,0)},start:function(){var t=this;t.waitData&&(t.waitData=0),t.generated||t.running||(t.running=!0,t.events.onGenerateBegin&&t.events.onGenerateBegin(t),t.reportPrepared=t.reportPrepared||!t._rs,t.dataPrepared=t.dataPrepared||!t._ds,t.reportPrepared&&t.dataPrepared?(t.events.onReportLoaded&&t.events.onReportLoaded(t),!t.waitData&&t.generate()):(t.reportPrepared||(t._rs.url?e.rubylong.ajax(t._rs,(function(e,r){t.loadReport(e,1,r)}),t):t.loadReport(t._rs)),t.dataPrepared||(t._ds.url?e.rubylong.ajax(t._ds,(function(e,r){t.loadData(e,1,r)}),t):t.loadData(t._ds))))},stop:function(e,r){var o,n=this,a=n.report;return!n.running&&(n.generated&&(e||(a.Clear(),n.reportPrepared=!1,n._rawReport=t),r||(n.tables=t,n.dataPrepared=!1,n._rawData=t),n.viewerHolderID&&(o=document.getElementById(n.viewerHolderID),o&&(o.innerHTML="",DEBUG&&(document.getElementById("htmlText")&&(document.getElementById("htmlText").innerText="htmlText"),document.getElementById("stylesText")&&(document.getElementById("stylesText").innerText="stylesText")))),a.unprepare(),n.generated=!1),!0)},update:function(){var e=this;e.stop(1,1),e.generate()},generate:function(){function t(){i.fontStyles=new x(i,v),i.controlStyles=new x(i,m),i.cellStyles=new x(i,g),i.sectionStyles=new x(i,C),i.positionStyles=new x(i,_),i.customStyles=new x(i,T)}function r(){function t(t){var r=e.innerWidth-document.body.clientWidth;r||(r=16),o.setAttribute("style","max-height:"+(e.innerHeight-a-r)+"px")}var r=c.getElementsByClassName(i._getCSSName(i.fixedDivClass)),o=c.getElementsByClassName(i._getCSSName(i.bodyDivClass))[0],n=r[0],a=n?n.clientHeight:0,l=n.clientWidth-o.clientWidth;17!=l&&l>0&&(n&&n.setAttribute("style","padding-right:"+l+"px"),n=r[1],n&&n.setAttribute("style","padding-right:"+l+"px")),n=r[1],n&&(a+=n.clientHeight),"holder"==u?o.setAttribute("style","max-height:"+(c.clientHeight-a)+"px"):(h(e,"resize",t),t())}var o,a,i=this,l=i.report,u=i.options.fixedFitTo,c=document.getElementById(i.viewerHolderID);if(i.stop(1,1),i.reportPrepared&&i.dataPrepared){try{if(c.innerHTML="",DEBUG&&(i.stylesText=""),i._detailgrids=[],i._domevents=[],i.html="",t(),c.classList.add(i.selectFont2(l.Font.font)),16777215!==l.BackColor&&(c.style.backgroundColor=s(l.BackColor)),i.html=l.generateHtml(),i.generateStyles(),c.innerHTML=i.html,l.toFillHolder&&(c.style.height="100%"),l.singleChart&&(c.style.backgroundColor=s(l.singleChart.BackColor)),l.startCanvas(),l.fixedHeaderFooter&&r(),i._detailgrids.forEach((function(e,t){var r=document.getElementById(i._getDetailGridID(t));h(r,"mousedown",(function(t){e.onmousedown(t)}))})),l._has_cb)for(o=document.querySelectorAll("."+n.CSS_CB),a=o.length;a-- >0;)h(o[a],"click",(function(e){l.onCheckBoxClick(e)}));i._domevents.forEach((function(e,t){for(o=document.querySelectorAll("."+i._getEventCSSName(t+1)),t=o.length;t-- >0;)switch(e.type){case 1:h(o[t],"click",(function(t){e.fun(t,e.obj)}));break;default:h(o[t],"dblclick",(function(t){e.fun(t,e.obj)}))}})),DEBUG&&(document.getElementById("htmlText")&&(document.getElementById("htmlText").innerText=i.html),document.getElementById("stylesText")&&(document.getElementById("stylesText").innerText=i.stylesText))}catch(d){c.innerHTML="生成报表时发生异常错误!<br />Error Code: "+d.number+"<br />Error Name: "+d.name+"<br />Error Message: "+d.message}i.running=!1,i.generated=!0,i.events.onGenerateEnd&&i.events.onGenerateEnd(i)}},generateStyles:function(){function e(e){var t=">tbody>tr";e&&(t+=">td"),t+=":hover",s+="."+n.CSS_DG+t+(a?":not(."+n.CSS_SH+")":"")+" {background-color:"+o.hoverBackColor+";color:"+o.hoverTextColor+";}\n"}var t=this,r=t.report,o=t.options,a=o.selectionHighlight,i=n.ID_REPORT_STYLE+t.viewerNo,l=document.getElementById(i),s=r.toFillHolder?"html,body{height:100%;}\n*{margin:0;padding:0;}":"";l||(l=document.createElement("STYLE"),l.id=i,document.head.appendChild(l)),r._has_cb&&(s+="."+n.CSS_CB+"{}\n"),s+="."+n.CSS_DG+"{table-layout:fixed;}\n",o.hoverEnabled&&(e(0),e(1)),a&&(s+="."+n.CSS_SH+"{ background-color:"+o.selectionBackColor+";color:"+o.selectionTextColor+";}\n"),l.innerHTML=[t.fontStyles,t.positionStyles,t.sectionStyles,t.cellStyles,t.controlStyles,t.customStyles,t.getDomEventStyles(),s].join(""),DEBUG&&(t.stylesText=l.innerHTML)},getDomEventStyles:function(){for(var e=this,t=e._domevents.length,r="";t>0;)r+="."+e._getEventCSSName(t--)+"{}\n";return r},addCustomStyle:function(e){var t=this.customStyles.items,r=new T(e);return r.index=t.length,t.push(r),r},selectCell:function(e){return this.cellStyles.select(e,e.defaultStyle)},selectCellItem:function(e){return this.cellStyles.selectItem(e)},selectControl:function(e){return this.controlStyles.select(e,e.defaultStyle)},selectControlItem:function(e){return this.controlStyles.selectItem(e)},selectSection:function(e){return this.sectionStyles.select(e,e.defaultStyle)},selectSectionItem:function(e){return this.sectionStyles.selectItem(e)},selectPosition:function(e){return this.positionStyles.select(e,e.defaultPositionStyle)},selectPositionItem:function(e){return this.positionStyles.selectItem(e)},selectFont:function(e,t){return this.fontStyles.select(e,t)},selectFont2:function(e){var t=this;return t._getCSSName(t.selectFontItem(e))},selectFontItem:function(e){return this.fontStyles.selectItem(e)},displayError:function(e,r,o){var a,i=this,l=r.responseText!==t,s=l?o?i._rs:i._ds:t,u=document.getElementById(i.viewerHolderID);a='<div style="background-color:#bbffbb"><h3>'+e+"失败，锐浪HTML5报表("+n.VERSION+")</h3>",s&&(a+='<div>URL: <a href="'+s.url+'">'+s.url+"</a></div>"),l?(a+="<div>HTTP Status: "+r.status+"</div><div>HTTP Status Text: "+r.statusText+"</div>",r.responseText&&(a+="<div>HTTP Response Text: <pre>"+r.responseText+"</pre></div>")):a+="string"==typeof r?"<div>Loaded Text: <pre>"+r+"</pre></div>":"<div>Loaded Json Object: <pre>"+JSON.stringify(r)+"</pre></div>",a+="</div>",u.innerHTML=a},_getEventCSSName:function(e){var t=this.viewerNo,r="_grec"+e;return t&&(r+="-"+t),r},_getCSSName:function(e){var t=this.viewerNo,r=e.getStyleName();return t&&(r+="-"+t),r},_getDetailGridID:function(e){var t=this.viewerNo,r=n.ID_DETAILGRID+e;return t&&(r+="-"+t),r},get reportURL(){var e=this._rs;return e?e.url:""},set reportURL(e){var t=this;t._rs={},t._rs.url=e},get dataURL(){var e=this._ds;return e?e.url:""},set dataURL(e){var t=this;t._ds={},t._ds.url=e},get reportSource(){return this._rs},set reportSource(e){var t=this;e&&(t._rs={},w(e)?t._rs.url=e:e.url?u(t._rs,e):t._rs=e)},get dataSource(){return this._ds},set dataSource(e){var t=this;e&&(t._ds={},b(e)?t._ds.url=e:e.url?u(t._ds,e):t._ds=e)},get reportText(){var e=this._rawReport;return"string"!=typeof e&&(e=JSON.stringify(e)),e},get dataText(){var e=this._rawData;return"string"!=typeof e&&(e=JSON.stringify(e)),e}},e.rubylong={grhtml5:{controlLayout:gr.enum_.controlLayout,detailgridResize:gr.enum_.detailgridResize,barcodeURL:"/html5/General/Barcode.ashx",Viewer:y,helper:r,utility:gr.utility,holderIDs:[],insertReportViewer:function(t,r,o,n){var a=e.rubylong.grhtml5.holderIDs,i=a.indexOf(t);return 0>i&&(i=a.length,a.push(t)),new y(i,t,r,o,n)},createReport:function(){return new gr.dom.Report}},ajax:function(e,t,r,o){function n(e,t){return t||(/.grf|.txt|.xml|.json/.test(e)?"GET":"POST")}var a,i=new XMLHttpRequest;if(i.onreadystatechange=function(){4==i.readyState&&i.status>0&&t.call(r,i,200==i.status)},i.onerror=function(){t.call(r,i,0)},"string"==typeof e&&(e={url:e}),e.method||(e.method=n(e.url,o)),i.open(e.method,e.url,!0),a=e.headers,a&&"object"==_typeof(a))for(var l in a)i.setRequestHeader(l,a[l]);i.send(e.data)}},"classList"in document.documentElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function e(e){return function(r){var o=t.className.split(/\s+/g),n=o.indexOf(r);e(o,n,r),t.className=o.join(" ")}}var t=this;return{add:e((function(e,t,r){~t||e.push(r)})),remove:e((function(e,t){~t&&e.splice(t,1)})),toggle:e((function(e,t,r){~t?e.splice(t,1):e.push(r)})),contains:function(e){return!!~t.className.split(/\s+/g).indexOf(e)},item:function(e){return t.className.split(/\s+/g)[e]||null}}}})}(window)},20715:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u,m:()=>c});var o=r(69492),n=r(25026),a=r(23772);r(60739),r(33110),r(79432),r(25276),r(50375);function i(){var e={};if(document.cookie){var t=document.cookie.split("; ");for(var r in t){var o=t[r].indexOf("="),n=t[r].substr(0,o),a=t[r].substr(o+1,t[r].length);e[n]=a}}return e}const l={set:function(e,t,r){if(e&&t){var o=encodeURIComponent(e)+"="+encodeURIComponent(t);return r&&(r.maxAge&&(o+="; max-age="+r.maxAge),r.path&&(o+="; path="+r.path),r.domain&&(o+="; domain="+r.domain),r.secure&&(o+="; secure")),document.cookie=o,o}return""},get:function(e){return decodeURIComponent(i()[e]||"")},del:function(e){i()[e]&&(document.cookie=e+"=; max-age=0")},clear:function(){var e=i();for(var t in e)document.cookie=t+"=; max-age=0"},getCookies:function(){return i()}};var s=r(76136),u=(0,o.A)((function e(t,r){var o=this;(0,n.A)(this,e),this.get=function(){if(s.A.isEmpty(o.value)){var n=null;(r&e.LOCAL_STORAGE)==e.LOCAL_STORAGE&&(n=localStorage.getItem(t)),s.A.isEmpty(n)&&(r&e.COOKIE)==e.COOKIE&&(n=l.get(t)),s.A.isEmpty(n)&&(r&e.SESSION_STORAGE)==e.SESSION_STORAGE&&(n=sessionStorage.getItem(t)),o.value=JSON.parse(s.A.isEmpty(n)?'""':n)}return o.value},this.set=function(n){o.value=n;var a=JSON.stringify(n);s.A.isEmpty(a)?o.del():((r&e.LOCAL_STORAGE)==e.LOCAL_STORAGE&&localStorage.setItem(t,a),(r&e.COOKIE)==e.COOKIE&&l.set(t,a),(r&e.SESSION_STORAGE)==e.SESSION_STORAGE&&sessionStorage.setItem(t,a))},this.del=function(){delete o.value,(r&e.LOCAL_STORAGE)==e.LOCAL_STORAGE&&localStorage.removeItem(t),(r&e.COOKIE)==e.COOKIE&&l.del(t),(r&e.SESSION_STORAGE)==e.SESSION_STORAGE&&sessionStorage.removeItem(t)}}));function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.LOCAL_STORAGE;return new u(e,t)}(0,a.A)(u,"RUNNING",0),(0,a.A)(u,"LOCAL_STORAGE",1),(0,a.A)(u,"COOKIE",2),(0,a.A)(u,"SESSION_STORAGE",4)},26443:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o,o:()=>n});var o={13864366777:{id:"huangsheng",name:"皇盛商行",pwd:"5e67042ccff4249aee6a4b7d85bed15b",isShowTitle:!0,isShowLogo:!0,isShowQrcode:!0,isShowMsg:!0,productList:[{name:"塑料布C"}],normsList:[{name:"【厚度0.12mm】宽2m 长100m"}],address:"淄博市周村区金周沙发材料市场",phone1:"13864366777 13608942777 （微信同号）",phone2:"0533-6186766"}},n=[{id:"1",name:"出货票据打印",title:"出货票据打印",icon:"ri-printer-line",path:"/print/index",children:[]}]},76136:(e,t,r)=>{"use strict";r.d(t,{A:()=>F});r(76918),r(28706),r(25276),r(54743),r(11745),r(38309),r(16573),r(78100),r(77936),r(59089),r(23288),r(62010),r(2892),r(9868),r(26099),r(84864),r(57465),r(27495),r(87745),r(90906),r(38781),r(71761),r(25440),r(42762),r(21489),r(48140),r(81630),r(72170),r(75044),r(69539),r(31694),r(89955),r(21903),r(91134),r(33206),r(44496),r(66651),r(12887),r(19369),r(66812),r(8995),r(31575),r(36072),r(88747),r(28845),r(29423),r(57301),r(373),r(86614),r(41405),r(37467),r(44732),r(33684),r(79577),r(2945),r(42207),r(55815),r(64979),r(79739),r(76031);var o=r(54119),n=(r(60739),r(33110),r(50375),r(6731),"grinstall"),a="http://www.rubylong.cn/download/grbsctl6.exe",i="http://www.rubylong.cn/gridreport/doc/plugins_browser.htm",l="6,7,20,0529",s="锐浪报表插件本机开发测试注册",u="8PJH495VA61FLI5TG0L4KB2337F1G7AKLD6LNNA9F9T28IKRU6N33P8Z6XX4BUYB5E9NZ6INMD5T8EN47IX63VV7F9BJHB5ZJQQ6MX3J3V12C4XDHU97SXX6X3VA57KCB6",c=window.navigator.platform,d=c.indexOf("64")>0,p=navigator.userAgent.toLowerCase(),h=p.indexOf("msie")>0,f=h?'codebase="'+n+(d?"/grbsctl6x64.cab":"/grbsctl6.cab")+"#Version="+l+'"':"",g=1;function m(){var e=document.body,t=e.children,r=t.length?t[0]:null,o=document.createElement("h3"),n=document.createElement("h3");alert("创建插件失败，当前浏览器不支持插件，或插件在当前电脑上没有安装！"),o.innerHTML='特别提示：<a href="'+a+'">点击下载WEB报表插件安装程序</a>，下载后双击下载的文件进行安装，安装完成后重新打开当前网页。',n.innerHTML='请参考<a href="'+i+'" target="_blank">浏览器插件兼容性说明</a>，选用支持插件的浏览器查看当前网页。',document.body.insertBefore(o,r),document.body.insertBefore(n,r)}function _(e){var t,r,n=e.type||"printviewer",a=e.id,i=e.width||"100%",l=e.height||"100%",c=e.report||"",d=e.data||"",p=e.dataUrlParams||"",_=e.saveurl||"",x=e.autorun||void 0==e.autorun,b=e.exparams,S=e.oncreate,D="designer"==e.type,F=x&&!g;function P(e,t){var r=e.Report,n=t.autorun||void 0==t.autorun,a=t.report||e.ReportURL,i=t.data||e.DataURL,l=t.onreportload,s=t.ondataload;function u(){var t=e._gr_report,o=e._gr_data;t&&o&&("{}"!=t&&(r.LoadFromStr(t),l&&l(r)),r.DataLoaded||r.LoadDataFromXML(o),s&&s(r),n&&e.Start(),e._gr_report=void 0,e._gr_data=void 0)}a?y(a)?w(a,(function(t){e._gr_report=t.responseText,u()})):(e._gr_report="object"==(0,o.A)(a)?JSON.stringify(a):a,u()):(e._gr_report="{}",u()),i?y(i)?w(i,(function(t){e._gr_data=t.responseText,u()}),!0,t.dataUrlParams):(e._gr_data="object"==(0,o.A)(i)?JSON.stringify(i):i,u()):(e._gr_data="{}",u())}a=D?a||"ReportDesigner":a||"ReportViewer",h?(t=D?"CE666189-5D7C-42ee-AAA4-E5CB375ED3C7":"printviewer"==n?"ABB64AAC-D7E8-4733-B052-1B141C92F3CE":"600CD6D9-EBE1-42cb-B8DF-DFB81977122E",t='classid="clsid:'+t+f):t='type="application/x-grplugin6-'+n+'"',document.write('<object id="'+a+'" '+t),document.write(' width="'+i+'" height="'+l+'">'),D?(g||(document.write('<param name="LoadReportURL" value="'+c+'">'),document.write('<param name="DataURL" value="'+d+'">'),document.write('<param name="DataParam" value="'+p+'">')),document.write('<param name="SaveReportURL" value="'+_+'">')):(g||(document.write('<param name="ReportURL" value="'+c+'">'),document.write('<param name="DataURL" value="'+d+'">'),document.write('<param name="DataParam" value="'+p+'">')),document.write('<param name="AutoRun" value='+F+">")),document.write('<param name="SerialNo" value="'+u+'">'),document.write('<param name="UserName" value="'+s+'">'),b&&document.write(b),document.write("</object>"),r=document.getElementById(a),r&&r.Report?(S&&S(r),g&&(D?(c&&C(r,c,e.onreportload),d&&!r.OnRequestData&&(r.OnRequestData=function(e){T(e,d)}),_&&!r.OnSaveReport&&(r.OnSaveReport=function(){v(r,_),r.DefaultAction=!1,alert("报表模板设计已提交至服务器！\r\n(此提示信息可以在 CreateControl.js 文件中修改)")})):P(r,e))):m()}function C(e,t,r){w(t,(function(t){e.Report.LoadFromStr(t.responseText),e.Reload(),r&&r(e.Report)}))}function v(e,t){var r;e.Post(),r=e.Report.SaveToStr(),w(t,0,!0,r)}function T(e,t){w(t,(function(t){e.LoadDataFromAjaxRequest(t.responseText,t.getAllResponseHeaders())}),!1)}function x(e,t,r,o,n,a,i){_({type:"printviewer",id:e,width:t,height:r,report:o,data:n,autorun:a,exparams:i})}function b(e,t,r,o,n,a){x("ReportViewer",e,t,r,o,n,a)}function w(e,t,r,o,n,a){var i=new XMLHttpRequest;function l(e,t){return t||(/.grf|.txt|.xml|.json|.png|.jpg|.jpeg|.bmp|.gif/.test(e)?"GET":"POST")}i.onreadystatechange=function(){4==i.readyState&&i.status>0&&(200==i.status?t&&t.call(a,i):window.open(e,"blank"))},i.onerror=function(){window.open(e,"blank")},r=r||void 0==r,i.open(l(e,n),e,r),i.send(o)}var y=function(e){var t,r=0,o=e.length;if("string"!=typeof e)return 0;while(r<o){if(t=e[r],!/\s/g.test(t))break;r++}return"{"!=t&&"<"!=t&&"_WR_"!=e.substr(r,4)};var S=r(83169),D=r.n(S);const F={gridGrfPrint:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o="".concat(e,"?").concat(Math.random());r&&b("100%","100%",o,t,!0,"")},getMD5String:function(e){return e?D().MD5(e).toString():""},isUndefined:function(e){return"undefined"===typeof e},isNull:function(e){return null===e},isEmpty:function(e){return this.isUndefined(e)||this.isNull(e)||0==(e+"").trim().length},isInt:function(e){return/^\-?\d+$/.test(e)},isNumber:function(e){return!this.isEmpty(e)&&!isNaN(Number(e))},isHttp:function(e){return/^http/.test(e)},isBase64:function(e){if(this.isEmpty(e))return!1;try{return btoa(atob(e))==e}catch(t){return!1}},isIp:function(e){return/^((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))$/g.test(e)},isPort:function(e){return!this.isEmpty(e)&&(e*=1,!(e<0||e>65535))},dateTimeFormat:function(e){return this.isEmpty(e)?"":e.substring(0,19)},meterFormat:function(e){return this.isEmpty(e)?"":1*e/1e3>1?"".concat((1*e/1e3).toFixed(1)," km"):"".concat((1*e).toFixed(1)," m")},dateFormatter:function(e){return e?e.substring(0,10):""},delay:function(e){return new Promise((function(t,r){return setTimeout(t,e)}))},isInstallPlugin:function(e){e=e.toLowerCase();for(var t=0;t<window.navigator.plugins.length;t++)if(window.navigator.plugins[t].name.toLowerCase().indexOf(e)>-1)return!0;return!1},base64ToFile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".jpg";console.log(t);var r=e.split(","),o=r[0].match(/:(.*?);/)[1],n=atob(r[1]),a=n.length,i=new Uint8Array(a);while(a--)i[a]=n.charCodeAt(a);var l=new Blob([i],{type:o});return new File([l],(new Date).getTime()+t,{type:o,lastModified:Date.now()})},fileToBase64:function(e){var t=new FileReader;return t.readAsDataURL(e),new Promise((function(e){t.onload=function(){e(this.result)}}))},getStrByReg:function(e,t){var r=e.match(new RegExp(t));return null==r||r.length<1?"":r[0]},formatBeginEndDateTime:function(e,t){var r=new RegExp("\\d{4}\\-"),o=new RegExp("\\d{4}\\-\\d{2}\\-\\d{2}");return"".concat(e.replace(r,""),"-").concat(t.replace(this.getStrByReg(e,o)==this.getStrByReg(t,o)?o:r,""))}}},81380:(e,t,r)=>{"use strict";r(23792),r(3362),r(69085),r(9391);var o=r(35280),n=r(56436);r(74529);function a(e,t,r,n,a,i){var l=(0,o.g2)("router-view"),s=(0,o.g2)("a-config-provider");return(0,o.uX)(),(0,o.Wv)(s,{locale:a.locale,autoInsertSpaceInButton:!1},{default:(0,o.k6)((function(){return[(0,o.bF)(l)]})),_:1},8,["locale"])}r(27495),r(25440);var i=r(83496),l=r(15383),s=r(18392),u=r(1576),c=r.n(u);r(44514);c().locale("zhCN");const d={data:function(){return{locale:s.A}},mounted:function(){l.A.defaultConfig.token.borderRadius=0,i.A.utils.isEmpty(i.A.getToken())&&this.$router.replace({path:"/login"})}};var p=r(71241);const h=(0,p.A)(d,[["render",a]]),f=h;var g=r(79342),m=r(60782);const _=(0,m.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}});var C={key:0,class:"pic-viewer"},v={class:"pic-viewer__inner"},T=(0,o.Lk)("i",{class:"ri-close-line"},null,-1),x=[T],b={class:"viewer-content"},w=["src"],y={class:"viewer-control"},S=(0,o.Lk)("span",{class:"viewer-divider"},null,-1),D=(0,o.Lk)("div",{class:"pic-viewer__mask"},null,-1);function F(e,t,r,n,a,i){var l=(0,o.g2)("a-icon");return r.visible?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",v,[(0,o.Lk)("div",{class:"viewer-close",onClick:t[0]||(t[0]=function(){return i.close&&i.close.apply(i,arguments)})},x),(0,o.Lk)("div",b,[(0,o.Lk)("img",{src:r.src,ref:"img",style:(0,o.Tr)(a.styleObj)},null,12,w)]),(0,o.Lk)("div",y,[(0,o.bF)(l,{type:"zoom-in",onClick:i.zoomIn},null,8,["onClick"]),(0,o.bF)(l,{type:"zoom-out",onClick:i.zoomOut},null,8,["onClick"]),S,(0,o.bF)(l,{type:"undo",onClick:i.undo},null,8,["onClick"]),(0,o.bF)(l,{type:"redo",onClick:i.redo},null,8,["onClick"])])]),D])):(0,o.Q3)("",!0)}r(28706);const P={data:function(){return{multiples:1,deg:0,styleObj:null}},props:{src:String,visible:{type:Boolean,default:!1}},methods:{zoomIn:function(){this.multiples>=10||(this.multiples+=.25,this.styleObj="transform: scale(".concat(this.multiples,") rotateZ(").concat(this.deg,"deg);left:").concat(this.endX,"px;top:").concat(this.endY,"px"))},zoomOut:function(){this.multiples<=0||(this.multiples-=.25,this.styleObj="transform: scale(".concat(this.multiples,") rotateZ(").concat(this.deg,"deg);left:").concat(this.endX,"px;top:").concat(this.endY,"px"))},undo:function(){this.deg-=90,this.styleObj="transform: scale(".concat(this.multiples,") rotateZ(").concat(this.deg,"deg);left:").concat(this.endX,"px;top:").concat(this.endY,"px")},redo:function(){this.deg+=90,this.styleObj="transform: scale(".concat(this.multiples,") rotateZ(").concat(this.deg,"deg);left:").concat(this.endX,"px;top:").concat(this.endY,"px")},close:function(){this.$emit("onClose")}}},E=(0,p.A)(P,[["render",F]]),A=E;r(10051);i.A.onLaunch(),(0,o.Ef)(f).use(_).use(g.A).use(n.Ay).component("viewer",A).mount("#app")},79342:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});r(26099),r(47764),r(62953);var o=r(81387),n=[{path:"/login",name:"login",component:function(){return r.e(421).then(r.bind(r,59421))}},{path:"/",name:"page",component:function(){return r.e(789).then(r.bind(r,59789))},children:[{path:"",redirect:"/login"},{path:"/print/index",name:"print-index",meta:{icon:"ri-node-tree",title:"出货单据打印系统"},component:function(){return Promise.all([r.e(823),r.e(620)]).then(r.bind(r,12620))}},{path:"admin/departmentList",name:"adminDepartmentList",meta:{icon:"ri-node-tree",title:"部门列表"},component:function(){return r.e(542).then(r.bind(r,64542))}},{path:"admin/userList",name:"adminUserList",meta:{icon:"ri-user-settings-line",title:"用户管理"},component:function(){return r.e(820).then(r.bind(r,98820))}},{path:"superadmin/departmentList",name:"superAdminDepartmentList",meta:{icon:"ri-node-tree",title:"部门列表"},component:function(){return r.e(297).then(r.bind(r,31297))}},{path:"superadmin/menuList",name:"superAdminMenuList",meta:{icon:"ri-list-settings-line",title:"菜单管理"},component:function(){return Promise.all([r.e(823),r.e(412)]).then(r.bind(r,92412))}},{path:"superadmin/params",name:"superAdminParams",meta:{icon:"ri-equalizer-line",title:"参数管理"},component:function(){return r.e(123).then(r.bind(r,75123))}},{path:"superadmin/roleList",name:"superAdminRoleList",meta:{icon:"ri-team-line",title:"角色管理"},component:function(){return r.e(7).then(r.bind(r,92007))}},{path:"superadmin/userList",name:"superAdminUserList",meta:{icon:"ri-user-settings-line",title:"用户管理"},component:function(){return r.e(948).then(r.bind(r,67948))}},{path:"/:pathMatch(.*)",redirect:"/login"}]}],a=(0,o.aE)({history:(0,o.Bt)(),routes:n});const i=a},50477:()=>{},42634:()=>{}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.m=__webpack_modules__,(()=>{var e=[];__webpack_require__.O=(t,r,o,n)=>{if(!r){var a=1/0;for(u=0;u<e.length;u++){for(var[r,o,n]=e[u],i=!0,l=0;l<r.length;l++)(!1&n||a>=n)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](r[l])))?r.splice(l--,1):(i=!1,n<a&&(a=n));if(i){e.splice(u--,1);var s=o();void 0!==s&&(t=s)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[r,o,n]}})(),(()=>{__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return __webpack_require__.d(t,{a:t}),t}})(),(()=>{__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,r)=>(__webpack_require__.f[r](e,t),t)),[]))})(),(()=>{__webpack_require__.u=e=>e+".1723367395460.1.js"})(),(()=>{__webpack_require__.miniCssF=e=>"css/"+e+"."+{297:"07b847d6",421:"74b008cd",542:"07b847d6",620:"5ae9e452"}[e]+".css"})(),(()=>{__webpack_require__.miniCssF=e=>"css/"+e+".1723367395460.1.css"})(),(()=>{__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="web-admin:";__webpack_require__.l=(r,o,n,a)=>{if(e[r])e[r].push(o);else{var i,l;if(void 0!==n)for(var s=document.getElementsByTagName("script"),u=0;u<s.length;u++){var c=s[u];if(c.getAttribute("src")==r||c.getAttribute("data-webpack")==t+n){i=c;break}}i||(l=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,__webpack_require__.nc&&i.setAttribute("nonce",__webpack_require__.nc),i.setAttribute("data-webpack",t+n),i.src=r),e[r]=[o];var d=(t,o)=>{i.onerror=i.onload=null,clearTimeout(p);var n=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((e=>e(o))),t)return t(o)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),l&&document.head.appendChild(i)}}})(),(()=>{__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.p=""})(),(()=>{if("undefined"!==typeof document){var e=(e,t,r,o,n)=>{var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",__webpack_require__.nc&&(a.nonce=__webpack_require__.nc);var i=r=>{if(a.onerror=a.onload=null,"load"===r.type)o();else{var i=r&&r.type,l=r&&r.target&&r.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+i+": "+l+")");s.name="ChunkLoadError",s.code="CSS_CHUNK_LOAD_FAILED",s.type=i,s.request=l,a.parentNode&&a.parentNode.removeChild(a),n(s)}};return a.onerror=a.onload=i,a.href=t,r?r.parentNode.insertBefore(a,r.nextSibling):document.head.appendChild(a),a},t=(e,t)=>{for(var r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var n=r[o],a=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(a===e||a===t))return n}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){n=i[o],a=n.getAttribute("data-href");if(a===e||a===t)return n}},r=r=>new Promise(((o,n)=>{var a=__webpack_require__.miniCssF(r),i=__webpack_require__.p+a;if(t(a,i))return o();e(r,i,null,o,n)})),o={524:0};__webpack_require__.f.miniCss=(e,t)=>{var n={297:1,421:1,542:1,620:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=r(e).then((()=>{o[e]=0}),(t=>{throw delete o[e],t})))}}})(),(()=>{if("undefined"!==typeof document){var e=(e,t,r,o,n)=>{var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",__webpack_require__.nc&&(a.nonce=__webpack_require__.nc);var i=r=>{if(a.onerror=a.onload=null,"load"===r.type)o();else{var i=r&&r.type,l=r&&r.target&&r.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+i+": "+l+")");s.name="ChunkLoadError",s.code="CSS_CHUNK_LOAD_FAILED",s.type=i,s.request=l,a.parentNode&&a.parentNode.removeChild(a),n(s)}};return a.onerror=a.onload=i,a.href=t,r?r.parentNode.insertBefore(a,r.nextSibling):document.head.appendChild(a),a},t=(e,t)=>{for(var r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var n=r[o],a=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(a===e||a===t))return n}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){n=i[o],a=n.getAttribute("data-href");if(a===e||a===t)return n}},r=r=>new Promise(((o,n)=>{var a=__webpack_require__.miniCssF(r),i=__webpack_require__.p+a;if(t(a,i))return o();e(r,i,null,o,n)})),o={524:0};__webpack_require__.f.miniCss=(e,t)=>{var n={297:1,421:1,542:1,620:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=r(e).then((()=>{o[e]=0}),(t=>{throw delete o[e],t})))}}})(),(()=>{var e={524:0};__webpack_require__.f.j=(t,r)=>{var o=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var n=new Promise(((r,n)=>o=e[t]=[r,n]));r.push(o[2]=n);var a=__webpack_require__.p+__webpack_require__.u(t),i=new Error,l=r=>{if(__webpack_require__.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var n=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+n+": "+a+")",i.name="ChunkLoadError",i.type=n,i.request=a,o[1](i)}};__webpack_require__.l(a,l,"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,r)=>{var o,n,[a,i,l]=r,s=0;if(a.some((t=>0!==e[t]))){for(o in i)__webpack_require__.o(i,o)&&(__webpack_require__.m[o]=i[o]);if(l)var u=l(__webpack_require__)}for(t&&t(r);s<a.length;s++)n=a[s],__webpack_require__.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return __webpack_require__.O(u)},r=self["webpackChunkweb_admin"]=self["webpackChunkweb_admin"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var __webpack_exports__=__webpack_require__.O(void 0,[504],(()=>__webpack_require__(81380)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();